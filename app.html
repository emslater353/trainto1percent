<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>AI Proof Club â€” Build Skills AI Can't Replace</title>
    <meta name="description" content="Build the skills AI can't replace â€” with adaptive technology that tracks your growth, locks in your progress, and proves how far you've come.">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://aiproof.club/">
    <meta property="og:title" content="AI Proof Club â€” Build Skills AI Can't Replace">
    <meta property="og:description" content="Build the skills AI can't replace â€” with adaptive technology that tracks your growth, locks in your progress, and proves how far you've come.">
    <meta property="og:image" content="https://aiproof.club/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://aiproof.club/">
    <meta name="twitter:title" content="AI Proof Club â€” Build Skills AI Can't Replace">
    <meta name="twitter:description" content="Build the skills AI can't replace â€” with adaptive technology that tracks your growth, locks in your progress, and proves how far you've come.">
    <meta name="twitter:image" content="https://aiproof.club/og-image.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">
    <style>
        :root {
            /* METALLIC ROBOTIC THEME */
            --bg-primary: #050508; /* Deep black with blue tint */
            --bg-secondary: #0d0d12; /* Dark gunmetal */
            --bg-tertiary: #1a1a24; /* Slightly lighter metallic */
            --text-primary: #e8e8ec; /* Cool white */
            --text-secondary: #6e7087; /* Muted steel */
            --text-muted: #3d3d4a; /* Dark steel */
            --accent: #00f0ff; /* Cyan/electric blue */
            --accent-glow: rgba(0, 240, 255, 0.15);
            --danger: #ff3366; /* Hot pink/red */
            --success: #00ff88; /* Electric green */
            --warning: #ffaa00; /* Amber */
            --ideas: #7b68ee; /* Medium slate blue */
            --personality: #ff6b9d; /* Pink */
            --execution: #00ff88; /* Electric green */
            --metal-shine: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 50%, rgba(255,255,255,0.05) 100%);
            --metal-border: linear-gradient(135deg, #2a2a3a 0%, #1a1a24 50%, #2a2a3a 100%);
            --font-display: 'Space Mono', monospace; /* More robotic */
            --font-mono: 'Space Mono', monospace;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: var(--font-mono); 
            background: var(--bg-primary); 
            color: var(--text-primary); 
            line-height: 1.6; 
            font-size: 14px;
            background-image: 
                radial-gradient(ellipse at top, rgba(0, 240, 255, 0.03) 0%, transparent 50%),
                radial-gradient(ellipse at bottom, rgba(123, 104, 238, 0.03) 0%, transparent 50%);
        }
        
        .btn { 
            display: inline-flex; 
            align-items: center; 
            justify-content: center; 
            padding: 14px 28px; 
            font-family: var(--font-mono); 
            font-size: 11px; 
            font-weight: 700; 
            letter-spacing: 2px; 
            text-transform: uppercase; 
            border: none; 
            cursor: pointer; 
            transition: all 0.3s; 
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        .btn:hover::before { left: 100%; }
        .btn-primary { 
            background: var(--accent); 
            color: var(--bg-primary); 
            box-shadow: 0 0 20px var(--accent-glow), inset 0 1px 0 rgba(255,255,255,0.2);
        }
        .btn-primary:hover { 
            background: var(--text-primary); 
            box-shadow: 0 0 30px rgba(255,255,255,0.2);
        }
        .btn-primary:disabled { background: var(--bg-tertiary); color: var(--text-muted); cursor: not-allowed; box-shadow: none; }
        .btn-secondary { 
            background: transparent; 
            border: 1px solid var(--bg-tertiary); 
            color: var(--text-secondary);
            background: var(--metal-shine);
        }
        .btn-secondary:hover { 
            border-color: var(--accent); 
            color: var(--accent);
            box-shadow: 0 0 15px var(--accent-glow);
        }
        .btn-success { 
            background: var(--success); 
            color: var(--bg-primary);
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.2);
        }
        .btn-full { width: 100%; }
        .btn-small { padding: 10px 16px; font-size: 10px; }

        .screen-center { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; }
        .container-sm { width: 100%; max-width: 420px; }
        .container-md { width: 100%; max-width: 600px; }

        .logo { 
            font-size: 13px; 
            font-weight: 700; 
            letter-spacing: 4px; 
            text-transform: uppercase; 
            margin-bottom: 30px; 
            text-align: center;
        }
        .logo span { 
            color: var(--accent); 
            text-shadow: 0 0 10px var(--accent-glow);
        }

        .card { 
            background: var(--bg-secondary); 
            border: 1px solid var(--bg-tertiary); 
            padding: 25px; 
            margin-bottom: 15px;
            position: relative;
            background-image: var(--metal-shine);
        }
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0,240,255,0.3), transparent);
        }
        .card-title { font-family: var(--font-display); font-size: 22px; margin-bottom: 8px; letter-spacing: 1px; }
        .card-subtitle { color: var(--text-secondary); font-size: 12px; margin-bottom: 20px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 12px; border-bottom: 1px solid var(--bg-tertiary); }
        .card-header-title { font-size: 12px; font-weight: 700; letter-spacing: 1px; }
        .card-badge { font-size: 10px; color: var(--accent); text-transform: uppercase; letter-spacing: 1px; }

        .form-group { margin-bottom: 18px; }
        .form-label { display: block; font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--text-secondary); margin-bottom: 6px; }
        .form-input, .form-textarea { 
            width: 100%; 
            padding: 12px; 
            background: var(--bg-primary); 
            border: 1px solid var(--bg-tertiary); 
            color: var(--text-primary); 
            font-family: var(--font-mono); 
            font-size: 13px;
            transition: all 0.3s;
        }
        .form-input:focus, .form-textarea:focus { 
            outline: none; 
            border-color: var(--accent);
            box-shadow: 0 0 10px var(--accent-glow);
        }
        .form-textarea { min-height: 80px; resize: vertical; }

        .text-link { color: var(--accent); text-decoration: none; cursor: pointer; }
        .text-link:hover { text-decoration: underline; text-shadow: 0 0 10px var(--accent-glow); }
        .text-center { text-align: center; }
        .text-secondary { color: var(--text-secondary); }
        .text-small { font-size: 12px; }
        .mt-10 { margin-top: 10px; }
        .mt-20 { margin-top: 20px; }
        .mb-10 { margin-bottom: 10px; }
        .mb-20 { margin-bottom: 20px; }
        .flex { display: flex; }
        .gap-10 { gap: 10px; }
        .gap-15 { gap: 15px; }

        .choice-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .choice-card { 
            background: var(--bg-secondary); 
            border: 1px solid var(--bg-tertiary); 
            padding: 25px; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.3s;
            background-image: var(--metal-shine);
            position: relative;
        }
        .choice-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, transparent 40%, rgba(0,240,255,0.05) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        .choice-card:hover { 
            border-color: var(--accent); 
            box-shadow: 0 0 20px var(--accent-glow);
        }
        .choice-card:hover::after { opacity: 1; }
        .choice-card.selected { 
            border-color: var(--accent); 
            box-shadow: 0 0 25px var(--accent-glow), inset 0 0 30px var(--accent-glow);
        }
        .choice-icon { font-size: 32px; margin-bottom: 12px; filter: drop-shadow(0 0 5px rgba(0,240,255,0.3)); }
        .choice-title { font-size: 13px; margin-bottom: 6px; letter-spacing: 1px; }
        .choice-desc { font-size: 11px; color: var(--text-secondary); }

        .upload-zone { 
            border: 2px dashed var(--bg-tertiary); 
            padding: 40px; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.3s;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
        }
        .upload-zone:hover { 
            border-color: var(--accent); 
            box-shadow: inset 0 0 30px var(--accent-glow);
        }
        .file-input { display: none; }
        .uploaded-file { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--bg-tertiary); margin-top: 12px; }
        .uploaded-remove { color: var(--danger); cursor: pointer; margin-left: auto; }

        .progress-bar { display: flex; gap: 5px; margin-bottom: 25px; }
        .progress-dot { 
            flex: 1; 
            height: 3px; 
            background: var(--bg-tertiary); 
            border-radius: 2px;
            position: relative;
            overflow: hidden;
        }
        .progress-dot.active { 
            background: var(--accent); 
            box-shadow: 0 0 10px var(--accent-glow);
        }
        .progress-dot.active::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer { 100% { left: 100%; } }
        .progress-dot.done { background: var(--accent); opacity: 0.5; }
        .q-number { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--accent); margin-bottom: 10px; text-shadow: 0 0 10px var(--accent-glow); }
        .q-text { font-family: var(--font-display); font-size: 20px; line-height: 1.4; margin-bottom: 20px; }
        .options { display: flex; flex-direction: column; gap: 8px; }
        .option { 
            padding: 14px; 
            background: var(--bg-secondary); 
            border: 1px solid var(--bg-tertiary); 
            cursor: pointer; 
            text-align: left; 
            font-family: var(--font-mono); 
            font-size: 12px; 
            color: var(--text-primary); 
            transition: all 0.3s;
            background-image: var(--metal-shine);
        }
        .option:hover { 
            border-color: var(--accent); 
            box-shadow: 0 0 15px var(--accent-glow);
            transform: translateX(5px);
        }

        .results-meters { display: flex; justify-content: center; gap: 25px; margin: 25px 0; }
        .meter { text-align: center; }
        .meter-circle { 
            width: 90px; 
            height: 90px; 
            border-radius: 50%; 
            border: 4px solid; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            margin: 0 auto 10px; 
            font-size: 22px; 
            font-weight: 700;
            position: relative;
            background: var(--bg-primary);
        }
        .meter-circle::before {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            padding: 4px;
            background: conic-gradient(from 0deg, currentColor 0%, transparent 100%);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0.3;
        }
        .meter-circle.ideas { border-color: var(--ideas); color: var(--ideas); box-shadow: 0 0 20px rgba(123,104,238,0.3); }
        .meter-circle.personality { border-color: var(--personality); color: var(--personality); box-shadow: 0 0 20px rgba(255,107,157,0.3); }
        .meter-circle.execution { border-color: var(--execution); color: var(--execution); box-shadow: 0 0 20px rgba(0,255,136,0.3); }
        .meter-label { font-size: 11px; letter-spacing: 2px; text-transform: uppercase; }
        .verdict { 
            background: var(--bg-primary); 
            border-left: 3px solid var(--accent); 
            padding: 15px; 
            margin: 20px 0; 
            text-align: left;
            position: relative;
            overflow: hidden;
        }
        .verdict::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, var(--accent-glow) 0%, transparent 50%);
            pointer-events: none;
        }
        .verdict-title { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: var(--accent); margin-bottom: 6px; }
        .verdict-text { font-size: 13px; line-height: 1.5; position: relative; }

        .tabs { display: flex; gap: 5px; margin-bottom: 15px; }
        .tab { 
            padding: 8px 16px; 
            background: var(--bg-tertiary); 
            border: none; 
            color: var(--text-secondary); 
            font-family: var(--font-mono); 
            font-size: 10px; 
            cursor: pointer; 
            text-transform: uppercase; 
            letter-spacing: 2px;
            transition: all 0.3s;
        }
        .tab:hover { color: var(--accent); }
        .tab.active { 
            background: var(--accent); 
            color: var(--bg-primary);
            box-shadow: 0 0 15px var(--accent-glow);
        }

        .app-layout { display: flex; min-height: 100vh; }
        .sidebar { 
            width: 220px; 
            background: var(--bg-secondary); 
            border-right: 1px solid var(--bg-tertiary); 
            padding: 20px 12px; 
            position: fixed; 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            overflow-y: auto;
            background-image: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
        }
        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 1px;
            height: 100%;
            background: linear-gradient(180deg, var(--accent) 0%, transparent 30%, transparent 70%, var(--accent) 100%);
            opacity: 0.3;
        }
        .sidebar-logo { font-size: 11px; font-weight: 700; letter-spacing: 4px; text-transform: uppercase; margin-bottom: 20px; padding: 0 8px; }
        .sidebar-logo span { color: var(--accent); text-shadow: 0 0 10px var(--accent-glow); }
        .sidebar-streak { 
            background: var(--bg-primary); 
            border: 1px solid var(--bg-tertiary); 
            padding: 12px; 
            margin-bottom: 15px; 
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .sidebar-streak::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            opacity: 0.5;
        }
        .streak-value { font-size: 24px; font-weight: 700; color: var(--accent); text-shadow: 0 0 15px var(--accent-glow); }
        .streak-label { font-size: 9px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 2px; }
        .sidebar-nav { list-style: none; flex: 1; }
        .sidebar-nav li { margin-bottom: 3px; }
        .sidebar-nav a { 
            display: block; 
            padding: 9px 10px; 
            color: var(--text-secondary); 
            text-decoration: none; 
            font-size: 11px; 
            border-radius: 3px; 
            transition: all 0.2s;
            letter-spacing: 1px;
        }
        .sidebar-nav a:hover { 
            background: var(--bg-tertiary); 
            color: var(--accent);
            box-shadow: inset 0 0 20px var(--accent-glow);
        }
        .sidebar-nav a.active { 
            background: var(--bg-tertiary); 
            color: var(--accent); 
            border-left: 2px solid var(--accent);
            box-shadow: inset 0 0 20px var(--accent-glow);
        }
        .sidebar-user { padding: 10px; background: var(--bg-tertiary); border-radius: 3px; font-size: 11px; }
        .sidebar-name { margin-bottom: 3px; }
        .sidebar-email { font-size: 9px; color: var(--text-secondary); margin-bottom: 6px; word-break: break-all; }
        .sidebar-logout { font-size: 9px; color: var(--text-muted); cursor: pointer; letter-spacing: 1px; }
        .sidebar-logout:hover { color: var(--danger); text-shadow: 0 0 10px rgba(255,51,102,0.5); }
        .main { flex: 1; margin-left: 220px; padding: 25px; }
        .page-header { margin-bottom: 25px; }
        .page-title { font-family: var(--font-display); font-size: 24px; margin-bottom: 5px; letter-spacing: 2px; }
        .page-subtitle { color: var(--text-secondary); font-size: 12px; letter-spacing: 1px; }

        .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px; }
        .stat { 
            background: var(--bg-secondary); 
            border: 1px solid var(--bg-tertiary); 
            padding: 18px; 
            text-align: center;
            background-image: var(--metal-shine);
            position: relative;
        }
        .stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent);
            opacity: 0.3;
        }
        .stat-value { font-size: 24px; font-weight: 700; color: var(--accent); text-shadow: 0 0 10px var(--accent-glow); }
        .stat-label { font-size: 9px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 2px; }

        .mode-bars { display: flex; flex-direction: column; gap: 12px; }
        .mode-bar { display: flex; align-items: center; gap: 12px; }
        .mode-name { width: 80px; font-size: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .mode-name.ideas { color: var(--ideas); text-shadow: 0 0 5px rgba(123,104,238,0.5); }
        .mode-name.personality { color: var(--personality); text-shadow: 0 0 5px rgba(255,107,157,0.5); }
        .mode-name.execution { color: var(--execution); text-shadow: 0 0 5px rgba(0,255,136,0.5); }
        .mode-track { flex: 1; height: 6px; background: var(--bg-tertiary); border-radius: 3px; overflow: hidden; }
        .mode-fill { height: 100%; border-radius: 3px; transition: width 0.5s; position: relative; }
        .mode-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }
        .mode-fill.ideas { background: var(--ideas); box-shadow: 0 0 10px rgba(123,104,238,0.5); }
        .mode-fill.personality { background: var(--personality); box-shadow: 0 0 10px rgba(255,107,157,0.5); }
        .mode-fill.execution { background: var(--execution); box-shadow: 0 0 10px rgba(0,255,136,0.5); }
        .mode-value { width: 40px; text-align: right; font-size: 14px; font-weight: 700; }

        .grid-2 { display: grid; grid-template-columns: 1.5fr 1fr; gap: 15px; }

        .quest { 
            background: var(--bg-primary); 
            border: 1px solid var(--bg-tertiary); 
            padding: 18px; 
            margin-bottom: 10px;
            background-image: var(--metal-shine);
            transition: all 0.3s;
        }
        .quest:hover {
            border-color: var(--accent);
            box-shadow: 0 0 20px var(--accent-glow);
        }
        .quest.boss { border-color: var(--warning); background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(255,170,0,0.08) 100%); box-shadow: 0 0 15px rgba(255,170,0,0.2); }
        .quest.done { opacity: 0.5; }
        .quest.forecast-quest { border-color: var(--ideas); background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(123,104,238,0.08) 100%); }
        .quest.custom-quest { border-color: var(--accent); background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(0,240,255,0.05) 100%); }
        .quest-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; flex-wrap: wrap; gap: 5px; }
        .quest-mode { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; padding: 2px 6px; }
        .quest-mode.ideas { background: rgba(123,104,238,0.2); color: var(--ideas); }
        .quest-mode.personality { background: rgba(255,107,157,0.2); color: var(--personality); }
        .quest-mode.execution { background: rgba(0,255,136,0.2); color: var(--execution); }
        .quest-diff { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; }
        .quest-diff.easy { color: var(--success); }
        .quest-diff.standard { color: var(--warning); }
        .quest-diff.hard { color: var(--danger); }
        .quest-diff.boss { color: var(--warning); font-weight: 700; }
        .quest-diff.forecast { color: var(--ideas); font-size: 8px; max-width: 150px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .quest-title { font-size: 13px; line-height: 1.4; margin-bottom: 10px; }
        .quest-meta { display: flex; gap: 12px; font-size: 10px; color: var(--text-secondary); margin-bottom: 12px; flex-wrap: wrap; }
        .quest-xp { color: var(--accent); font-weight: 700; text-shadow: 0 0 5px var(--accent-glow); }
        .quest-progress { color: var(--ideas); }
        .quest-tip { font-size: 10px; color: var(--text-muted); font-style: italic; margin-top: 8px; padding-top: 8px; border-top: 1px solid var(--bg-tertiary); }
        .quest-actions { display: flex; gap: 6px; flex-wrap: wrap; }
        .btn-ghost { background: transparent; border: none; color: var(--text-muted); padding: 4px 8px; font-size: 10px; cursor: pointer; letter-spacing: 1px; }
        .btn-ghost:hover { color: var(--danger); text-shadow: 0 0 10px rgba(255,51,102,0.5); }

        .receipt { display: flex; gap: 10px; padding: 10px 0; border-bottom: 1px solid var(--bg-tertiary); }
        .receipt:last-child { border-bottom: none; }
        .receipt-check { width: 20px; height: 20px; background: var(--accent); color: var(--bg-primary); display: flex; align-items: center; justify-content: center; font-size: 10px; flex-shrink: 0; }
        .receipt-content { flex: 1; }
        .receipt-title { font-size: 11px; margin-bottom: 2px; }
        .receipt-meta { font-size: 9px; color: var(--text-secondary); }
        .receipt-reflection { font-size: 10px; color: var(--text-secondary); margin-top: 6px; padding: 8px; background: var(--bg-primary); font-style: italic; }

        .capsule-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px; }
        .capsule { background: var(--bg-secondary); border: 1px solid var(--bg-tertiary); padding: 20px; text-align: center; }
        .capsule.locked { opacity: 0.5; }
        .capsule.unlocked { border-color: var(--accent); }
        .capsule-day { font-size: 10px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px; }
        .capsule-icon { font-size: 28px; margin-bottom: 8px; }
        .capsule-status { font-size: 9px; letter-spacing: 1px; text-transform: uppercase; }
        .capsule-status.locked { color: var(--text-muted); }
        .capsule-status.unlocked { color: var(--accent); }

        .chat-container { display: flex; flex-direction: column; height: calc(100vh - 160px); }
        .chat-messages { flex: 1; overflow-y: auto; padding: 15px 0; }
        .chat-msg { display: flex; gap: 10px; margin-bottom: 15px; }
        .chat-msg.user { flex-direction: row-reverse; }
        .chat-avatar { width: 28px; height: 28px; border-radius: 50%; background: var(--bg-tertiary); display: flex; align-items: center; justify-content: center; font-size: 11px; flex-shrink: 0; }
        .chat-msg.ai .chat-avatar { background: var(--accent); color: var(--bg-primary); }
        .chat-bubble { max-width: 70%; padding: 10px 14px; background: var(--bg-secondary); border: 1px solid var(--bg-tertiary); font-size: 12px; line-height: 1.5; }
        .chat-msg.user .chat-bubble { background: var(--bg-tertiary); }
        .chat-input-row { display: flex; gap: 8px; padding-top: 12px; border-top: 1px solid var(--bg-tertiary); }
        .chat-input { flex: 1; padding: 10px; background: var(--bg-secondary); border: 1px solid var(--bg-tertiary); color: var(--text-primary); font-family: var(--font-mono); font-size: 12px; resize: none; }
        .chat-input:focus { outline: none; border-color: var(--accent); }
        .chat-send { padding: 10px 18px; background: var(--accent); border: none; color: var(--bg-primary); font-family: var(--font-mono); font-size: 10px; font-weight: 700; cursor: pointer; }

        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.85); display: flex; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
        .modal { background: var(--bg-secondary); border: 1px solid var(--bg-tertiary); padding: 25px; max-width: 450px; width: 100%; }
        .modal-title { font-family: var(--font-display); font-size: 20px; margin-bottom: 15px; }

        .spinner { width: 20px; height: 20px; border: 2px solid var(--bg-tertiary); border-top-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { to { transform: rotate(360deg); } }

        @media (max-width: 900px) {
            .grid-2 { grid-template-columns: 1fr; }
            .stats { grid-template-columns: repeat(2, 1fr); }
            .capsule-grid { grid-template-columns: repeat(2, 1fr); }
            .choice-grid { grid-template-columns: 1fr; }
        }
        @media (max-width: 700px) {
            .sidebar { display: none; }
            .main { margin-left: 0; padding: 15px; padding-bottom: 80px; }
            .results-meters { flex-wrap: wrap; }
            
            /* Mobile bottom nav */
            .mobile-nav { display: flex !important; }
            
            /* Fix login/signup screens */
            .screen-center { padding: 20px 15px; min-height: 100vh; }
            .container-sm, .container-md { padding: 0 10px; }
            .logo { font-size: 14px; margin-bottom: 30px; }
            .card-title { font-size: 20px; }
            .form-input, .form-textarea, select.form-input { font-size: 16px !important; } /* Prevents zoom on iOS */
            .btn { padding: 14px 20px; font-size: 12px; }
            .btn-full { width: 100%; }
            
            /* Quiz mobile */
            .quiz-option { padding: 14px; font-size: 13px; }
            
            /* Results mobile */
            .result-meter { min-width: 100%; }
            
            /* Dashboard mobile */
            .page-header { padding: 15px 0; }
            .page-title { font-size: 22px; }
            .stat-value { font-size: 28px; }
            
            /* Quests mobile */
            .quest { padding: 15px; }
            .quest-title { font-size: 13px; }
            .quest-actions { flex-direction: column; gap: 8px; }
            .quest-actions .btn { width: 100%; }
            
            /* Chat mobile */
            .chat-container { height: calc(100vh - 200px); }
            .chat-input { font-size: 16px !important; }
            
            /* Cards mobile */
            .card { padding: 15px; }
            .card-header { flex-wrap: wrap; gap: 10px; }
            
            /* Modal mobile */
            .modal { margin: 15px; padding: 20px; max-height: 90vh; overflow-y: auto; }
            
            /* Tabs mobile */
            .tabs { flex-wrap: wrap; gap: 5px; }
            .tab { padding: 8px 12px; font-size: 11px; flex: 1; text-align: center; min-width: 80px; }
            
            /* Onboarding mobile */
            .onboard-progress { padding: 15px 0; }
            .goals-grid, .interests-grid { grid-template-columns: 1fr; }
            .goal-option, .interest-option { padding: 12px; }
            
            /* Settings mobile */
            .form-group { margin-bottom: 15px; }
            
            /* Forecasts mobile */
            .forecast-card { padding: 15px; }
            .opp-card { padding: 12px; }
            
            /* Hide desktop elements */
            .desktop-only { display: none !important; }
        }
        
        /* Mobile bottom navigation */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 1px solid var(--bg-tertiary);
            padding: 8px 0;
            padding-bottom: max(8px, env(safe-area-inset-bottom));
            z-index: 1000;
            justify-content: space-around;
        }
        .mobile-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 10px;
            letter-spacing: 0.5px;
            cursor: pointer;
        }
        .mobile-nav-item.active { color: var(--accent); }
        .mobile-nav-item span { font-size: 18px; }
        
        /* More menu popup */
        .more-menu {
            display: none;
            position: fixed;
            bottom: 70px;
            right: 10px;
            background: var(--bg-secondary);
            border: 1px solid var(--bg-tertiary);
            border-radius: 8px;
            padding: 8px 0;
            min-width: 160px;
            z-index: 1001;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
        }
        .more-menu.show { display: block; }
        .more-menu-item {
            padding: 12px 16px;
            font-size: 13px;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .more-menu-item:hover, .more-menu-item:active {
            background: var(--bg-tertiary);
        }
        .more-menu-item span { font-size: 14px; opacity: 0.7; }
    </style>
</head>
<body>
<div id="app"></div>
<script>
const OPENAI_API = '/.netlify/functions/openai';
const SUPABASE_URL = 'https://snbchuvvnbwvghmbxehv.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNuYmNodXZ2bmJ3dmdobWJ4ZWh2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk5MDg5NzMsImV4cCI6MjA4NTQ4NDk3M30.cKPieraN3FRT_5ilAQL0X2b9kIpklzE49xGzVJwYxZo';
const STRIPE_LINK = 'https://buy.stripe.com/8x2eVdbgP4yL6VK32q9ws01';
const STRIPE_ANNUAL = 'https://buy.stripe.com/dRm5kDbgP5CPdk89qO9ws02';

const S = {
    screen: 'login', user: null, scores: {ideas:50,personality:50,execution:50},
    quests: [], receipts: [], chat: [], loading: false, modal: null, selectedQuest: null,
    quizStep: 0, quizAnswers: [], uploadedFile: null, diff: 'standard', gptAnalysis: null, weeklyReview: null,
    coachMode: 'ideas', // which coach is active
    showMoreMenu: false, // mobile more menu state
    // Quest customization
    hiddenQuests: [], // quest IDs user has hidden
    customQuests: [], // user-created quests
    followedForecasts: [], // forecast IDs user is tracking
    forecastProgress: {}, // {forecastId: {oppId: questIndex}} tracks which quest they're on
    // Onboarding data
    onboardStep: 1, // 1=account, 2=occupation, 3=goals, 4=interests, 5=assessment, 6=results+forecasts, 7=email+paywall
    onboardData: {
        occupation: '',
        industry: '',
        experience: '',
        goals: [],
        forecastInterests: []
    },
    onboardSelectedForecasts: [], // forecasts selected during onboarding step 6
    weeklyEmailOptIn: null, // {email, optedIn} for weekly quest emails
    freeQuizMode: false, // true if taking quiz from landing page (not logged in)
    freeQuizScores: null, // store scores from free quiz
    // Forecasts
    forecasts: [],
    forecastFilter: 'all', // all, ai, tech, crypto, politics, science
    forecastPerson: 'all',
    selectedForecast: null,
    opportunities: {}
};

async function db(table, method, data=null, query='') {
    const url = `${SUPABASE_URL}/rest/v1/${table}${query}`;
    const opt = { method, headers: {'apikey':SUPABASE_KEY,'Authorization':`Bearer ${SUPABASE_KEY}`,'Content-Type':'application/json','Prefer':method==='POST'?'return=representation':''} };
    if(data) opt.body = JSON.stringify(data);
    try { const r = await fetch(url,opt); if(!r.ok) return null; const t = await r.text(); return t ? JSON.parse(t) : true; } catch(e) { return null; }
}

async function ai(msgs, tokens=500, type='general') {
    try {
        const r = await fetch(OPENAI_API, {
            method:'POST', headers:{'Content-Type':'application/json'},
            body: JSON.stringify({messages:msgs, type:type})
        });
        const d = await r.json(); if(d.error) throw new Error(d.error); return d.content;
    } catch(e) { console.error(e); return null; }
}

const Qs = [
    // DECISION MAKING (Ideas)
    {t:"When facing a complex decision, you typically:",o:[
        {t:"Map out all possible scenarios and outcomes",m:"ideas",w:2},
        {t:"Talk through it with people you trust",m:"personality",w:2},
        {t:"Make a quick call and adjust as you go",m:"execution",w:2},
        {t:"Research until you feel completely confident",m:"ideas",w:1}
    ]},
    {t:"When someone presents a plan with flaws, you:",o:[
        {t:"Point out the logical gaps immediately",m:"ideas",w:2},
        {t:"Ask questions to help them see the issues",m:"personality",w:2},
        {t:"Focus on what's actionable and move forward",m:"execution",w:2},
        {t:"Stay quiet to avoid conflict",m:"personality",w:-1}
    ]},
    {t:"Your ideas usually:",o:[
        {t:"Stay in your head or a notes app",m:"ideas",w:-1},
        {t:"Get shared but rarely acted on",m:"ideas",w:1},
        {t:"Turn into conversations that energize others",m:"personality",w:2},
        {t:"Become projects you actually complete",m:"execution",w:2}
    ]},
    // SOCIAL DYNAMICS (Personality)
    {t:"At a networking event or party, you:",o:[
        {t:"Find one interesting person for deep conversation",m:"ideas",w:1},
        {t:"Work the room and meet lots of people",m:"personality",w:2},
        {t:"Look for people who can help your goals",m:"execution",w:1},
        {t:"Leave earlyâ€”draining",m:"personality",w:-1}
    ]},
    {t:"When someone disagrees with you publicly:",o:[
        {t:"Defend your position with logic and evidence",m:"ideas",w:2},
        {t:"Find common ground to defuse tension",m:"personality",w:2},
        {t:"Stand firmâ€”conflict doesn't bother you",m:"execution",w:1},
        {t:"Back down to keep the peace",m:"execution",w:-1}
    ]},
    {t:"People come to you when they need:",o:[
        {t:"A fresh perspective or creative solution",m:"ideas",w:2},
        {t:"Someone to listen and support them",m:"personality",w:2},
        {t:"Someone to help get things done",m:"execution",w:2},
        {t:"They don't usually come to me",m:"personality",w:-1}
    ]},
    {t:"Your humor style is:",o:[
        {t:"Witty, clever, observational",m:"ideas",w:1},
        {t:"Warm, self-deprecating, brings people together",m:"personality",w:2},
        {t:"Sarcastic, dry, quick",m:"execution",w:1},
        {t:"I'm not really the funny one",m:"personality",w:-1}
    ]},
    // EXECUTION & FOLLOW-THROUGH
    {t:"When you commit to something:",o:[
        {t:"You think it through carefully first",m:"ideas",w:1},
        {t:"You get others bought in",m:"personality",w:1},
        {t:"You do itâ€”your word is your bond",m:"execution",w:2},
        {t:"Honestly, you often don't follow through",m:"execution",w:-2}
    ]},
    {t:"Your to-do list is:",o:[
        {t:"Full of ideas, loosely organized",m:"ideas",w:1},
        {t:"Shared with others for accountability",m:"personality",w:1},
        {t:"Short and gets done daily",m:"execution",w:2},
        {t:"Overwhelming and growing",m:"execution",w:-1}
    ]},
    {t:"When a project stalls, you typically:",o:[
        {t:"Rethink the strategyâ€”maybe wrong approach",m:"ideas",w:1},
        {t:"Get others involved to push through",m:"personality",w:1},
        {t:"Force yourself to just do the next step",m:"execution",w:2},
        {t:"Let it sitâ€”maybe it wasn't meant to be",m:"execution",w:-2}
    ]},
    // AMBITION & RISK
    {t:"When you want something from someone:",o:[
        {t:"Build a compelling logical case",m:"ideas",w:2},
        {t:"Build relationship first, ask later",m:"personality",w:2},
        {t:"Ask directlyâ€”worst they can say is no",m:"execution",w:2},
        {t:"Hint and hope they offer",m:"personality",w:-1}
    ]},
    {t:"Taking risks makes you feel:",o:[
        {t:"Excited if it's a calculated risk",m:"ideas",w:1},
        {t:"Better when others are taking them with you",m:"personality",w:1},
        {t:"Aliveâ€”you'd rather act than wait",m:"execution",w:2},
        {t:"Anxiousâ€”you prefer safety",m:"execution",w:-1}
    ]},
    // SELF-ASSESSMENT
    {t:"Your biggest professional weakness is:",o:[
        {t:"Overthinking and analysis paralysis",m:"ideas",w:-1},
        {t:"Caring too much what others think",m:"personality",w:-1},
        {t:"Taking on too much and burning out",m:"execution",w:1},
        {t:"Not finishing what you start",m:"execution",w:-2}
    ]},
    {t:"If you had to give a TEDx talk tomorrow:",o:[
        {t:"Excitingâ€”you have lots of ideas to share",m:"ideas",w:2},
        {t:"Scary but you'd rise to the occasion",m:"personality",w:1},
        {t:"You'd focus on lessons from things you've built",m:"execution",w:2},
        {t:"Terrifyingâ€”public speaking is your nightmare",m:"personality",w:-1}
    ]},
    {t:"In five years, you want people to say you:",o:[
        {t:"See things others miss",m:"ideas",w:2},
        {t:"Are magnetic and well-connected",m:"personality",w:2},
        {t:"Ship like crazy and make things happen",m:"execution",w:2},
        {t:"Are reliable and steady",m:"execution",w:1}
    ]}
];

// Occupation and industry options
const OCCUPATIONS = [
    "Software Engineer / Developer",
    "Product Manager",
    "Designer (UX/UI/Graphic)",
    "Data Scientist / Analyst",
    "Marketing / Growth",
    "Sales / Business Development", 
    "Founder / CEO",
    "Executive / C-Suite",
    "Consultant",
    "Finance / Accounting",
    "Operations / Project Manager",
    "Content Creator / Writer",
    "Student",
    "Unemployed / Between Jobs",
    "Other"
];

const INDUSTRIES = [
    "Technology / Software",
    "Finance / Banking",
    "Healthcare",
    "E-commerce / Retail",
    "Media / Entertainment",
    "Consulting",
    "Education",
    "Real Estate",
    "Manufacturing",
    "Government / Non-profit",
    "Crypto / Web3",
    "AI / Machine Learning",
    "Other"
];

const GOALS = [
    {id: "decisions", label: "Make better decisions faster", icon: "ðŸŽ¯"},
    {id: "relationships", label: "Build stronger professional relationships", icon: "ðŸ¤"},
    {id: "shipping", label: "Ship projects without procrastinating", icon: "ðŸš€"},
    {id: "ai-prep", label: "Prepare for AI disruption", icon: "ðŸ¤–"},
    {id: "business", label: "Build a business", icon: "ðŸ’¼"},
    {id: "career", label: "Get promoted / change careers", icon: "ðŸ“ˆ"},
    {id: "influence", label: "Become more influential", icon: "âš¡"},
    {id: "confidence", label: "Build confidence", icon: "ðŸ’ª"}
];

const FORECAST_INTERESTS = [
    {id: "ai", label: "AI & Technology", icon: "ðŸ¤–"},
    {id: "work", label: "Future of Work", icon: "ðŸ’¼"},
    {id: "finance", label: "Finance & Markets", icon: "ðŸ“ˆ"},
    {id: "crypto", label: "Crypto & Web3", icon: "â‚¿"},
    {id: "media", label: "Media & Content", icon: "ðŸŽ¬"},
    {id: "tech", label: "Robotics & Hardware", icon: "ðŸ¦¾"}
];

const QB = {
    ideas: {
        easy: [{t:"Write down one decision you've been avoiding.",xp:20,tip:"Awareness first."},{t:"Ask one clarifying question today.",xp:25,tip:"Questions > assumptions."}],
        standard: [{t:"Make a decision you've postponed 3+ days. Tell someone.",xp:50,tip:"Deciding is a muscle."},{t:"Take your best idea, write 3 next steps. Share it.",xp:45,tip:"Ideas without steps are dreams."}],
        hard: [{t:"Make a reversible decision in 2 minutes. No research. Act.",xp:80,tip:"Speed > perfection."},{t:"Pitch an idea to someone who can say yes.",xp:90,tip:"Ideas need oxygen."}]
    },
    personality: {
        easy: [{t:"Give someone a specific, genuine compliment.",xp:20,tip:"'I noticed you...' works."},{t:"Start a conversation with someone you don't usually talk to.",xp:25,tip:"New connections = leverage."}],
        standard: [{t:"Add levity to a tense moment. Notice reactions.",xp:50,tip:"Humor defuses."},{t:"Disagree respectfully in a group setting.",xp:55,tip:"Calibrated disagreement builds respect."}],
        hard: [{t:"Post a genuine opinion on LinkedIn/Twitter. Your take.",xp:80,tip:"If it feels risky, it's right."},{t:"Have a difficult conversation you've been avoiding.",xp:90,tip:"The conversation you fear is the one you need."}],
        anon: [{t:"Create an anonymous account and post one opinion.",xp:40,tip:"Start protected."},{t:"Reply to someone influential with a thoughtful take (anon ok).",xp:45,tip:"Anonymous reps count."}]
    },
    execution: {
        easy: [{t:"Send one email you've been putting off.",xp:20,tip:"Done > perfect."},{t:"Complete one small task on your list for 3+ days.",xp:25,tip:"Clear the queue."}],
        standard: [{t:"Rewrite your last email 40% shorter. Send it.",xp:45,tip:"Brevity = respect."},{t:"Decline a meeting that doesn't serve your goals.",xp:55,tip:"'I can't make this work' is complete."}],
        hard: [{t:"Ask for something you want. Directly. No hints.",xp:80,tip:"Clear asks get clear answers."},{t:"Follow up on a commitment someone made. Hold them accountable.",xp:75,tip:"Accountability goes both ways."}]
    },
    boss: [
        {t:"Ask for a raise or promotion. Make the case.",xp:200,m:"execution",tip:"You don't get what you don't ask for."},
        {t:"Publish something with your name. Blog, tweet thread, article.",xp:180,m:"personality",tip:"Reputation is built in public."},
        {t:"Have THE conversation you've avoided for weeks.",xp:200,m:"personality",tip:"Avoidance compounds."},
        {t:"Ship a side project. Announce it publicly.",xp:190,m:"execution",tip:"Shipping is the skill."}
    ]
};

function weakest() { const {ideas:i,personality:p,execution:e}=S.scores; if(i<=p&&i<=e)return'ideas'; if(p<=i&&p<=e)return'personality'; return'execution'; }
function strongest() { const {ideas:i,personality:p,execution:e}=S.scores; if(i>=p&&i>=e)return'ideas'; if(p>=i&&p>=e)return'personality'; return'execution'; }

// Skew the weakest score down to create urgency, keep others real
function skewScores(raw) {
    const modes = ['ideas', 'personality', 'execution'];
    const weakestMode = modes.reduce((a, b) => raw[a] < raw[b] ? a : b);
    const skewAmount = Math.floor(Math.random() * 6) + 10; // 10-15 points
    
    return {
        ideas: raw.ideas,
        personality: raw.personality,
        execution: raw.execution,
        [weakestMode]: Math.max(20, raw[weakestMode] - skewAmount)
    };
}

// Calculate percentile for display (makes scores feel more meaningful)
function getPercentile(score) {
    // Rough mapping: 20=5th, 50=50th, 80=95th
    if (score <= 30) return Math.round(score * 0.5);
    if (score <= 50) return Math.round(15 + (score - 30) * 1.25);
    if (score <= 70) return Math.round(40 + (score - 50) * 2);
    return Math.round(80 + (score - 70) * 0.67);
}

// Get suggested forecasts based on user interests and assessment
function getSuggestedForecasts() {
    const interests = S.onboardData?.forecastInterests || [];
    const weak = weakest();
    
    // Map interests to forecast categories
    const categoryMap = {
        'ai': ['ai', 'tech'],
        'work': ['work'],
        'finance': ['finance', 'crypto'],
        'creative': ['media'],
        'health': ['work'], // health interests map to work/longevity forecasts
        'business': ['tech', 'finance']
    };
    
    // Get relevant categories
    let relevantCategories = [];
    interests.forEach(interest => {
        if(categoryMap[interest]) {
            relevantCategories = [...relevantCategories, ...categoryMap[interest]];
        }
    });
    relevantCategories = [...new Set(relevantCategories)];
    if(relevantCategories.length === 0) relevantCategories = ['ai', 'tech', 'work']; // defaults
    
    // Filter and sort forecasts
    let forecasts = FORECAST_DATABASE.filter(f => relevantCategories.includes(f.category));
    
    // Prioritize forecasts that match user's weak mode
    forecasts.sort((a, b) => {
        const aMatchesWeak = a.threatMode === weak ? 1 : 0;
        const bMatchesWeak = b.threatMode === weak ? 1 : 0;
        if(bMatchesWeak !== aMatchesWeak) return bMatchesWeak - aMatchesWeak;
        return b.probability - a.probability; // Higher probability first
    });
    
    return forecasts.slice(0, 10); // Return top 10
}

// Get teaser quests from selected forecasts
function getTeaserQuests(selectedForecastIds) {
    const forecasts = selectedForecastIds.length > 0 
        ? FORECAST_DATABASE.filter(f => selectedForecastIds.includes(f.id))
        : getSuggestedForecasts().slice(0, 3);
    
    let quests = [];
    forecasts.forEach(f => {
        if(f.opportunities && f.opportunities[0] && f.opportunities[0].quests) {
            const opp = f.opportunities[0];
            opp.quests.slice(0, 2).forEach((q, idx) => {
                quests.push({
                    mode: q.mode,
                    task: q.task,
                    xp: q.xp,
                    forecastTitle: f.title,
                    forecastId: f.id
                });
            });
        }
    });
    
    return quests.slice(0, 6); // Max 6 teaser quests
}

function dayNum() { if(!S.user?.start_date)return 1; return Math.floor((Date.now()-new Date(S.user.start_date).getTime())/86400000)+1; }
function totalXP() { return S.receipts.reduce((s,r)=>s+(r.xp||0),0); }

// Get date string in YYYY-MM-DD format (timezone safe)
function getDateStr(date = new Date()) {
    const d = new Date(date);
    return d.getFullYear() + '-' + String(d.getMonth()+1).padStart(2,'0') + '-' + String(d.getDate()).padStart(2,'0');
}

// Calculate streak from receipts
function streak() {
    if(!S.receipts || !S.receipts.length) return 0;
    
    // Get unique dates from receipts (in YYYY-MM-DD format for consistent comparison)
    const receiptDates = [...new Set(S.receipts.map(r => {
        if(!r.ts) return null;
        return getDateStr(new Date(r.ts));
    }).filter(d => d))].sort().reverse(); // Most recent first
    
    if(!receiptDates.length) return 0;
    
    const today = getDateStr();
    const yesterday = getDateStr(new Date(Date.now() - 86400000));
    
    // If most recent activity was before yesterday, streak is broken
    if(receiptDates[0] !== today && receiptDates[0] !== yesterday) return 0;
    
    // Count consecutive days going backwards from today
    let streakCount = 0;
    let checkDate = new Date();
    
    // Start from today and go backwards
    for(let i = 0; i < 365; i++) { // Max 1 year streak
        const dateStr = getDateStr(checkDate);
        if(receiptDates.includes(dateStr)) {
            streakCount++;
            checkDate = new Date(checkDate.getTime() - 86400000); // Go back one day
        } else if(i === 0 && receiptDates[0] === yesterday) {
            // Today has no activity but yesterday did - still valid, start from yesterday
            checkDate = new Date(checkDate.getTime() - 86400000);
        } else {
            break; // Gap found, streak ends
        }
    }
    
    return streakCount;
}

// Update streak when user completes a quest (also tracks in localStorage for persistence)
function updateStreakData() {
    const today = getDateStr();
    const streakData = JSON.parse(localStorage.getItem('apc_streak') || '{}');
    
    // Record today's activity
    if(!streakData.activeDates) streakData.activeDates = [];
    if(!streakData.activeDates.includes(today)) {
        streakData.activeDates.push(today);
        // Keep only last 365 days
        streakData.activeDates = streakData.activeDates.slice(-365);
    }
    streakData.lastActive = today;
    
    localStorage.setItem('apc_streak', JSON.stringify(streakData));
}

// Progressive Quest Curriculum - Gets harder each week
const CURRICULUM = {
    ideas: [
        // Week 1-2: Awareness
        [{t:"Write down one decision you've been avoiding.",xp:20,tip:"Awareness first."},{t:"Notice when you're overthinking today. Just notice.",xp:15,tip:"Pattern recognition."}],
        [{t:"Ask one clarifying question in a meeting.",xp:25,tip:"Questions > assumptions."},{t:"Identify one assumption you're making about a project.",xp:20,tip:"Name it to tame it."}],
        // Week 3-4: Action
        [{t:"Make a small decision in under 2 minutes. No research.",xp:35,tip:"Speed builds muscle."},{t:"Share one idea with someone who can act on it.",xp:40,tip:"Ideas need oxygen."}],
        [{t:"Make a decision you've postponed 3+ days. Tell someone.",xp:50,tip:"Deciding is a muscle."},{t:"Take your best idea, write 3 next steps. Share it.",xp:45,tip:"Ideas without steps are dreams."}],
        // Week 5-6: Challenge
        [{t:"Challenge one belief you hold about your work. Write the counter-argument.",xp:55,tip:"Strong opinions, loosely held."},{t:"Propose a new approach to a stuck problem. In writing.",xp:60,tip:"Written = committed."}],
        [{t:"Make a reversible decision in 2 minutes. No research. Act on it.",xp:70,tip:"Speed > perfection."},{t:"Kill one project or idea you've been holding onto.",xp:65,tip:"Pruning creates growth."}],
        // Week 7+: Mastery
        [{t:"Pitch an idea to someone who can say yes. Get a real response.",xp:90,tip:"Ideas need champions."},{t:"Make a decision that affects others. Own it publicly.",xp:85,tip:"Leaders decide."}]
    ],
    personality: [
        // Week 1-2: Awareness
        [{t:"Notice one social dynamic in a meeting today.",xp:15,tip:"Observation first."},{t:"Pay attention to how someone responds to you. What worked?",xp:20,tip:"Calibration starts with noticing."}],
        [{t:"Give someone a specific, genuine compliment.",xp:25,tip:"'I noticed you...' works."},{t:"Start a conversation with someone you don't usually talk to.",xp:25,tip:"New connections = leverage."}],
        // Week 3-4: Action
        [{t:"Add levity to a slightly tense moment. Notice reactions.",xp:40,tip:"Humor defuses."},{t:"Ask someone 'What's been on your mind?' and actually listen.",xp:35,tip:"Curiosity > agenda."}],
        [{t:"Disagree respectfully in a group setting. Stay calm.",xp:50,tip:"Calibrated disagreement builds respect."},{t:"Give feedback to someone. Specific and constructive.",xp:55,tip:"Feedback is a gift."}],
        // Week 5-6: Challenge
        [{t:"Recover gracefully from an awkward moment. Document what worked.",xp:60,tip:"Recovery > prevention."},{t:"Have a mildly uncomfortable conversation. Stay in it.",xp:65,tip:"Comfort zone expands."}],
        [{t:"Post a genuine opinion online. Your take, your name.",xp:75,tip:"If it feels risky, it's right."},{t:"Ask for feedback from someone whose opinion intimidates you.",xp:70,tip:"Intimidation = respect."}],
        // Week 7+: Mastery
        [{t:"Have a difficult conversation you've been avoiding. Be direct.",xp:90,tip:"The conversation you fear is the one you need."},{t:"Influence a group decision without dominating.",xp:85,tip:"Soft power > hard power."}]
    ],
    execution: [
        // Week 1-2: Awareness
        [{t:"Track how long tasks actually take today vs your estimate.",xp:15,tip:"Awareness of time."},{t:"Notice one thing you're procrastinating on. Just notice.",xp:20,tip:"Name the avoidance."}],
        [{t:"Send one email you've been putting off.",xp:25,tip:"Done > perfect."},{t:"Complete one small task on your list for 3+ days.",xp:25,tip:"Clear the queue."}],
        // Week 3-4: Action
        [{t:"Rewrite your last email 40% shorter. Send it.",xp:40,tip:"Brevity = respect."},{t:"Set a 25-min timer and work on ONE thing. No switching.",xp:35,tip:"Focus is a skill."}],
        [{t:"Decline a meeting that doesn't serve your goals. No apology.",xp:50,tip:"'I can't make this' is complete."},{t:"Ship something at 80%. Stop polishing.",xp:55,tip:"Shipped > perfect."}],
        // Week 5-6: Challenge
        [{t:"Follow up on a commitment someone made. Hold them accountable.",xp:60,tip:"Accountability goes both ways."},{t:"Set a deadline and hit it. No extensions.",xp:65,tip:"Deadlines reveal priorities."}],
        [{t:"Ask for something you want. Directly. No hints.",xp:75,tip:"Clear asks get clear answers."},{t:"Delegate something you usually do yourself.",xp:70,tip:"Leverage > labor."}],
        // Week 7+: Mastery
        [{t:"Ship a complete project this week. Announce it.",xp:90,tip:"Shipping is the skill."},{t:"Say no to something good to protect something great.",xp:85,tip:"No is a complete sentence."}]
    ],
    boss: [
        // Progressive boss quests
        [{t:"Send a message to someone you admire. Genuine, not needy.",xp:100,m:"personality"},{t:"Publish something with your name on it. Anywhere.",xp:100,m:"execution"}],
        [{t:"Ask for a small raise or new responsibility.",xp:150,m:"execution"},{t:"Share a contrarian opinion in a professional setting.",xp:140,m:"personality"}],
        [{t:"Pitch yourself for an opportunity you're not sure you're ready for.",xp:180,m:"ideas"},{t:"Have THE conversation you've avoided for weeks.",xp:180,m:"personality"}],
        [{t:"Ask for a significant raise or promotion. Make the case.",xp:200,m:"execution"},{t:"Ship a side project and announce it publicly.",xp:200,m:"execution"}]
    ]
};

function getWeekNumber() {
    const start = S.user?.start_date ? new Date(S.user.start_date) : new Date();
    const now = new Date();
    const diff = now - start;
    return Math.floor(diff / (7 * 24 * 60 * 60 * 1000)) + 1;
}

function getCurriculumWeek() {
    const week = getWeekNumber();
    // Map week to curriculum index (0-6, then stays at 6 for mastery)
    if (week <= 2) return 0;
    if (week <= 4) return 1;
    if (week <= 6) return 2;
    if (week <= 8) return 3;
    if (week <= 10) return 4;
    if (week <= 12) return 5;
    return 6; // Mastery level
}

function genQuests() {
    const w = weakest();
    const d = S.diff || 'standard'; // Use user-selected difficulty
    const qs = [];
    
    // Get quests from QB (quest bank) based on selected difficulty
    const modeQuests = QB[w][d] || QB[w]['standard'];
    
    // 2 quests from weakest mode
    const shuffled = [...modeQuests].sort(() => Math.random() - 0.5);
    shuffled.slice(0, 2).forEach(q => {
        qs.push({...q, mode: w, diff: d, id: Date.now() + Math.random(), done: false});
    });
    
    // 1 quest from each other mode
    ['ideas', 'personality', 'execution'].filter(m => m !== w).forEach(m => {
        const otherQuests = QB[m][d] || QB[m]['standard'];
        const q = otherQuests[Math.floor(Math.random() * otherQuests.length)];
        qs.push({...q, mode: m, diff: d, id: Date.now() + Math.random(), done: false});
    });
    
    // Anonymous option for personality if struggling (only on easy)
    if (w === 'personality' && S.scores.personality < 40 && d === 'easy') {
        const anonQuests = QB.personality.anon;
        if (anonQuests?.length) {
            const q = anonQuests[Math.floor(Math.random() * anonQuests.length)];
            qs.push({...q, mode: 'personality', diff: 'anon', id: Date.now() + Math.random(), done: false});
        }
    }
    
    // Boss quest on hard mode
    if (d === 'hard' && QB.boss?.length) {
        const boss = QB.boss[Math.floor(Math.random() * QB.boss.length)];
        qs.push({t: boss.t, xp: boss.xp, mode: boss.m, diff: 'boss', tip: boss.tip, id: Date.now() + Math.random(), done: false, boss: true});
    }
    
    return qs;
}

function getDiffLabel(diff) {
    const labels = {easy: 'Easy', standard: 'Standard', hard: 'Hard', anon: 'Anon OK', boss: 'Boss'};
    return labels[diff] || diff;
}

function shouldRefreshQuests() {
    if (!S.user?.lastQuestWeek) return true;
    return getWeekNumber() > S.user.lastQuestWeek;
}

function checkWeeklyProgress() {
    if (shouldRefreshQuests()) {
        // Keep completed quests in history, generate new ones
        const newQuests = genQuests();
        S.quests = newQuests;
        S.user.lastQuestWeek = getWeekNumber();
        save();
    }
}

function capsules(){
    const start=S.user?.start_date?new Date(S.user.start_date):new Date(), d=dayNum();
    return [
        {day:1,label:'Day 1',unlocked:true,scores:S.user?.baseline_scores||S.scores},
        {day:30,label:'Day 30',unlocked:d>=30,scores:d>=30?S.scores:null},
        {day:60,label:'Day 60',unlocked:d>=60,scores:d>=60?S.scores:null},
        {day:90,label:'Day 90',unlocked:d>=90,scores:d>=90?S.scores:null}
    ];
}

function render(){
    const screens={
        login:loginH, signup:signupH, forgot:forgotH, pricing:pricingH,
        // Free quiz flow (from landing page)
        freeQuiz:quizH, freeResults:freeResultsH,
        // Onboarding flow
        onboarding:onboardingH, upload:uploadH, analyzing:analyzingH, quiz:quizH, results:resultsH,
        // App screens
        dashboard:()=>appH(dashH()), quests:()=>appH(questsH()), coach:()=>appH(coachH()), 
        receipts:()=>appH(receiptsH()), capsules:()=>appH(capsulesH()), review:()=>appH(reviewH()), 
        settings:()=>appH(settingsH()), forecasts:()=>appH(forecastsH())
    };
    document.getElementById('app').innerHTML=(screens[S.screen]||loginH)()+(S.modal?modalH():'');
    if(typeof updateHash === 'function') updateHash();
    bindEvents();
}

function loginH(){return `<div class="screen-center"><div class="container-sm"><div class="logo">AI PROOF <span>CLUB</span></div><div class="card"><h2 class="card-title">Welcome back</h2><p class="card-subtitle">Continue your training</p><form id="login-form"><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="email" required></div><div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="pass" required></div><button type="submit" class="btn btn-primary btn-full">Sign In</button></form><p class="text-center mt-10"><a class="text-link text-small" id="forgot-pass">Forgot password?</a></p><p class="text-center text-secondary text-small mt-20">New? <a class="text-link" id="to-signup">Start training</a></p></div><div class="card mt-20 text-center" style="border-color:var(--accent)"><p class="text-small mb-10">Not sure yet?</p><button class="btn btn-secondary btn-full" id="take-free-quiz">Take Free Diagnostic â†’</button><p class="text-secondary text-small mt-10">2 minutes. No signup required.</p></div></div></div>`;}

function freeResultsH(){
    const {ideas:i,personality:p,execution:e}=S.freeQuizScores||S.scores;
    const avgScore = Math.round((i+p+e)/3);
    const percentile = getPercentile(avgScore);
    const weak = ['ideas','personality','execution'].reduce((a,b)=>(S.freeQuizScores||S.scores)[a]<(S.freeQuizScores||S.scores)[b]?a:b);
    
    return `<div class="screen-center"><div class="container-md"><div class="logo">AI PROOF <span>CLUB</span></div>
    <div class="card text-center">
        <h2 class="card-title">Your Mode Profile</h2>
        <p class="text-secondary text-small mb-20">Based on your responses</p>
        
        <div class="results-meters">
            <div class="meter"><div class="meter-circle ideas">${i}%</div><div class="meter-label">Ideas</div></div>
            <div class="meter"><div class="meter-circle personality">${p}%</div><div class="meter-label">Personality</div></div>
            <div class="meter"><div class="meter-circle execution">${e}%</div><div class="meter-label">Execution</div></div>
        </div>
        
        <div class="verdict">
            <div class="verdict-title">Your Position</div>
            <div class="verdict-text">You're in the <strong>${percentile}th percentile</strong>. AI Proof Club starts at 85+.</div>
        </div>
        
        <div class="verdict" style="border-color:var(--danger)">
            <div class="verdict-title" style="color:var(--danger)">Your Gap</div>
            <div class="verdict-text"><strong style="text-transform:capitalize">${weak}</strong> is holding you back. This is where focused training pays off.</div>
        </div>
        
        <div style="background:var(--bg-primary);padding:20px;margin-top:25px;border:1px solid var(--accent)">
            <p class="text-small mb-10">Ready to train your weak spots?</p>
            <button class="btn btn-primary btn-full" id="free-to-signup">Start Training â†’</button>
            <p class="text-secondary text-small mt-10">$9.99/mo Â· Cancel anytime</p>
        </div>
    </div>
    <p class="text-center mt-20"><a class="text-link text-small" id="back-login">Already have an account? Sign in</a></p>
    </div></div>`;
}

function forgotH(){return `<div class="screen-center"><div class="container-sm"><div class="logo">AI PROOF <span>CLUB</span></div><div class="card"><h2 class="card-title">Reset Password</h2><p class="card-subtitle">Enter your email to reset</p><form id="forgot-form"><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="reset-email" required></div><button type="submit" class="btn btn-primary btn-full">Send Reset Link</button></form><p class="text-center text-secondary text-small mt-20"><a class="text-link" id="back-login">Back to sign in</a></p></div></div></div>`;}

function signupH(){return `<div class="screen-center"><div class="container-sm"><div class="logo">AI PROOF <span>CLUB</span></div><div class="card"><h2 class="card-title">Start training</h2><p class="card-subtitle">Build skills AI can't replace</p><form id="signup-form"><div class="form-group"><label class="form-label">Name</label><input type="text" class="form-input" id="name" required></div><div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="email" required></div><div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="pass" required minlength="6"></div><button type="submit" class="btn btn-primary btn-full">Create Account</button></form><p class="text-center text-secondary text-small mt-20">Have account? <a class="text-link" id="to-login">Sign in</a></p></div></div></div>`;}

function pricingH(){return `<div class="screen-center"><div class="container-sm"><div class="logo">AI PROOF <span>CLUB</span></div><div class="card text-center"><h2 class="card-title">Choose Your Plan</h2><p class="text-secondary text-small mb-20">Cancel anytime</p><div style="display:flex;flex-direction:column;gap:15px"><div style="border:2px solid var(--accent);padding:20px;background:var(--bg-primary)"><div style="font-size:11px;color:var(--accent);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Most Popular</div><div style="font-size:36px;font-weight:700">$9.99<span style="font-size:14px;color:var(--text-secondary)">/month</span></div><a href="${STRIPE_LINK}" class="btn btn-primary btn-full mt-20">Start Monthly â†’</a></div>${STRIPE_ANNUAL?`<div style="border:1px solid var(--bg-tertiary);padding:20px"><div style="font-size:11px;color:var(--success);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Best Value â€” 2 Months Free</div><div style="font-size:36px;font-weight:700">$99<span style="font-size:14px;color:var(--text-secondary)">/year</span></div><a href="${STRIPE_ANNUAL}" class="btn btn-secondary btn-full mt-20">Start Annual â†’</a></div>`:''}</div><ul style="list-style:none;text-align:left;margin-top:25px;font-size:12px"><li style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)">âœ“ Mode diagnostic + ChatGPT analysis</li><li style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)">âœ“ Progressive weekly quests</li><li style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)">âœ“ 3 AI Coaches (Ideas, Personality, Execution)</li><li style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)">âœ“ Progress capsules + Weekly reviews</li><li style="padding:8px 0">âœ“ Cancel anytime</li></ul></div></div></div>`;}

function onboardingH(){
    const step = S.onboardStep;
    const totalSteps = 7; // Updated: 1-account, 2-occupation, 3-goals, 4-interests, 5-quiz, 6-results+forecasts, 7-email+paywall
    
    // Progress bar
    const progressBar = `<div class="progress-bar" style="margin-bottom:30px">${Array(totalSteps).fill(0).map((_,i)=>`<div class="progress-dot ${i<step?'done':i===step-1?'active':''}"></div>`).join('')}</div>`;
    
    if(step === 1) {
        // Account creation
        return `<div class="screen-center"><div class="container-sm"><div class="logo">AI PROOF <span>CLUB</span></div>
        ${progressBar}
        <div class="card">
            <h2 class="card-title">Let's start with you</h2>
            <p class="card-subtitle">Create your account</p>
            <form id="onboard-account-form">
                <div class="form-group"><label class="form-label">Name</label><input type="text" class="form-input" id="ob-name" value="${S.user?.name||''}" required></div>
                <div class="form-group"><label class="form-label">Email</label><input type="email" class="form-input" id="ob-email" value="${S.user?.email||''}" required></div>
                <div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" id="ob-pass" minlength="6" required></div>
                <button type="submit" class="btn btn-primary btn-full">Continue â†’</button>
            </form>
        </div>
        <p class="text-center text-secondary text-small mt-20">Have account? <a class="text-link" id="to-login">Sign in</a></p>
        </div></div>`;
    }
    
    if(step === 2) {
        // Occupation
        return `<div class="screen-center"><div class="container-sm"><div class="logo">AI PROOF <span>CLUB</span></div>
        ${progressBar}
        <div class="card">
            <h2 class="card-title">What do you do?</h2>
            <p class="card-subtitle">This helps us personalize your training</p>
            <form id="onboard-occupation-form">
                <div class="form-group">
                    <label class="form-label">Occupation</label>
                    <select class="form-input" id="ob-occupation" required>
                        <option value="">Select your role...</option>
                        ${OCCUPATIONS.map(o=>`<option value="${o}" ${S.onboardData.occupation===o?'selected':''}>${o}</option>`).join('')}
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Industry</label>
                    <select class="form-input" id="ob-industry" required>
                        <option value="">Select your industry...</option>
                        ${INDUSTRIES.map(i=>`<option value="${i}" ${S.onboardData.industry===i?'selected':''}>${i}</option>`).join('')}
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Years of Experience</label>
                    <select class="form-input" id="ob-experience" required>
                        <option value="">Select...</option>
                        <option value="0-2" ${S.onboardData.experience==='0-2'?'selected':''}>0-2 years</option>
                        <option value="3-5" ${S.onboardData.experience==='3-5'?'selected':''}>3-5 years</option>
                        <option value="6-10" ${S.onboardData.experience==='6-10'?'selected':''}>6-10 years</option>
                        <option value="10+" ${S.onboardData.experience==='10+'?'selected':''}>10+ years</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary btn-full">Continue â†’</button>
            </form>
        </div>
        </div></div>`;
    }
    
    if(step === 3) {
        // Goals
        const selectedGoals = S.onboardData.goals || [];
        return `<div class="screen-center"><div class="container-md"><div class="logo">AI PROOF <span>CLUB</span></div>
        ${progressBar}
        <div class="card">
            <h2 class="card-title">What's driving you here?</h2>
            <p class="card-subtitle">Select all that apply</p>
            <div class="goal-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin:20px 0">
                ${GOALS.map(g=>`
                    <div class="choice-card goal-option ${selectedGoals.includes(g.id)?'selected':''}" data-goal="${g.id}" style="padding:15px;cursor:pointer">
                        <div style="font-size:24px;margin-bottom:8px">${g.icon}</div>
                        <div style="font-size:12px">${g.label}</div>
                    </div>
                `).join('')}
            </div>
            <button class="btn btn-primary btn-full" id="goals-continue" ${selectedGoals.length===0?'disabled':''}>Continue â†’</button>
        </div>
        </div></div>`;
    }
    
    if(step === 4) {
        // Fields of interest (renamed)
        const selectedInterests = S.onboardData.forecastInterests || [];
        return `<div class="screen-center"><div class="container-md"><div class="logo">AI PROOF <span>CLUB</span></div>
        ${progressBar}
        <div class="card">
            <h2 class="card-title">What are your fields of interest as AI evolves?</h2>
            <p class="card-subtitle">We'll show you relevant forecasts and opportunities</p>
            <div class="interest-grid" style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin:20px 0">
                ${FORECAST_INTERESTS.map(f=>`
                    <div class="choice-card interest-option ${selectedInterests.includes(f.id)?'selected':''}" data-interest="${f.id}" style="padding:15px;cursor:pointer">
                        <div style="font-size:24px;margin-bottom:8px">${f.icon}</div>
                        <div style="font-size:11px">${f.label}</div>
                    </div>
                `).join('')}
            </div>
            <button class="btn btn-primary btn-full" id="interests-continue" ${selectedInterests.length===0?'disabled':''}>Continue â†’</button>
        </div>
        </div></div>`;
    }
    
    if(step === 5) {
        // Direct to Assessment (no upload choice)
        return `<div class="screen-center"><div class="container-md"><div class="logo">AI PROOF <span>CLUB</span></div>
        ${progressBar}
        <div class="card text-center">
            <h2 class="card-title">Mode Assessment</h2>
            <p class="card-subtitle">15 quick questions to understand your strengths</p>
            
            <div style="background:var(--bg-primary);padding:25px;margin:25px 0;text-align:left">
                <div style="display:flex;gap:20px;margin-bottom:20px">
                    <div style="text-align:center;flex:1">
                        <div style="font-size:28px;margin-bottom:5px;color:var(--ideas)">ðŸ’¡</div>
                        <div style="font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--ideas)">Ideas</div>
                    </div>
                    <div style="text-align:center;flex:1">
                        <div style="font-size:28px;margin-bottom:5px;color:var(--personality)">âš¡</div>
                        <div style="font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--personality)">Personality</div>
                    </div>
                    <div style="text-align:center;flex:1">
                        <div style="font-size:28px;margin-bottom:5px;color:var(--execution)">ðŸŽ¯</div>
                        <div style="font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--execution)">Execution</div>
                    </div>
                </div>
                <p style="font-size:12px;color:var(--text-secondary);text-align:center">We'll measure these three modes that separate the top 1% from everyone else.</p>
            </div>
            
            <button class="btn btn-primary btn-full" id="start-assessment">Start Assessment â†’</button>
            <p class="text-secondary text-small mt-20">Takes about 3 minutes</p>
        </div>
        </div></div>`;
    }
    
    if(step === 6) {
        // Results + Suggested Forecasts
        const {ideas:i,personality:p,execution:e}=S.scores;
        const avgScore = Math.round((i+p+e)/3);
        const percentile = getPercentile(avgScore);
        const weak = weakest();
        const suggestedForecasts = getSuggestedForecasts();
        
        return `<div class="screen-center"><div class="container-md"><div class="logo">AI PROOF <span>CLUB</span></div>
        ${progressBar}
        <div class="card">
            <h2 class="card-title text-center">Your Mode Profile</h2>
            
            <div class="results-meters">
                <div class="meter"><div class="meter-circle ideas">${i}%</div><div class="meter-label">Ideas</div></div>
                <div class="meter"><div class="meter-circle personality">${p}%</div><div class="meter-label">Personality</div></div>
                <div class="meter"><div class="meter-circle execution">${e}%</div><div class="meter-label">Execution</div></div>
            </div>
            
            <div class="verdict">
                <div class="verdict-title">Your Position</div>
                <div class="verdict-text">You're in the <strong>${percentile}th percentile</strong>. AI Proof Club operates at 85%+ across all modes. Your <strong style="text-transform:capitalize">${weak}</strong> mode needs the most work.</div>
            </div>
            
            <div style="margin-top:25px">
                <h3 style="font-size:14px;margin-bottom:15px">ðŸ”® Suggested Forecasts for You</h3>
                <p class="text-secondary text-small mb-10">Based on your interests and assessment, these opportunities match your profile:</p>
                <div style="display:flex;flex-direction:column;gap:10px">
                    ${suggestedForecasts.slice(0,3).map(f=>`
                        <div class="suggested-forecast" data-fid="${f.id}" style="background:var(--bg-primary);border:1px solid var(--bg-tertiary);padding:15px;cursor:pointer;transition:all 0.3s;${S.onboardSelectedForecasts?.includes(f.id)?'border-color:var(--accent);':''}">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                                <span style="font-size:11px;color:var(--accent);text-transform:uppercase">${f.probability}% likely</span>
                                <span style="font-size:10px;color:var(--text-secondary)">${f.timeframe}</span>
                            </div>
                            <div style="font-size:13px;margin-bottom:5px">${f.title}</div>
                            <div style="font-size:11px;color:var(--text-secondary)">${f.opportunities[0]?.title || 'Opportunity available'}</div>
                        </div>
                    `).join('')}
                </div>
                <p class="text-secondary text-small mt-10 text-center">Tap to select forecasts you want to track</p>
            </div>
            
            <button class="btn btn-primary btn-full mt-20" id="forecasts-continue">Continue â†’</button>
        </div>
        </div></div>`;
    }
    
    if(step === 7) {
        // Email signup + Quest Teaser + Paywall
        const suggestedForecasts = getSuggestedForecasts();
        const selectedForecasts = S.onboardSelectedForecasts || [];
        const teaserQuests = getTeaserQuests(selectedForecasts);
        
        return `<div class="screen-center"><div class="container-md"><div class="logo">AI PROOF <span>CLUB</span></div>
        ${progressBar}
        <div class="card">
            <h2 class="card-title text-center">Your Weekly Quests Are Ready</h2>
            <p class="card-subtitle text-center">Based on ${selectedForecasts.length || 3} forecasts you're tracking</p>
            
            <div style="margin:20px 0">
                <h4 style="font-size:12px;text-transform:uppercase;letter-spacing:1px;margin-bottom:15px;color:var(--text-secondary)">This Week's Quests Preview</h4>
                ${teaserQuests.slice(0,3).map((q,idx)=>`
                    <div style="background:var(--bg-primary);border:1px solid var(--bg-tertiary);padding:15px;margin-bottom:10px;${idx > 0 ? 'filter:blur(3px);pointer-events:none;' : ''}">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                            <span class="quest-mode ${q.mode}" style="font-size:9px;padding:2px 6px">${q.mode}</span>
                            <span style="font-size:10px;color:var(--accent)">+${q.xp} XP</span>
                        </div>
                        <div style="font-size:13px">${q.task}</div>
                        <div style="font-size:10px;color:var(--text-secondary);margin-top:5px">ðŸ”® ${q.forecastTitle?.substring(0,40)}...</div>
                    </div>
                `).join('')}
                <div style="text-align:center;margin-top:5px">
                    <span style="font-size:11px;color:var(--text-secondary)">+ ${Math.max(0, teaserQuests.length - 3)} more quests this week</span>
                </div>
            </div>
            
            <div style="background:var(--bg-primary);border:1px solid var(--accent);padding:20px;margin:25px 0">
                <h4 style="font-size:12px;margin-bottom:15px;text-align:center">ðŸ“§ Get Weekly Quest Emails</h4>
                <p class="text-secondary text-small text-center mb-10">We'll send you personalized quests every week based on the forecasts you're tracking.</p>
                <div class="form-group" style="margin-bottom:0">
                    <input type="email" class="form-input" id="weekly-email" placeholder="your@email.com" value="${S.user?.email || ''}">
                </div>
                <label style="display:flex;align-items:center;gap:10px;margin-top:10px;cursor:pointer">
                    <input type="checkbox" id="email-optin" checked style="width:16px;height:16px">
                    <span style="font-size:11px;color:var(--text-secondary)">Send me weekly quest emails</span>
                </label>
            </div>
            
            <div style="border-top:1px solid var(--bg-tertiary);padding-top:25px;margin-top:25px">
                <h4 style="font-size:14px;text-align:center;margin-bottom:15px">Unlock Full Access</h4>
                <div style="border:2px solid var(--accent);padding:20px;background:var(--bg-primary);text-align:center">
                    <div style="font-size:11px;color:var(--accent);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Start Training</div>
                    <div style="font-size:36px;font-weight:700">$9.99<span style="font-size:14px;color:var(--text-secondary)">/month</span></div>
                    <ul style="list-style:none;text-align:left;margin:20px 0;font-size:11px">
                        <li style="padding:6px 0">âœ“ Personalized quests from ${selectedForecasts.length || 3}+ forecasts</li>
                        <li style="padding:6px 0">âœ“ AI Coaches for Ideas, Personality & Execution</li>
                        <li style="padding:6px 0">âœ“ Progress tracking & weekly reviews</li>
                        <li style="padding:6px 0">âœ“ Cancel anytime</li>
                    </ul>
                    <a href="${STRIPE_LINK}" class="btn btn-primary btn-full" id="subscribe-btn">Start Monthly â†’</a>
                </div>
                ${STRIPE_ANNUAL?`
                <div style="border:1px solid var(--bg-tertiary);padding:15px;margin-top:15px;text-align:center">
                    <div style="font-size:11px;color:var(--success);margin-bottom:5px">Best Value â€” 2 Months Free</div>
                    <div style="font-size:24px;font-weight:700">$99<span style="font-size:12px;color:var(--text-secondary)">/year</span></div>
                    <a href="${STRIPE_ANNUAL}" class="btn btn-secondary btn-full mt-10">Start Annual â†’</a>
                </div>
                `:''}
            </div>
        </div>
        </div></div>`;
    }
    
    return '';
}

function uploadH(){return `<div class="screen-center"><div class="container-md"><div class="logo">AI PROOF <span>CLUB</span></div>
<h2 class="card-title text-center mb-10">Upload ChatGPT History</h2>
<p class="text-center text-secondary text-small mb-20">This gives us the most accurate read on your modes. Takes 2-3 minutes to analyze.</p>
<div class="card">
    <div class="verdict mb-20">
        <div class="verdict-title">How to Export</div>
        <div class="verdict-text">
            1. <a href="https://chat.openai.com/#settings/DataControls" target="_blank" class="text-link">Click here to open ChatGPT Settings</a><br>
            2. Click "Export data"<br>
            3. Check your email for the download link<br>
            4. Download and <strong>unzip</strong> the file<br>
            5. Upload the <strong>conversations.json</strong> file from inside
        </div>
    </div>
    <div class="upload-zone" id="upload-zone">
        <div style="font-size:32px;margin-bottom:10px">ðŸ“</div>
        <div>Drop <strong>conversations.json</strong> here</div>
        <div class="text-secondary text-small mt-10">Found inside the unzipped folder</div>
        <input type="file" class="file-input" id="file-input" accept=".json">
    </div>
    ${S.uploadedFile?`<div class="uploaded-file"><span>ðŸ“„</span><span>${S.uploadedFile.name}</span><span class="uploaded-remove" id="rm-file">âœ•</span></div>`:''}
</div>
<div class="text-center mt-20">
    <button class="btn btn-primary" id="analyze-btn" ${!S.uploadedFile?'disabled':''}>Analyze â†’</button>
    <p class="mt-20"><a class="text-link" id="skip-upload">Skip for now â†’</a></p>
    <p class="text-secondary text-small mt-10">You can always do this later in Settings</p>
</div></div></div>`;}

function analyzingH(){return `<div class="screen-center"><div class="container-sm text-center"><div class="logo">AI PROOF <span>CLUB</span></div><div class="card"><div class="spinner"></div><p class="text-secondary mt-20">Analyzing patterns...</p></div></div></div>`;}

function quizH(){
    const q=Qs[S.quizStep];
    const isFree = S.freeQuizMode || S.screen === 'freeQuiz';
    return `<div class="screen-center"><div class="container-md">
        <div class="logo">AI PROOF <span>CLUB</span></div>
        ${isFree ? '<p class="text-center text-secondary text-small mb-20">Free Mode Assessment</p>' : ''}
        <div class="progress-bar">${Qs.map((_,i)=>`<div class="progress-dot ${i<S.quizStep?'done':i===S.quizStep?'active':''}"></div>`).join('')}</div>
        <div class="q-number">Question ${S.quizStep+1} of ${Qs.length}</div>
        <div class="q-text">${q.t}</div>
        <div class="options">${q.o.map((o,i)=>`<button class="option" data-idx="${i}">${o.t}</button>`).join('')}</div>
        ${isFree ? `<p class="text-center mt-20"><a class="text-link text-small" id="quit-quiz">â† Back to login</a></p>` : ''}
    </div></div>`;
}

function resultsH(){
    const {ideas:i,personality:p,execution:e}=S.scores;
    const avgScore = Math.round((i+p+e)/3);
    const percentile = getPercentile(avgScore);
    const weak = weakest();
    
    return `<div class="screen-center"><div class="container-md"><div class="logo">AI PROOF <span>CLUB</span></div>
    <div class="card text-center">
        <h2 class="card-title">Your Mode Profile</h2>
        <p class="text-secondary text-small mb-10">Based on your assessment</p>
        
        <div class="results-meters">
            <div class="meter"><div class="meter-circle ideas">${i}%</div><div class="meter-label">Ideas</div></div>
            <div class="meter"><div class="meter-circle personality">${p}%</div><div class="meter-label">Personality</div></div>
            <div class="meter"><div class="meter-circle execution">${e}%</div><div class="meter-label">Execution</div></div>
        </div>
        
        <div class="verdict">
            <div class="verdict-title">Current Position</div>
            <div class="verdict-text">You're in the <strong>${percentile}th percentile</strong>. AI Proof Club operates at 85%+ across all modes.</div>
        </div>
        
        <div class="verdict" style="border-color:var(--${weak})">
            <div class="verdict-title">Training Focus</div>
            <div class="verdict-text">Your <strong style="text-transform:capitalize">${weak}</strong> mode needs the most attention. We'll prioritize quests here.</div>
        </div>
        
        ${S.gptAnalysis?`<div class="verdict"><div class="verdict-title">ChatGPT Insights</div><div class="verdict-text">${S.gptAnalysis.patterns?.join(' Â· ')||'Analysis complete.'}</div></div>`:''}
        
        <div class="form-group mt-20">
            <label class="form-label">Quest Difficulty</label>
            <div class="tabs">
                <button class="tab ${S.diff==='easy'?'active':''}" data-diff="easy">Easy</button>
                <button class="tab ${S.diff==='standard'?'active':''}" data-diff="standard">Standard</button>
                <button class="tab ${S.diff==='hard'?'active':''}" data-diff="hard">Hard</button>
            </div>
            <p class="text-secondary text-small mt-10">Start easy and level up, or dive into hard mode.</p>
        </div>
        
        <button class="btn btn-primary btn-full mt-20" id="start-app">Begin Training â†’</button>
    </div></div></div>`;
}

function appH(c){return `<div class="app-layout"><aside class="sidebar"><div class="sidebar-logo">AI PROOF <span>CLUB</span></div><div class="sidebar-streak"><div class="streak-value">ðŸ”¥ ${streak()}</div><div class="streak-label">Day Streak</div></div><ul class="sidebar-nav"><li><a href="#" data-screen="dashboard" class="${S.screen==='dashboard'?'active':''}">â—‰ Dashboard</a></li><li><a href="#" data-screen="quests" class="${S.screen==='quests'?'active':''}">âš” Quests</a></li><li><a href="#" data-screen="coach" class="${S.screen==='coach'?'active':''}">â—Ž AI Coach</a></li><li><a href="#" data-screen="forecasts" class="${S.screen==='forecasts'?'active':''}">ðŸ”® Forecasts</a></li><li><a href="#" data-screen="receipts" class="${S.screen==='receipts'?'active':''}">â—ˆ Receipts</a></li><li><a href="#" data-screen="capsules" class="${S.screen==='capsules'?'active':''}">ðŸ“¦ Capsules</a></li><li><a href="#" data-screen="review" class="${S.screen==='review'?'active':''}">ðŸ“Š Review</a></li><li><a href="#" data-screen="settings" class="${S.screen==='settings'?'active':''}">âš™ Settings</a></li></ul><div class="sidebar-user"><div class="sidebar-name">${S.user?.name||'User'}</div><div class="sidebar-email">${S.user?.email||''}</div><span class="sidebar-logout" id="logout">Sign out</span></div></aside><main class="main">${c}</main><nav class="mobile-nav"><div class="mobile-nav-item ${S.screen==='dashboard'?'active':''}" data-screen="dashboard"><span>â—‰</span>Home</div><div class="mobile-nav-item ${S.screen==='quests'?'active':''}" data-screen="quests"><span>âš”</span>Quests</div><div class="mobile-nav-item ${S.screen==='coach'?'active':''}" data-screen="coach"><span>â—Ž</span>Coach</div><div class="mobile-nav-item ${S.screen==='forecasts'?'active':''}" data-screen="forecasts"><span>ðŸ”®</span>Forecasts</div><div class="mobile-nav-item ${['receipts','capsules','review','settings'].includes(S.screen)?'active':''}" id="more-menu-toggle"><span>â˜°</span>More</div></nav><div class="more-menu ${S.showMoreMenu?'show':''}" id="more-menu"><div class="more-menu-item" data-screen="receipts"><span>â—ˆ</span> Receipts</div><div class="more-menu-item" data-screen="capsules"><span>ðŸ“¦</span> Capsules</div><div class="more-menu-item" data-screen="review"><span>ðŸ“Š</span> Review</div><div class="more-menu-item" data-screen="settings"><span>âš™</span> Settings</div><div class="more-menu-item" id="mobile-logout"><span>â†©</span> Sign Out</div></div></div>`;}

function dashH(){const active=S.quests.filter(q=>!q.done).slice(0,3),recent=S.receipts.slice(-3).reverse();return `<div class="page-header"><h1 class="page-title">Dashboard</h1><p class="page-subtitle">Day ${dayNum()}</p></div><div class="stats"><div class="stat"><div class="stat-value">${totalXP()}</div><div class="stat-label">XP</div></div><div class="stat"><div class="stat-value">${S.receipts.length}</div><div class="stat-label">Receipts</div></div><div class="stat"><div class="stat-value">${streak()}</div><div class="stat-label">Streak</div></div><div class="stat"><div class="stat-value">${dayNum()}</div><div class="stat-label">Day</div></div></div><div class="grid-2"><div><div class="card"><div class="card-header"><span class="card-header-title">Mode Levels</span></div><div class="mode-bars"><div class="mode-bar"><span class="mode-name ideas">Ideas</span><div class="mode-track"><div class="mode-fill ideas" style="width:${S.scores.ideas}%"></div></div><span class="mode-value">${S.scores.ideas}%</span></div><div class="mode-bar"><span class="mode-name personality">Personality</span><div class="mode-track"><div class="mode-fill personality" style="width:${S.scores.personality}%"></div></div><span class="mode-value">${S.scores.personality}%</span></div><div class="mode-bar"><span class="mode-name execution">Execution</span><div class="mode-track"><div class="mode-fill execution" style="width:${S.scores.execution}%"></div></div><span class="mode-value">${S.scores.execution}%</span></div></div></div><div class="card"><div class="card-header"><span class="card-header-title">Today's Quests</span><a href="#" data-screen="quests" class="text-link">All â†’</a></div>${active.length?active.map(q=>`<div class="quest ${q.boss?'boss':''}"><div class="quest-header"><span class="quest-mode ${q.mode}">${q.mode}</span><span class="quest-diff ${q.diff}">${q.boss?'ðŸ‘‘ BOSS':q.diff}</span></div><div class="quest-title">${q.t}</div><div class="quest-meta"><span class="quest-xp">+${q.xp} XP</span></div><div class="quest-actions"><button class="btn btn-small btn-success complete-q" data-id="${q.id}">âœ“ Done</button></div></div>`).join(''):'<p class="text-secondary text-small">All done!</p>'}</div></div><div><div class="card"><div class="card-header"><span class="card-header-title">Recent Receipts</span></div>${recent.length?recent.map(r=>`<div class="receipt"><div class="receipt-check">âœ“</div><div class="receipt-content"><div class="receipt-title">${r.title}</div><div class="receipt-meta">${r.mode} Â· +${r.xp} XP</div></div></div>`).join(''):'<p class="text-secondary text-small">Complete quests to earn receipts.</p>'}</div></div></div>`;}

function questsH(){
    const active=S.quests.filter(q=>!q.done && !S.hiddenQuests.includes(q.id));
    const custom=S.customQuests.filter(q=>!q.done);
    const forecastQuests=getFollowedForecastQuests();
    const done=[...S.quests.filter(q=>q.done), ...S.customQuests.filter(q=>q.done)];
    const diffLabel=d=>{const l={easy:'Easy',standard:'Standard',hard:'Hard',anon:'Anon OK',boss:'Boss',forecast:'Forecast'};return l[d]||d;};
    
    return `<div class="page-header"><h1 class="page-title">IRL Quests</h1><p class="page-subtitle">Focus: ${weakest()} mode</p></div>
    <div class="flex gap-10 mb-20 flex-wrap">
        <button class="btn btn-small ${S.diff==='easy'?'btn-primary':'btn-secondary'}" data-setdiff="easy">Easy</button>
        <button class="btn btn-small ${S.diff==='standard'?'btn-primary':'btn-secondary'}" data-setdiff="standard">Standard</button>
        <button class="btn btn-small ${S.diff==='hard'?'btn-primary':'btn-secondary'}" data-setdiff="hard">Hard</button>
        <button class="btn btn-small btn-secondary" id="refresh-q">â†» Refresh</button>
        <button class="btn btn-small btn-secondary" id="add-custom-quest">+ Add Quest</button>
    </div>
    
    ${forecastQuests.length?`<div class="card mb-20">
        <div class="card-header"><span class="card-header-title">ðŸ”® From Your Forecasts</span><span class="card-badge">${forecastQuests.length}</span></div>
        <p class="text-secondary text-small mb-10" style="padding:0 15px">Building toward opportunities you're tracking</p>
        ${forecastQuests.map(q=>`<div class="quest forecast-quest">
            <div class="quest-header"><span class="quest-mode ${q.mode}">${q.mode}</span><span class="quest-diff forecast">ðŸ”® ${q.forecastTitle?.substring(0,30)}...</span></div>
            <div class="quest-title">${q.t}</div>
            <div class="quest-meta"><span class="quest-xp">+${q.xp} XP</span><span class="quest-progress">Step ${q.step}/${q.totalSteps}</span></div>
            <div class="quest-actions">
                <button class="btn btn-small btn-success complete-forecast-q" data-fid="${q.forecastId}" data-oid="${q.oppId}">âœ“ Complete</button>
            </div>
        </div>`).join('')}
    </div>`:''}
    
    ${custom.length?`<div class="card mb-20">
        <div class="card-header"><span class="card-header-title">ðŸ“ Your Quests</span><span class="card-badge">${custom.length}</span></div>
        ${custom.map(q=>`<div class="quest custom-quest">
            <div class="quest-header"><span class="quest-mode ${q.mode}">${q.mode}</span><span class="quest-diff">Custom</span></div>
            <div class="quest-title">${q.t}</div>
            <div class="quest-meta"><span class="quest-xp">+${q.xp} XP</span></div>
            <div class="quest-actions">
                <button class="btn btn-small btn-success complete-custom-q" data-id="${q.id}">âœ“ Complete</button>
                <button class="btn btn-small btn-secondary delete-custom-q" data-id="${q.id}">âœ•</button>
            </div>
        </div>`).join('')}
    </div>`:''}
    
    <div class="card mb-20">
        <div class="card-header"><span class="card-header-title">Active</span><span class="card-badge">${active.length}</span></div>
        ${active.length?active.map(q=>`<div class="quest ${q.boss?'boss':''}">
            <div class="quest-header">
                <span class="quest-mode ${q.mode}">${q.mode}</span>
                <span class="quest-diff ${q.diff}">${q.boss?'ðŸ‘‘ BOSS':diffLabel(q.diff)}</span>
            </div>
            <div class="quest-title">${q.t}</div>
            <div class="quest-meta"><span class="quest-xp">+${q.xp} XP</span>${q.diff==='anon'?'<span>ðŸ”’ Anon OK</span>':''}</div>
            ${q.tip?`<div class="quest-tip">ðŸ’¡ ${q.tip}</div>`:''}
            <div class="quest-actions">
                <button class="btn btn-small btn-success complete-q" data-id="${q.id}">âœ“ Complete</button>
                <button class="btn btn-small btn-secondary skip-q" data-id="${q.id}">Skip</button>
                <button class="btn btn-small btn-ghost hide-q" data-id="${q.id}" title="Hide this quest">âœ•</button>
            </div>
        </div>`).join(''):'<p class="text-secondary text-small">All done! Refresh for more.</p>'}
    </div>
    
    ${S.hiddenQuests.length?`<p class="text-secondary text-small mb-20">${S.hiddenQuests.length} hidden quest(s). <a class="text-link" id="unhide-all">Show all</a></p>`:''}
    
    ${done.length?`<div class="card"><div class="card-header"><span class="card-header-title">Completed</span></div>${done.slice(-5).map(q=>`<div class="quest done"><div class="quest-title">${q.t}</div><div class="quest-meta">âœ“ +${q.xp} XP</div></div>`).join('')}</div>`:''}`;}

// Get quests from followed forecasts
function getFollowedForecastQuests() {
    const quests = [];
    S.followedForecasts.forEach(fId => {
        const forecast = FORECAST_DATABASE.find(f => f.id === fId);
        if (!forecast) return;
        
        // Get first opportunity with incomplete quests
        forecast.opportunities.forEach((opp, oppIndex) => {
            const progress = S.forecastProgress[fId]?.[oppIndex] || 0;
            if (progress < opp.quests.length) {
                const quest = opp.quests[progress];
                quests.push({
                    ...quest,
                    t: quest.task,
                    forecastId: fId,
                    oppId: oppIndex,
                    forecastTitle: forecast.title,
                    oppTitle: opp.title,
                    step: progress + 1,
                    totalSteps: opp.quests.length,
                    id: `${fId}-${oppIndex}-${progress}`
                });
            }
        });
    });
    return quests.slice(0, 3); // Max 3 forecast quests at a time
}
function coachH(){
    const mode = S.coachMode;
    const modeChats = S.chat.filter(m => m.mode === mode);
    const coachDesc = {
        ideas: "Strategic thinking, decision-making, analysis",
        personality: "Communication, influence, social calibration", 
        execution: "Action-taking, follow-through, shipping"
    };
    const msgs = modeChats.length ? modeChats.map(m=>`<div class="chat-msg ${m.u?'user':'ai'}"><div class="chat-avatar">${m.u?(S.user?.name?.[0]||'U'):'AI'}</div><div class="chat-bubble">${m.t}</div></div>`).join('') : `<div class="chat-msg ai"><div class="chat-avatar">AI</div><div class="chat-bubble">I'm your ${mode} coach. Tell me a situation and I'll give you tactical advice on ${coachDesc[mode].toLowerCase()}.</div></div>`;
    return `<div class="page-header"><h1 class="page-title">AI Coaches</h1><p class="page-subtitle">Tactical advice for each mode</p></div><div class="tabs mb-20"><button class="tab ${mode==='ideas'?'active':''}" data-coach="ideas">ðŸ’¡ Ideas</button><button class="tab ${mode==='personality'?'active':''}" data-coach="personality">ðŸŽ­ Personality</button><button class="tab ${mode==='execution'?'active':''}" data-coach="execution">âš¡ Execution</button></div><div class="card mb-10" style="padding:12px"><span class="text-small text-secondary">${coachDesc[mode]}</span></div><div class="chat-container"><div class="chat-messages" id="chat-msgs">${msgs}${S.loading?'<div class="chat-msg ai"><div class="chat-avatar">AI</div><div class="chat-bubble"><div class="spinner"></div></div></div>':''}</div><div class="chat-input-row"><textarea class="chat-input" id="chat-input" placeholder="Describe a situation..." rows="2"></textarea><button class="chat-send" id="send-msg">Send</button></div></div>`;
}

function receiptsH(){const by={ideas:S.receipts.filter(r=>r.mode==='ideas'),personality:S.receipts.filter(r=>r.mode==='personality'),execution:S.receipts.filter(r=>r.mode==='execution')};return `<div class="page-header"><h1 class="page-title">Receipts</h1><p class="page-subtitle">Proof of action</p></div><div class="stats" style="grid-template-columns:repeat(3,1fr)"><div class="stat"><div class="stat-value" style="color:var(--ideas)">${by.ideas.length}</div><div class="stat-label">Ideas</div></div><div class="stat"><div class="stat-value" style="color:var(--personality)">${by.personality.length}</div><div class="stat-label">Personality</div></div><div class="stat"><div class="stat-value" style="color:var(--execution)">${by.execution.length}</div><div class="stat-label">Execution</div></div></div><div class="card"><div class="card-header"><span class="card-header-title">All Receipts</span><span class="card-badge">${totalXP()} XP</span></div>${S.receipts.length?[...S.receipts].reverse().map(r=>`<div class="receipt"><div class="receipt-check">âœ“</div><div class="receipt-content"><div class="receipt-title">${r.title}</div><div class="receipt-meta">${new Date(r.ts).toLocaleDateString()} Â· ${r.mode} Â· +${r.xp} XP</div>${r.reflection?`<div class="receipt-reflection">"${r.reflection}"</div>`:''}</div></div>`).join(''):'<p class="text-secondary" style="padding:15px 0">Receipts appear here as you complete quests.</p>'}</div>`;}

function capsulesH(){const caps=capsules(),base=S.user?.baseline_scores||S.scores;return `<div class="page-header"><h1 class="page-title">Progress Capsules</h1><p class="page-subtitle">Locked snapshots of growth</p></div><div class="capsule-grid">${caps.map(c=>`<div class="capsule ${c.unlocked?'unlocked':'locked'}"><div class="capsule-day">${c.label}</div><div class="capsule-icon">${c.unlocked?'ðŸ“¦':'ðŸ”’'}</div><div class="capsule-status ${c.unlocked?'unlocked':'locked'}">${c.unlocked?'Unlocked':`${c.day-dayNum()}d left`}</div></div>`).join('')}</div><div class="grid-2"><div class="card"><div class="card-header"><span class="card-header-title">Day 1 Baseline</span></div><div class="mode-bars"><div class="mode-bar"><span class="mode-name ideas">Ideas</span><div class="mode-track"><div class="mode-fill ideas" style="width:${base.ideas}%"></div></div><span class="mode-value">${base.ideas}%</span></div><div class="mode-bar"><span class="mode-name personality">Personality</span><div class="mode-track"><div class="mode-fill personality" style="width:${base.personality}%"></div></div><span class="mode-value">${base.personality}%</span></div><div class="mode-bar"><span class="mode-name execution">Execution</span><div class="mode-track"><div class="mode-fill execution" style="width:${base.execution}%"></div></div><span class="mode-value">${base.execution}%</span></div></div></div><div class="card"><div class="card-header"><span class="card-header-title">Current</span><span class="card-badge">Day ${dayNum()}</span></div><div class="mode-bars"><div class="mode-bar"><span class="mode-name ideas">Ideas</span><div class="mode-track"><div class="mode-fill ideas" style="width:${S.scores.ideas}%"></div></div><span class="mode-value">${S.scores.ideas}%</span></div><div class="mode-bar"><span class="mode-name personality">Personality</span><div class="mode-track"><div class="mode-fill personality" style="width:${S.scores.personality}%"></div></div><span class="mode-value">${S.scores.personality}%</span></div><div class="mode-bar"><span class="mode-name execution">Execution</span><div class="mode-track"><div class="mode-fill execution" style="width:${S.scores.execution}%"></div></div><span class="mode-value">${S.scores.execution}%</span></div></div></div></div>`;}

function reviewH(){const week=S.receipts.filter(r=>(Date.now()-new Date(r.ts))<7*86400000);return `<div class="page-header"><h1 class="page-title">Weekly Review</h1><p class="page-subtitle">AI analysis of your progress</p></div><div class="card mb-20"><div class="card-header"><span class="card-header-title">This Week</span></div><div class="stats" style="grid-template-columns:repeat(3,1fr);margin:0"><div class="stat"><div class="stat-value">${week.length}</div><div class="stat-label">Quests</div></div><div class="stat"><div class="stat-value">${week.reduce((s,r)=>s+r.xp,0)}</div><div class="stat-label">XP</div></div><div class="stat"><div class="stat-value">${streak()}</div><div class="stat-label">Streak</div></div></div></div><div class="card"><div class="card-header"><span class="card-header-title">AI Analysis</span><button class="btn btn-small btn-secondary" id="gen-review">Generate</button></div><div id="review-out">${S.weeklyReview?`<div style="font-size:13px;line-height:1.6">${S.weeklyReview.replace(/\n/g,'<br>')}</div>`:`<p class="text-secondary text-small">${week.length<3?'Complete 3+ quests this week to generate.':'Click Generate for AI review.'}</p>`}</div></div>`;}

function settingsH(){return `<div class="page-header"><h1 class="page-title">Settings</h1></div>
<div class="card mb-20"><div class="card-header"><span class="card-header-title">Account</span></div>
<p class="text-small mb-10"><strong>Name:</strong> ${S.user?.name}</p>
<p class="text-small mb-10"><strong>Email:</strong> ${S.user?.email}</p>
<p class="text-small mb-10"><strong>Plan:</strong> Monthly</p>
<p class="text-small"><strong>Day:</strong> ${dayNum()}</p>
</div>

<div class="card mb-20"><div class="card-header"><span class="card-header-title">Re-assess Modes</span></div>
<p class="text-secondary text-small mb-10">Upload new ChatGPT data or retake the quiz to update your mode profile.</p>
<div class="flex gap-10"><button class="btn btn-small btn-secondary" id="re-upload">Upload ChatGPT</button><button class="btn btn-small btn-secondary" id="re-quiz">Retake Quiz</button></div>
</div>

<div class="card mb-20"><div class="card-header"><span class="card-header-title">Support & Feedback</span></div>
<p class="text-secondary text-small mb-15">Questions, ideas, or issues? We'd love to hear from you.</p>
<form id="support-form">
<div class="form-group"><label class="form-label">Subject</label>
<select class="form-input" id="support-subject" required>
<option value="">Select a topic...</option>
<option value="Question">General Question</option>
<option value="Bug Report">Bug Report</option>
<option value="Feature Request">Feature Request / Idea</option>
<option value="Billing">Billing Issue</option>
<option value="Other">Other</option>
</select></div>
<div class="form-group"><label class="form-label">Message</label><textarea class="form-textarea" id="support-message" rows="4" placeholder="Tell us what's on your mind..." required></textarea></div>
<button type="submit" class="btn btn-small btn-primary">Send Message</button>
</form>
</div>

<div class="card mb-20"><div class="card-header"><span class="card-header-title">Subscription</span></div>
<p class="text-secondary text-small mb-15">Manage billing or cancel anytime.</p>
<a href="https://billing.stripe.com/p/login/3cIeVd98He9l4NC1Ym9ws00" target="_blank" class="btn btn-small btn-secondary">Manage Subscription</a>
</div>

<div class="card"><div class="card-header"><span class="card-header-title">Security</span></div>
<p class="text-secondary text-small mb-10"><a class="text-link" id="toggle-password-form">Change password â†’</a></p>
<div id="password-form-container" style="display:none">
<form id="change-password-form">
<div class="form-group"><label class="form-label">Current Password</label><input type="password" class="form-input" id="current-pass" required></div>
<div class="form-group"><label class="form-label">New Password</label><input type="password" class="form-input" id="new-pass" required minlength="6"></div>
<div class="form-group"><label class="form-label">Confirm New Password</label><input type="password" class="form-input" id="confirm-pass" required></div>
<button type="submit" class="btn btn-small btn-primary">Update Password</button>
</form>
</div>
</div>`;}


function modalH(){
    if(S.modal==='forecastDetail') return forecastDetailModalH();
    if(S.modal==='complete'){
        const q=S.selectedQuest;
        return `<div class="modal-overlay" id="modal-bg"><div class="modal"><h3 class="modal-title">Quest Complete! ðŸŽ¯</h3><p class="text-secondary text-small mb-20">${q.t}</p><div class="form-group"><label class="form-label">Reflection (optional)</label><textarea class="form-textarea" id="reflection" placeholder="What happened? What did you learn?"></textarea></div><div class="flex gap-10"><button class="btn btn-primary btn-full" id="confirm-done">Log Receipt (+${q.xp} XP)</button><button class="btn btn-secondary" id="cancel-modal">Cancel</button></div></div></div>`;
    }
    if(S.modal==='resetPassword'){
        return `<div class="modal-overlay" id="modal-bg"><div class="modal"><h3 class="modal-title">Set New Password</h3><p class="text-secondary text-small mb-20">Enter your new password below.</p>
        <form id="reset-password-form">
        <div class="form-group"><label class="form-label">New Password</label><input type="password" class="form-input" id="reset-new-pass" required minlength="6"></div>
        <div class="form-group"><label class="form-label">Confirm Password</label><input type="password" class="form-input" id="reset-confirm-pass" required></div>
        <button type="submit" class="btn btn-primary btn-full">Reset Password</button>
        </form></div></div>`;
    }
    if(S.modal==='addQuest'){
        return `<div class="modal-overlay" id="modal-bg"><div class="modal">
        <h3 class="modal-title">Add Custom Quest</h3>
        <p class="text-secondary text-small mb-20">Create a quest tailored to your goals.</p>
        <form id="custom-quest-form">
        <div class="form-group"><label class="form-label">Quest</label><input type="text" class="form-input" id="custom-quest-text" placeholder="What will you do?" required></div>
        <div class="form-group"><label class="form-label">Mode</label>
        <select class="form-input" id="custom-quest-mode" required>
            <option value="ideas">Ideas</option>
            <option value="personality">Personality</option>
            <option value="execution">Execution</option>
        </select></div>
        <div class="form-group"><label class="form-label">XP (10-100)</label><input type="number" class="form-input" id="custom-quest-xp" value="40" min="10" max="100" required></div>
        <div class="flex gap-10"><button type="submit" class="btn btn-primary btn-full">Add Quest</button><button type="button" class="btn btn-secondary" id="cancel-modal">Cancel</button></div>
        </form></div></div>`;
    }
    return '';
}

function bindEvents(){
    // Auth forms
    document.getElementById('login-form')?.addEventListener('submit',e=>{e.preventDefault();login();});
    document.getElementById('signup-form')?.addEventListener('submit',e=>{e.preventDefault();signup();});
    document.getElementById('forgot-form')?.addEventListener('submit',e=>{e.preventDefault();resetPassword();});
    document.getElementById('reset-password-form')?.addEventListener('submit',e=>{e.preventDefault();completePasswordReset();});
    
    // Navigation
    document.getElementById('to-signup')?.addEventListener('click',()=>{S.onboardStep=1;S.screen='onboarding';render();});
    document.getElementById('to-login')?.addEventListener('click',()=>{S.screen='login';S.freeQuizMode=false;render();});
    document.getElementById('forgot-pass')?.addEventListener('click',()=>{S.screen='forgot';render();});
    document.getElementById('back-login')?.addEventListener('click',()=>{S.screen='login';S.freeQuizMode=false;render();});
    
    // Free quiz flow
    document.getElementById('take-free-quiz')?.addEventListener('click',()=>{
        S.freeQuizMode=true;
        S.quizStep=0;
        S.quizAnswers=[];
        S.screen='freeQuiz';
        render();
    });
    document.getElementById('quit-quiz')?.addEventListener('click',()=>{
        S.freeQuizMode=false;
        S.screen='login';
        render();
    });
    document.getElementById('free-to-signup')?.addEventListener('click',()=>{
        S.onboardStep=1;
        S.screen='onboarding';
        render();
    });
    
    // Onboarding flow
    document.getElementById('onboard-account-form')?.addEventListener('submit',e=>{
        e.preventDefault();
        handleOnboardAccount();
    });
    document.getElementById('onboard-occupation-form')?.addEventListener('submit',e=>{
        e.preventDefault();
        handleOnboardOccupation();
    });
    
    // Goals selection
    document.querySelectorAll('.goal-option').forEach(g=>g.addEventListener('click',()=>{
        const goalId = g.dataset.goal;
        if(S.onboardData.goals.includes(goalId)){
            S.onboardData.goals = S.onboardData.goals.filter(id=>id!==goalId);
        } else {
            S.onboardData.goals.push(goalId);
        }
        render();
    }));
    document.getElementById('goals-continue')?.addEventListener('click',()=>{
        if(S.onboardData.goals.length > 0){
            S.onboardStep=4;
            render();
        }
    });
    
    // Interests selection
    document.querySelectorAll('.interest-option').forEach(i=>i.addEventListener('click',()=>{
        const interestId = i.dataset.interest;
        if(S.onboardData.forecastInterests.includes(interestId)){
            S.onboardData.forecastInterests = S.onboardData.forecastInterests.filter(id=>id!==interestId);
        } else {
            S.onboardData.forecastInterests.push(interestId);
        }
        render();
    }));
    document.getElementById('interests-continue')?.addEventListener('click',()=>{
        if(S.onboardData.forecastInterests.length > 0){
            S.onboardStep=5; // Go to assessment
            render();
        }
    });
    
    // Start Assessment (step 5)
    document.getElementById('start-assessment')?.addEventListener('click',()=>{
        S.quizStep=0;
        S.quizAnswers=[];
        S.screen='quiz';
        render();
    });
    
    // Suggested forecasts selection (step 6)
    document.querySelectorAll('.suggested-forecast').forEach(f=>f.addEventListener('click',()=>{
        const fid = f.dataset.fid;
        if(!S.onboardSelectedForecasts) S.onboardSelectedForecasts = [];
        if(S.onboardSelectedForecasts.includes(fid)){
            S.onboardSelectedForecasts = S.onboardSelectedForecasts.filter(id=>id!==fid);
        } else {
            S.onboardSelectedForecasts.push(fid);
        }
        render();
    }));
    document.getElementById('forecasts-continue')?.addEventListener('click',()=>{
        S.onboardStep=7; // Go to email/paywall
        render();
    });
    
    // Email signup + Paywall (step 7)
    document.getElementById('subscribe-btn')?.addEventListener('click',()=>{
        // Save email preference before redirecting to Stripe
        const email = document.getElementById('weekly-email')?.value;
        const optIn = document.getElementById('email-optin')?.checked;
        if(email && optIn) {
            // Store for later use after payment
            S.weeklyEmailOptIn = {email, optedIn: optIn};
            save();
        }
    });
    
    // Upload (keeping for settings, but not in onboarding)
    const zone=document.getElementById('upload-zone'),inp=document.getElementById('file-input');
    zone?.addEventListener('click',()=>inp?.click());
    inp?.addEventListener('change',e=>handleFile(e.target.files[0]));
    document.getElementById('rm-file')?.addEventListener('click',()=>{S.uploadedFile=null;render();});
    document.getElementById('analyze-btn')?.addEventListener('click',analyzeFile);
    document.getElementById('skip-upload')?.addEventListener('click',()=>{
        // If we have free quiz scores, use those
        if(S.freeQuizScores) S.scores = {...S.freeQuizScores};
        S.screen='results';
        render();
    });
    
    // Quiz
    document.querySelectorAll('.option').forEach(o=>o.addEventListener('click',()=>answerQuiz(+o.dataset.idx)));
    document.querySelectorAll('[data-diff]').forEach(b=>b.addEventListener('click',()=>{S.diff=b.dataset.diff;render();}));
    document.getElementById('start-app')?.addEventListener('click',startApp);
    
    // App navigation
    document.querySelectorAll('[data-screen]').forEach(a=>a.addEventListener('click',e=>{e.preventDefault();S.showMoreMenu=false;S.screen=a.dataset.screen;render();}));
    document.getElementById('logout')?.addEventListener('click',logout);
    document.getElementById('mobile-logout')?.addEventListener('click',logout);
    
    // More menu toggle
    document.getElementById('more-menu-toggle')?.addEventListener('click',e=>{e.stopPropagation();S.showMoreMenu=!S.showMoreMenu;render();});
    document.addEventListener('click',e=>{if(S.showMoreMenu && !e.target.closest('.more-menu') && !e.target.closest('#more-menu-toggle')){S.showMoreMenu=false;render();}});
    
    // Quests
    document.querySelectorAll('.complete-q').forEach(b=>b.addEventListener('click',()=>openModal(b.dataset.id)));
    document.querySelectorAll('.skip-q').forEach(b=>b.addEventListener('click',()=>skipQuest(b.dataset.id)));
    document.querySelectorAll('[data-setdiff]').forEach(b=>b.addEventListener('click',()=>{S.diff=b.dataset.setdiff;S.quests=genQuests();save();render();}));
    document.getElementById('refresh-q')?.addEventListener('click',()=>{S.quests=genQuests();save();render();});
    
    // Custom quests
    document.getElementById('add-custom-quest')?.addEventListener('click',()=>{S.modal='addQuest';render();});
    document.getElementById('custom-quest-form')?.addEventListener('submit',e=>{e.preventDefault();addCustomQuest();});
    document.querySelectorAll('.complete-custom-q').forEach(b=>b.addEventListener('click',()=>completeCustomQuest(b.dataset.id)));
    document.querySelectorAll('.delete-custom-q').forEach(b=>b.addEventListener('click',()=>deleteCustomQuest(b.dataset.id)));
    
    // Hide quests
    document.querySelectorAll('.hide-q').forEach(b=>b.addEventListener('click',()=>hideQuest(b.dataset.id)));
    document.getElementById('unhide-all')?.addEventListener('click',()=>{S.hiddenQuests=[];save();render();});
    
    // Forecast quests
    document.querySelectorAll('.complete-forecast-q').forEach(b=>b.addEventListener('click',()=>completeForecastQuest(b.dataset.fid, b.dataset.oid)));
    document.querySelectorAll('.follow-forecast').forEach(b=>b.addEventListener('click',()=>toggleFollowForecast(b.dataset.id)));
    
    // Modal
    document.getElementById('modal-bg')?.addEventListener('click',e=>{if(e.target.id==='modal-bg')closeModal();});
    document.getElementById('cancel-modal')?.addEventListener('click',closeModal);
    document.getElementById('confirm-done')?.addEventListener('click',confirmDone);
    
    // Chat
    document.getElementById('send-msg')?.addEventListener('click',sendChat);
    document.getElementById('chat-input')?.addEventListener('keypress',e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendChat();}});
    document.querySelectorAll('[data-coach]').forEach(b=>b.addEventListener('click',()=>{S.coachMode=b.dataset.coach;render();}));
    
    // Review
    document.getElementById('gen-review')?.addEventListener('click',genReview);
    
    // Settings
    document.getElementById('re-upload')?.addEventListener('click',()=>{S.screen='upload';render();});
    document.getElementById('re-quiz')?.addEventListener('click',()=>{S.quizStep=0;S.quizAnswers=[];S.screen='quiz';render();});
    document.getElementById('support-form')?.addEventListener('submit',e=>{e.preventDefault();submitSupport();});
    document.getElementById('change-password-form')?.addEventListener('submit',e=>{e.preventDefault();changePassword();});
    document.getElementById('toggle-password-form')?.addEventListener('click',e=>{
        e.preventDefault();
        const container = document.getElementById('password-form-container');
        if(container) container.style.display = container.style.display === 'none' ? 'block' : 'none';
    });
    
    // Forecasts
    document.querySelectorAll('[data-filter]').forEach(b=>b.addEventListener('click',()=>{S.forecastFilter=b.dataset.filter;render();}));
    document.querySelectorAll('.view-forecast-detail').forEach(b=>b.addEventListener('click',()=>{
        S.selectedForecast = FORECAST_DATABASE.find(f => f.id === b.dataset.id);
        S.modal = 'forecastDetail';
        render();
    }));
    document.getElementById('close-forecast-modal')?.addEventListener('click',()=>{S.modal=null;S.selectedForecast=null;render();});
    document.querySelectorAll('.add-quest-path').forEach(b=>b.addEventListener('click',()=>{
        addQuestPathToQueue(b.dataset.forecast, parseInt(b.dataset.opp));
    }));
}

// Custom Quest Functions
function addCustomQuest(){
    const text = document.getElementById('custom-quest-text').value.trim();
    const mode = document.getElementById('custom-quest-mode').value;
    const xp = parseInt(document.getElementById('custom-quest-xp').value) || 40;
    
    if(!text) return;
    
    S.customQuests.push({
        id: 'custom-' + Date.now(),
        t: text,
        mode: mode,
        xp: Math.min(100, Math.max(10, xp)),
        done: false,
        ts: Date.now()
    });
    S.modal = null;
    save();
    render();
}

function completeCustomQuest(id){
    const q = S.customQuests.find(q=>q.id===id);
    if(!q) return;
    
    q.done = true;
    S.receipts.push({
        title: q.t,
        mode: q.mode,
        xp: q.xp,
        ts: Date.now(),
        reflection: 'Custom quest completed'
    });
    updateScores(q.mode, q.xp);
    save();
    render();
}

function deleteCustomQuest(id){
    S.customQuests = S.customQuests.filter(q=>q.id!==id);
    save();
    render();
}

function hideQuest(id){
    if(!S.hiddenQuests.includes(id)){
        S.hiddenQuests.push(id);
        save();
        render();
    }
}

// Forecast Quest Functions
function toggleFollowForecast(forecastId){
    const idx = S.followedForecasts.indexOf(forecastId);
    if(idx === -1){
        S.followedForecasts.push(forecastId);
        if(!S.forecastProgress[forecastId]) S.forecastProgress[forecastId] = {};
    } else {
        S.followedForecasts.splice(idx, 1);
    }
    save();
    render();
}

function completeForecastQuest(forecastId, oppIndex){
    const forecast = FORECAST_DATABASE.find(f => f.id === forecastId);
    if(!forecast) return;
    
    const opp = forecast.opportunities[oppIndex];
    if(!opp) return;
    
    // Initialize progress if needed
    if(!S.forecastProgress[forecastId]) S.forecastProgress[forecastId] = {};
    const currentStep = S.forecastProgress[forecastId][oppIndex] || 0;
    
    if(currentStep < opp.quests.length){
        const quest = opp.quests[currentStep];
        
        // Add receipt
        S.receipts.push({
            title: quest.task,
            mode: quest.mode,
            xp: quest.xp,
            ts: Date.now(),
            reflection: `Forecast: ${forecast.title.substring(0,50)}...`,
            forecastId: forecastId,
            oppIndex: oppIndex
        });
        
        // Update scores
        updateScores(quest.mode, quest.xp);
        
        // Advance progress
        S.forecastProgress[forecastId][oppIndex] = currentStep + 1;
    }
    
    save();
    render();
}

// Onboarding handlers
async function handleOnboardAccount(){
    const name = document.getElementById('ob-name').value;
    const email = document.getElementById('ob-email').value;
    const pass = document.getElementById('ob-pass').value;
    
    // Check if email exists
    const ex = await db('users','GET',null,`?email=eq.${encodeURIComponent(email)}`);
    if(ex?.length){alert('Email already exists. Please sign in.');return;}
    
    S.user = {name, email, password: pass, start_date: new Date().toISOString(), onboarded: false};
    localStorage.setItem('apc_pending', JSON.stringify(S.user));
    S.onboardStep = 2;
    render();
}

function handleOnboardOccupation(){
    S.onboardData.occupation = document.getElementById('ob-occupation').value;
    S.onboardData.industry = document.getElementById('ob-industry').value;
    S.onboardData.experience = document.getElementById('ob-experience').value;
    S.onboardStep = 3;
    render();
}

async function login(){
    const email=document.getElementById('email').value,pass=document.getElementById('pass').value;
    const users=await db('users','GET',null,`?email=eq.${encodeURIComponent(email)}`);
    if(users?.length&&users[0].password===pass){
        S.user=users[0];S.scores=users[0].scores||{ideas:50,personality:50,execution:50};
        S.receipts=users[0].receipts||[];S.quests=users[0].quests?.length?users[0].quests:genQuests();S.diff=users[0].diff||'standard';
        localStorage.setItem('apc_session',JSON.stringify(S.user));
        S.screen=S.user.onboarded?'dashboard':'onboarding';render();
    } else alert('Invalid credentials');
}

async function signup(){
    const name=document.getElementById('name').value,email=document.getElementById('email').value,pass=document.getElementById('pass').value;
    const ex=await db('users','GET',null,`?email=eq.${encodeURIComponent(email)}`);
    if(ex?.length){alert('Email exists');return;}
    S.user={name,email,password:pass,start_date:new Date().toISOString(),onboarded:false};
    localStorage.setItem('apc_pending',JSON.stringify(S.user));
    S.screen='pricing';render();
}

function handleFile(f){if(f?.name.endsWith('.json')){S.uploadedFile=f;render();}else alert('Upload .json file');}

async function analyzeFile(){
    S.screen='analyzing';render();
    try{
        const txt=await S.uploadedFile.text();
        const res=await ai([{role:'user',content:txt.substring(0,20000)}],600,'analyze');
        const data=JSON.parse(res);
        if(data?.ideas !== undefined){
            // Apply skewing to GPT scores too
            const skewed = skewScores({ideas:data.ideas,personality:data.personality,execution:data.execution});
            S.scores = skewed;
            S.gptAnalysis = {scores: skewed, summary: data.summary};
        }
    }catch(e){console.error(e);}
    S.screen='results';render();
}

function answerQuiz(i){
    S.quizAnswers.push(Qs[S.quizStep].o[i]);
    if(S.quizStep<Qs.length-1){
        S.quizStep++;
        render();
    } else {
        // Calculate raw scores
        const raw = {ideas:50, personality:50, execution:50};
        S.quizAnswers.forEach(a => {
            raw[a.m] = Math.min(100, Math.max(0, raw[a.m] + a.w * 5)); // Adjusted multiplier for 15 questions
        });
        
        // Apply GPT analysis if available
        if(S.gptAnalysis?.scores){
            raw.ideas = Math.round((raw.ideas + S.gptAnalysis.scores.ideas) / 2);
            raw.personality = Math.round((raw.personality + S.gptAnalysis.scores.personality) / 2);
            raw.execution = Math.round((raw.execution + S.gptAnalysis.scores.execution) / 2);
        }
        
        // Apply score skewing (lower the weakest score)
        const skewed = skewScores(raw);
        
        // Handle free quiz vs onboarding quiz
        if(S.freeQuizMode || S.screen === 'freeQuiz') {
            S.freeQuizScores = skewed;
            S.freeQuizMode = false;
            S.screen = 'freeResults';
        } else {
            S.scores = skewed;
            // Go to onboarding step 6 (results + suggested forecasts)
            S.onboardStep = 6;
            S.screen = 'onboarding';
        }
        render();
    }
}

async function startApp(){
    // Include onboarding data in user object
    S.user.onboarded = true;
    S.user.baseline_scores = {...S.scores};
    S.user.scores = S.scores;
    S.user.diff = S.diff;
    S.user.occupation = S.onboardData.occupation;
    S.user.industry = S.onboardData.industry;
    S.user.experience = S.onboardData.experience;
    S.user.goals = S.onboardData.goals;
    S.user.forecast_interests = S.onboardData.forecastInterests;
    
    S.quests = genQuests();
    const res = await db('users','POST',S.user);
    if(res?.length){
        S.user = res[0];
        localStorage.setItem('apc_session',JSON.stringify(S.user));
        localStorage.removeItem('apc_pending');
        // Send welcome email (don't await - fire and forget)
        sendWelcomeEmail(S.user.name, S.user.email);
    }
    S.screen = 'dashboard';
    render();
}

function openModal(id){S.selectedQuest=S.quests.find(q=>q.id==id);S.modal='complete';render();}
function closeModal(){S.modal=null;S.selectedQuest=null;render();}

async function confirmDone(){
    const q=S.selectedQuest,ref=document.getElementById('reflection')?.value||'';
    q.done=true;
    S.receipts.push({id:Date.now(),title:q.t,mode:q.mode,xp:q.xp,reflection:ref,ts:new Date().toISOString()});
    S.scores[q.mode]=Math.min(100,S.scores[q.mode]+Math.floor(q.xp/20));
    updateStreakData(); // Track streak locally
    closeModal();await save();render();
}

function skipQuest(id){S.quests=S.quests.filter(q=>q.id!=id);save();render();}

async function sendChat(){
    const inp=document.getElementById('chat-input'),msg=inp.value.trim();if(!msg)return;
    const mode = S.coachMode;
    S.chat.push({t:msg,u:true,mode:mode});inp.value='';S.loading=true;render();
    
    const modeChats = S.chat.filter(m => m.mode === mode);
    const coachType = 'coach-' + mode;
    const reply=await ai(modeChats.map(m=>({role:m.u?'user':'assistant',content:m.t})),500,coachType);
    S.chat.push({t:reply||'Error. Try again.',u:false,mode:mode});S.loading=false;render();
    document.getElementById('chat-msgs')?.scrollTo(0,999999);
}

async function genReview(){
    S.loading=true;render();
    const week=S.receipts.filter(r=>(Date.now()-new Date(r.ts))<7*86400000);
    if(week.length<3){S.loading=false;render();return;}
    const sum=week.map(r=>`- ${r.title} (${r.mode}) ${r.reflection||''}`).join('\n');
    S.weeklyReview=await ai([{role:'user',content:`This week:\n${sum}`}],400,'review');
    S.loading=false;render();
}

function logout(){S.user=null;S.screen='login';S.scores={ideas:50,personality:50,execution:50};S.quests=[];S.receipts=[];S.chat=[];localStorage.removeItem('apc_session');render();}

// ==================== EMAIL SYSTEM ====================
// Note: Requires Resend API key in environment variable RESEND_API_KEY
// Set up at: https://resend.com
// Verify domain: aiproof.club

const EMAIL_API = '/.netlify/functions/send-email';

async function sendEmail(type, data) {
    try {
        const response = await fetch(EMAIL_API, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ type, data })
        });
        return response.ok;
    } catch (e) {
        console.error('Email send failed:', e);
        return false;
    }
}

// Welcome email - sent after successful signup
async function sendWelcomeEmail(name, email) {
    return sendEmail('welcome', { name, email });
}

// Password reset email
async function resetPassword(){
    const email = document.getElementById('reset-email').value;
    const btn = document.querySelector('#forgot-form button');
    btn.textContent = 'Sending...';
    btn.disabled = true;
    
    const users = await db('users','GET',null,`?email=eq.${encodeURIComponent(email)}`);
    
    if(users?.length){
        // Generate reset token
        const resetToken = Math.random().toString(36).substring(2) + Date.now().toString(36);
        const resetExpiry = new Date(Date.now() + 3600000).toISOString(); // 1 hour
        
        // Store token in database
        await db('users','PATCH',{ reset_token: resetToken, reset_expiry: resetExpiry },`?email=eq.${encodeURIComponent(email)}`);
        
        // Send email
        await sendEmail('password-reset', { 
            name: users[0].name, 
            email, 
            token: resetToken 
        });
    }
    
    // Always show same message for security
    alert('If an account exists with that email, a reset link has been sent. Check your inbox.');
    S.screen='login';render();
}

// Change password (from settings when logged in)
async function changePassword(){
    const currentPass = document.getElementById('current-pass').value;
    const newPass = document.getElementById('new-pass').value;
    const confirmPass = document.getElementById('confirm-pass').value;
    
    if(newPass !== confirmPass) {
        alert('New passwords do not match.');
        return;
    }
    
    if(newPass.length < 6) {
        alert('Password must be at least 6 characters.');
        return;
    }
    
    // Verify current password
    if(S.user.password !== currentPass) {
        alert('Current password is incorrect.');
        return;
    }
    
    // Update password
    await db('users','PATCH',{ password: newPass },`?email=eq.${encodeURIComponent(S.user.email)}`);
    S.user.password = newPass;
    localStorage.setItem('apc_session',JSON.stringify(S.user));
    
    alert('Password updated successfully!');
    document.getElementById('change-password-form').reset();
}

// Support form submission
async function submitSupport(){
    const subject = document.getElementById('support-subject').value;
    const message = document.getElementById('support-message').value;
    const btn = document.querySelector('#support-form button');
    
    btn.textContent = 'Sending...';
    btn.disabled = true;
    
    const success = await sendEmail('support', {
        name: S.user?.name || 'Unknown',
        email: S.user?.email || 'No email',
        userId: S.user?.id,
        subject,
        message,
        userStats: {
            dayNum: dayNum(),
            totalXP: totalXP(),
            streak: streak(),
            scores: S.scores
        }
    });
    
    if(success) {
        alert('Message sent! We\'ll get back to you within 24-48 hours.');
        document.getElementById('support-form').reset();
    } else {
        alert('Failed to send message. Please try again or email directly at support@aiproof.club');
    }
    
    btn.textContent = 'Send Message';
    btn.disabled = false;
}

// Handle password reset from email link
async function handleResetToken() {
    const params = new URLSearchParams(window.location.search);
    const token = params.get('token');
    
    if(token && window.location.hash.includes('reset')) {
        // Show reset password modal
        S.modal = 'resetPassword';
        S.resetToken = token;
        render();
    }
}

async function completePasswordReset() {
    const newPass = document.getElementById('reset-new-pass').value;
    const confirmPass = document.getElementById('reset-confirm-pass').value;
    
    if(newPass !== confirmPass) {
        alert('Passwords do not match.');
        return;
    }
    
    if(newPass.length < 6) {
        alert('Password must be at least 6 characters.');
        return;
    }
    
    // Find user with this token
    const users = await db('users','GET',null,`?reset_token=eq.${S.resetToken}`);
    
    if(!users?.length) {
        alert('Invalid or expired reset link. Please request a new one.');
        S.modal = null;
        S.screen = 'forgot';
        render();
        return;
    }
    
    const user = users[0];
    
    // Check if token expired
    if(new Date(user.reset_expiry) < new Date()) {
        alert('Reset link has expired. Please request a new one.');
        S.modal = null;
        S.screen = 'forgot';
        render();
        return;
    }
    
    // Update password and clear token
    await db('users','PATCH',{ 
        password: newPass, 
        reset_token: null, 
        reset_expiry: null 
    },`?email=eq.${encodeURIComponent(user.email)}`);
    
    alert('Password reset successfully! You can now log in.');
    S.modal = null;
    S.resetToken = null;
    S.screen = 'login';
    history.replaceState({}, '', location.pathname);
    render();
}

async function save(){
    if(!S.user?.email)return;
    const data = {
        scores: S.scores,
        receipts: S.receipts,
        quests: S.quests,
        diff: S.diff,
        hiddenQuests: S.hiddenQuests,
        customQuests: S.customQuests,
        followedForecasts: S.followedForecasts,
        forecastProgress: S.forecastProgress,
        lastQuestWeek: S.user.lastQuestWeek
    };
    await db('users','PATCH',data,`?email=eq.${encodeURIComponent(S.user.email)}`);
    localStorage.setItem('apc_session',JSON.stringify({...S.user,...data}));
}

// ==================== FORECASTS ====================
const CATEGORIES = {
    'ai': {name: 'AI & Technology', icon: 'ðŸ¤–'},
    'tech': {name: 'Tech & Business', icon: 'ðŸ’»'},
    'crypto': {name: 'Crypto', icon: 'â‚¿'},
    'finance': {name: 'Finance', icon: 'ðŸ“ˆ'},
    'work': {name: 'Future of Work', icon: 'ðŸ’¼'},
    'media': {name: 'Media & Content', icon: 'ðŸŽ¬'}
};

// COMPREHENSIVE FORECAST DATABASE
// Real odds from Polymarket + Metaculus + Billionaire predictions
// Last updated: February 2026
// 50+ forecasts per category with realistic, gradual quest progressions

const FORECAST_DATABASE = [

// ============================================================================
// ðŸ¤– AI & TECHNOLOGY
// ============================================================================

// --- AI MODEL LEADERSHIP ---
{
    id: 'google-ai-dominance',
    title: 'Google maintains AI model leadership through 2026',
    source: 'Polymarket',
    probability: 87,
    timeframe: '2026',
    category: 'ai',
    threatMode: 'ideas',
    threatReason: 'Google\'s dominance means their ecosystem becomes the default. Those not building on Google AI infrastructure may find themselves at a disadvantage.',
    atRisk: 'Developers locked into other AI ecosystems; companies betting heavily on OpenAI or Anthropic',
    opportunities: [
        {
            title: 'ðŸ”§ Google AI Integration Specialist',
            mode: 'execution',
            description: 'Help businesses integrate Google AI tools (Gemini, Vertex AI). Most companies are overwhelmed by options.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Get certified in Google Cloud AI. Complete at least the foundational courses.', xp: 35},
                {mode: 'execution', task: 'Build 3 small projects using different Google AI APIs. Document what each does well.', xp: 40},
                {mode: 'ideas', task: 'Compare Google AI to competitors (OpenAI, Anthropic) for 5 common use cases. Create a comparison chart.', xp: 40},
                {mode: 'execution', task: 'Create a "Which Google AI Tool Should You Use?" decision tree for businesses.', xp: 45},
                {mode: 'personality', task: 'Share your comparison publicly. See what resonates with business owners.', xp: 40},
                {mode: 'personality', task: 'Offer free 30-min consultations to 5 businesses about their AI needs.', xp: 50},
                {mode: 'execution', task: 'Build a case study from one of your consultations. Show before/after.', xp: 50},
                {mode: 'execution', task: 'Create a service package with clear pricing and deliverables.', xp: 45},
                {mode: 'personality', task: 'Get testimonials from your free consultations.', xp: 45},
                {mode: 'execution', task: 'Land your first paid integration client.', xp: 55}
            ]
        }
    ]
},

{
    id: 'agi-before-2027',
    title: 'OpenAI announces AGI achievement before 2027',
    source: 'Polymarket',
    probability: 9,
    timeframe: '2026-2027',
    category: 'ai',
    threatMode: 'ideas',
    threatReason: 'Even a 9% chance of AGI announcement would trigger massive market shifts. Early positioning matters.',
    atRisk: 'Anyone not thinking about post-AGI career paths',
    opportunities: [
        {
            title: 'ðŸ§  AGI Preparedness Consultant',
            mode: 'ideas',
            description: 'Help individuals and businesses think through AGI scenarios. Most people are in denial or paralyzed.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Read 3 foundational AGI texts: Superintelligence, Life 3.0, The Alignment Problem. Take notes.', xp: 40},
                {mode: 'ideas', task: 'Follow 20 AGI researchers on Twitter. Learn the debates and terminology.', xp: 30},
                {mode: 'execution', task: 'Create a personal "AGI Scenarios" document: best case, worst case, most likely case.', xp: 45},
                {mode: 'ideas', task: 'Identify 10 professions and analyze how each would be affected by AGI. Write 1 paragraph each.', xp: 45},
                {mode: 'execution', task: 'Create a framework: "How to Assess Your AGI Exposure" that anyone can use.', xp: 50},
                {mode: 'personality', task: 'Share your framework publicly. Engage with feedback and criticism.', xp: 45},
                {mode: 'personality', task: 'Run a workshop or discussion group on AGI preparedness.', xp: 55},
                {mode: 'execution', task: 'Refine your framework based on real conversations and feedback.', xp: 45},
                {mode: 'personality', task: 'Connect with futurists, consultants, and thought leaders in this space.', xp: 50},
                {mode: 'execution', task: 'Offer paid AGI preparedness consulting to forward-thinking companies.', xp: 60}
            ]
        }
    ]
},

{
    id: 'gpt-6-release',
    title: 'GPT-6 released by end of 2026',
    source: 'Polymarket',
    probability: 85,
    timeframe: '2026',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Each GPT generation makes previous workflows obsolete. Those who adapt fastest win.',
    atRisk: 'People with workflows built around older models who don\'t update',
    opportunities: [
        {
            title: 'ðŸ“š AI Model Update Tracker',
            mode: 'ideas',
            description: 'Be the first to document and explain new AI model capabilities. Huge demand from businesses trying to keep up.',
            difficulty: 'easy',
            timeframe: '1-3 months',
            quests: [
                {mode: 'execution', task: 'Set up alerts for major AI announcements (OpenAI, Google, Anthropic, Meta).', xp: 25},
                {mode: 'execution', task: 'Create a template for quickly analyzing new model releases.', xp: 35},
                {mode: 'execution', task: 'When a new model drops, publish analysis within 24 hours. Speed matters.', xp: 45},
                {mode: 'personality', task: 'Build an audience that relies on you for AI updates. Start a newsletter or social account.', xp: 45},
                {mode: 'execution', task: 'Create comparison charts: old model vs new model for key use cases.', xp: 40},
                {mode: 'personality', task: 'Engage with comments and questions. Become a trusted voice.', xp: 40},
                {mode: 'execution', task: 'Reach 1,000 followers/subscribers in the AI space.', xp: 50},
                {mode: 'ideas', task: 'Identify which businesses need this information most urgently.', xp: 35},
                {mode: 'personality', task: 'Offer "AI Update Briefings" to companies that can\'t keep up.', xp: 50},
                {mode: 'execution', task: 'Get your first paid briefing client.', xp: 55}
            ]
        }
    ]
},

{
    id: 'claude-5-release',
    title: 'Claude 5 released by March 31, 2026',
    source: 'Polymarket',
    probability: 95,
    timeframe: 'Q1 2026',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Anthropic\'s safety-focused approach may become the enterprise standard. Early adopters get competitive advantage.',
    atRisk: 'Enterprises locked into less safety-conscious AI providers',
    opportunities: [
        {
            title: 'ðŸ›¡ï¸ Enterprise AI Safety Consultant',
            mode: 'ideas',
            description: 'Help enterprises implement AI with proper safety guardrails. Anthropic\'s approach is becoming the standard.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Study Anthropic\'s Constitutional AI and safety research. Understand their approach deeply.', xp: 40},
                {mode: 'ideas', task: 'Research enterprise AI failures and lawsuits. What went wrong? Document patterns.', xp: 45},
                {mode: 'execution', task: 'Create an "Enterprise AI Safety Checklist" covering deployment, monitoring, and governance.', xp: 50},
                {mode: 'personality', task: 'Share your checklist with CIOs and CTOs. Get feedback on what they actually worry about.', xp: 50},
                {mode: 'execution', task: 'Develop case studies of companies that got AI safety right vs wrong.', xp: 45},
                {mode: 'personality', task: 'Connect with compliance officers and legal teams at large companies.', xp: 55},
                {mode: 'execution', task: 'Create training materials for non-technical executives on AI risk.', xp: 50},
                {mode: 'personality', task: 'Speak at a business or tech event about enterprise AI safety.', xp: 55},
                {mode: 'execution', task: 'Develop a consulting package: assessment, recommendations, implementation support.', xp: 50},
                {mode: 'execution', task: 'Land your first enterprise safety consulting engagement.', xp: 60}
            ]
        }
    ]
},

{
    id: 'openai-hardware',
    title: 'OpenAI launches consumer hardware product by end of 2026',
    source: 'Polymarket',
    probability: 59,
    timeframe: '2026',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'AI moving into physical devices changes the game. Software-only AI companies may lose ground.',
    atRisk: 'Companies betting AI stays software-only',
    opportunities: [
        {
            title: 'ðŸ”Œ AI Hardware Reviewer/Analyst',
            mode: 'personality',
            description: 'Be the trusted voice for AI hardware reviews before the market gets crowded.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Research existing AI hardware (Humane Pin, Rabbit R1, Meta glasses). What works? What doesn\'t?', xp: 35},
                {mode: 'execution', task: 'If possible, buy or borrow one AI hardware device. Do a thorough review.', xp: 45},
                {mode: 'execution', task: 'Create content reviewing AI hardware. Video, blog, or social thread.', xp: 40},
                {mode: 'personality', task: 'Build an audience interested in AI hardware. Start before the flood of devices hits.', xp: 45},
                {mode: 'ideas', task: 'Predict what OpenAI\'s hardware might do. Write your analysis.', xp: 40},
                {mode: 'execution', task: 'Create a framework for evaluating AI hardware: utility, privacy, battery, integration.', xp: 45},
                {mode: 'personality', task: 'Connect with tech journalists and YouTubers in this space.', xp: 50},
                {mode: 'execution', task: 'When new AI hardware drops, publish reviews quickly.', xp: 45},
                {mode: 'personality', task: 'Get quoted or referenced by a larger publication.', xp: 55},
                {mode: 'execution', task: 'Monetize through affiliate links, sponsorships, or consulting.', xp: 50}
            ]
        }
    ]
},

{
    id: 'ai-bubble-burst',
    title: 'AI industry experiences major downturn by end of 2026',
    source: 'Polymarket',
    probability: 15,
    timeframe: '2026',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'If the bubble bursts, AI-dependent businesses fail. Diversified skills become essential.',
    atRisk: 'Startups with AI as only differentiator; employees at AI-only companies',
    opportunities: [
        {
            title: 'ðŸ—ï¸ AI-Proof Business Builder',
            mode: 'execution',
            description: 'Build businesses that use AI but don\'t depend on it. Sustainable regardless of AI hype cycles.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Identify 10 business models that existed before AI and still work. What makes them resilient?', xp: 35},
                {mode: 'ideas', task: 'Study the dot-com bust. Which companies survived? Why?', xp: 40},
                {mode: 'execution', task: 'Design a business that uses AI for efficiency but could survive without it.', xp: 50},
                {mode: 'ideas', task: 'Identify your "AI-free fallback" â€” what would you do if AI tools disappeared?', xp: 40},
                {mode: 'execution', task: 'Build version 1 of your resilient business. Focus on fundamentals.', xp: 55},
                {mode: 'personality', task: 'Find 10 customers who value your core offering, not just the AI wrapper.', xp: 50},
                {mode: 'execution', task: 'Ensure your business makes money without AI hype. Unit economics matter.', xp: 50},
                {mode: 'personality', task: 'Build relationships with customers who would stick around post-hype.', xp: 45},
                {mode: 'execution', task: 'Document your "AI-resilient" business model. Share learnings.', xp: 45},
                {mode: 'execution', task: 'Reach profitability without depending on AI buzz.', xp: 60}
            ]
        }
    ]
},

{
    id: 'ai-coding-dominance',
    title: 'AI writes majority of code in professional settings by 2027',
    source: 'Industry Consensus / Dario Amodei',
    probability: 60,
    timeframe: '2026-2027',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Coding becomes directing. Junior developer roles transform completely.',
    atRisk: 'Developers who compete on syntax rather than system design and problem-solving',
    opportunities: [
        {
            title: 'ðŸŽ¯ AI Code Director',
            mode: 'execution',
            description: 'Master the art of directing AI coding tools. Build things 10x faster than traditional developers.',
            difficulty: 'medium',
            timeframe: '2-4 months',
            quests: [
                {mode: 'execution', task: 'Use 3 AI coding tools (Cursor, Copilot, Claude) for real projects. Compare them.', xp: 35},
                {mode: 'ideas', task: 'Identify what AI coding tools do well vs poorly. Document patterns.', xp: 40},
                {mode: 'execution', task: 'Build a complete project primarily using AI. Track time vs traditional coding.', xp: 50},
                {mode: 'execution', task: 'Develop your own "AI coding workflow" â€” prompts, review process, iteration.', xp: 45},
                {mode: 'personality', task: 'Share your workflow publicly. Help others learn.', xp: 45},
                {mode: 'execution', task: 'Build 3 projects with your optimized AI workflow. Create a portfolio.', xp: 50},
                {mode: 'ideas', task: 'Identify which types of projects benefit most from AI coding.', xp: 40},
                {mode: 'personality', task: 'Offer to build MVPs for startups using your AI-accelerated approach.', xp: 50},
                {mode: 'execution', task: 'Get your first paid AI-accelerated development client.', xp: 55},
                {mode: 'execution', task: 'Deliver 3 projects faster and cheaper than traditional developers.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-tutors-mainstream',
    title: 'AI tutors outperform average human teachers',
    source: 'Bill Gates',
    probability: 70,
    timeframe: '2-4 years',
    category: 'ai',
    threatMode: 'personality',
    threatReason: 'Teaching content becomes commodity. Human teachers must focus on mentorship, motivation, and emotional support.',
    atRisk: 'Teachers who compete on knowledge delivery rather than inspiration and connection',
    opportunities: [
        {
            title: 'ðŸŽ“ AI-Augmented Tutor',
            mode: 'personality',
            description: 'Combine AI\'s knowledge delivery with human mentorship. Best of both worlds.',
            difficulty: 'easy',
            timeframe: '1-3 months',
            quests: [
                {mode: 'execution', task: 'Test 5 AI tutoring tools (Khanmigo, Synthesis, etc). Understand their strengths.', xp: 30},
                {mode: 'ideas', task: 'Identify what human tutors provide that AI can\'t: accountability, emotional support, customization.', xp: 35},
                {mode: 'execution', task: 'Design a hybrid session: AI handles drill, you handle strategy and motivation.', xp: 40},
                {mode: 'personality', task: 'Run 5 free hybrid tutoring sessions. Get feedback on what works.', xp: 45},
                {mode: 'execution', task: 'Refine your approach based on real student feedback.', xp: 40},
                {mode: 'execution', task: 'Create a curriculum: what does week 1-8 look like for a student?', xp: 45},
                {mode: 'personality', task: 'Get testimonials from your trial students.', xp: 40},
                {mode: 'execution', task: 'Set your pricing. Research market rates.', xp: 35},
                {mode: 'personality', task: 'Tell 30 people you\'re offering tutoring.', xp: 40},
                {mode: 'execution', task: 'Get your first 5 paying students.', xp: 55}
            ]
        }
    ]
},

{
    id: 'full-length-ai-movies',
    title: 'Full-length AI-generated movies become mainstream',
    source: 'Industry Consensus',
    probability: 45,
    timeframe: '2-3 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Film production costs collapse. Story, taste, and distribution become the differentiators.',
    atRisk: 'Technical film roles (VFX, editing) without creative direction skills',
    opportunities: [
        {
            title: 'ðŸŽ¬ AI Film Director',
            mode: 'ideas',
            description: 'Learn to direct AI film tools now. Be ready when feature films become possible.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'execution', task: 'Create your first AI video using Runway, Pika, or Sora. Just 30 seconds.', xp: 30},
                {mode: 'ideas', task: 'Study 10 successful AI short films. What makes them work? Take notes.', xp: 40},
                {mode: 'execution', task: 'Write a 2-page script for a 3-minute short. Keep it visually simple.', xp: 40},
                {mode: 'execution', task: 'Create your first 2-3 minute AI short film.', xp: 50},
                {mode: 'personality', task: 'Share your film publicly. Get feedback from 20 people.', xp: 45},
                {mode: 'execution', task: 'Make version 2 based on feedback. Show improvement.', xp: 45},
                {mode: 'ideas', task: 'Develop your unique style. What\'s your visual signature?', xp: 40},
                {mode: 'personality', task: 'Enter an AI film festival or competition.', xp: 50},
                {mode: 'execution', task: 'Build a portfolio of 5 short films.', xp: 55},
                {mode: 'personality', task: 'Collaborate with other AI filmmakers. Build your network.', xp: 50}
            ]
        }
    ]
},

{
    id: 'ai-medical-diagnosis',
    title: 'AI diagnoses diseases better than average doctors',
    source: 'Multiple Studies',
    probability: 75,
    timeframe: '2-3 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Diagnostic accuracy becomes commodity. Patient care and communication become differentiators.',
    atRisk: 'Diagnostic specialists without strong patient relationship skills',
    opportunities: [
        {
            title: 'ðŸ©º AI Health Navigator',
            mode: 'personality',
            description: 'Help patients understand and navigate AI-assisted healthcare decisions.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research how AI is being used in diagnostics today. What\'s working? What scares patients?', xp: 40},
                {mode: 'ideas', task: 'Identify top 10 patient concerns about AI in healthcare.', xp: 40},
                {mode: 'execution', task: 'Create a guide: "Questions to Ask When AI Is Part of Your Diagnosis"', xp: 45},
                {mode: 'personality', task: 'Share your guide with patient advocacy groups.', xp: 45},
                {mode: 'personality', task: 'Talk to 10 patients about their AI healthcare experiences.', xp: 50},
                {mode: 'execution', task: 'Refine your guide based on real patient concerns.', xp: 40},
                {mode: 'execution', task: 'Develop a service: accompany patients, help interpret AI results.', xp: 50},
                {mode: 'personality', task: 'Connect with doctors who could refer patients needing support.', xp: 55},
                {mode: 'execution', task: 'Get your first 3 paid clients.', xp: 55},
                {mode: 'personality', task: 'Get testimonials and referrals.', xp: 50}
            ]
        }
    ]
},

{
    id: 'ai-surveillance-expansion',
    title: 'AI surveillance expands significantly in democratic countries',
    source: 'Larry Ellison / Industry Trend',
    probability: 55,
    timeframe: '3-5 years',
    category: 'ai',
    threatMode: 'personality',
    threatReason: 'Privacy becomes luxury. Personal branding and public persona management become essential.',
    atRisk: 'People without clear personal brand or who rely on anonymity',
    opportunities: [
        {
            title: 'ðŸ”’ Personal Privacy Consultant',
            mode: 'ideas',
            description: 'Help individuals protect their privacy in an increasingly surveilled world.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research current privacy tools and best practices. Document top 20.', xp: 35},
                {mode: 'execution', task: 'Implement privacy best practices in your own digital life. Document process.', xp: 40},
                {mode: 'execution', task: 'Create a "Personal Privacy Audit" checklist anyone can use.', xp: 45},
                {mode: 'personality', task: 'Offer free privacy audits to 5 friends. Learn what they struggle with.', xp: 45},
                {mode: 'execution', task: 'Create a guide: "Privacy Basics for Normal People"', xp: 45},
                {mode: 'personality', task: 'Share your guide publicly. See what resonates.', xp: 40},
                {mode: 'execution', task: 'Develop tiered service offerings for different privacy needs.', xp: 45},
                {mode: 'personality', task: 'Connect with lawyers and security professionals for referrals.', xp: 50},
                {mode: 'execution', task: 'Get your first paid privacy consultation.', xp: 55},
                {mode: 'execution', task: 'Create recurring revenue through ongoing privacy monitoring.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-voice-cloning-ubiquitous',
    title: 'Perfect voice cloning becomes trivially easy',
    source: 'Industry Consensus',
    probability: 90,
    timeframe: 'Already happening',
    category: 'ai',
    threatMode: 'personality',
    threatReason: 'Voice authenticity disappears. Trust and verification become crucial.',
    atRisk: 'Anyone relying on voice as identity verification',
    opportunities: [
        {
            title: 'âœ… Voice Verification Educator',
            mode: 'execution',
            description: 'Teach businesses and families how to verify voice authenticity and avoid scams.',
            difficulty: 'easy',
            timeframe: '1-3 months',
            quests: [
                {mode: 'ideas', task: 'Research voice cloning tools and scams. Document real examples.', xp: 30},
                {mode: 'execution', task: 'Create a family safety protocol: code words, verification questions.', xp: 35},
                {mode: 'execution', task: 'Create a business protocol for verifying voice communications.', xp: 40},
                {mode: 'personality', task: 'Share your protocols publicly. Help others stay safe.', xp: 40},
                {mode: 'execution', task: 'Create a short workshop: "Protecting Your Family from Voice Scams"', xp: 45},
                {mode: 'personality', task: 'Offer workshop to local community groups, schools, senior centers.', xp: 50},
                {mode: 'execution', task: 'Run 3 free workshops. Refine based on questions asked.', xp: 45},
                {mode: 'personality', task: 'Get testimonials from workshop attendees.', xp: 40},
                {mode: 'execution', task: 'Create paid corporate training on voice security.', xp: 50},
                {mode: 'execution', task: 'Land your first paid corporate training gig.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-realtime-translation',
    title: 'Real-time perfect language translation eliminates barriers',
    source: 'Industry Consensus',
    probability: 85,
    timeframe: '2-3 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Language skills devalue. Cultural understanding becomes the differentiator.',
    atRisk: 'Translators focused on accuracy rather than cultural nuance',
    opportunities: [
        {
            title: 'ðŸŒ Cultural Bridge Consultant',
            mode: 'personality',
            description: 'Help businesses navigate cultural nuances that translation AI misses.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify one culture you understand deeply. What do outsiders get wrong?', xp: 35},
                {mode: 'execution', task: 'Document 10 cultural mistakes companies make with your culture.', xp: 40},
                {mode: 'execution', task: 'Create a "Cultural Due Diligence Checklist" for that market.', xp: 45},
                {mode: 'personality', task: 'Share examples publicly. Build credibility as cultural expert.', xp: 45},
                {mode: 'personality', task: 'Connect with 5 companies doing business in your cultural area.', xp: 50},
                {mode: 'execution', task: 'Offer free cultural audit to one company. Build case study.', xp: 50},
                {mode: 'execution', task: 'Develop service package with clear deliverables.', xp: 45},
                {mode: 'personality', task: 'Get testimonials from your free engagement.', xp: 45},
                {mode: 'execution', task: 'Land your first paid cultural consulting client.', xp: 55},
                {mode: 'personality', task: 'Build referral partnerships with international business consultants.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-music-indistinguishable',
    title: 'AI generates music indistinguishable from human artists',
    source: 'Industry Consensus',
    probability: 80,
    timeframe: '1-2 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Music production becomes commodity. Live performance, brand, and story become the value.',
    atRisk: 'Session musicians and producers focused on technical skill alone',
    opportunities: [
        {
            title: 'ðŸŽµ AI Music Director',
            mode: 'ideas',
            description: 'Direct AI music tools to create the right sound. Be the creative vision.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'execution', task: 'Try 5 AI music tools (Suno, Udio, etc). Create 20 tracks.', xp: 35},
                {mode: 'ideas', task: 'Study music production concepts: arrangement, mixing. Learn vocabulary.', xp: 40},
                {mode: 'execution', task: 'Create a playlist of your best AI-generated tracks.', xp: 40},
                {mode: 'personality', task: 'Share your music publicly. Get feedback.', xp: 40},
                {mode: 'ideas', task: 'Develop your signature sound. What makes your direction distinctive?', xp: 45},
                {mode: 'execution', task: 'Create music for specific use cases: YouTube intros, podcasts, ads.', xp: 45},
                {mode: 'personality', task: 'Offer free music to 5 content creators.', xp: 50},
                {mode: 'execution', task: 'Build portfolio with diverse examples.', xp: 45},
                {mode: 'personality', task: 'List services on freelance platforms.', xp: 45},
                {mode: 'execution', task: 'Land your first paid music creation gig.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-legal-automation',
    title: 'AI handles 80% of routine legal work',
    source: 'Industry Analysis',
    probability: 45,
    timeframe: '5-10 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Legal research becomes automated. Strategy and client relationships remain human.',
    atRisk: 'Junior lawyers focused on research and documentation',
    opportunities: [
        {
            title: 'âš–ï¸ AI Legal Tools Trainer',
            mode: 'execution',
            description: 'Train lawyers to use AI tools effectively. Most are overwhelmed.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'execution', task: 'Test 5 AI legal tools. Document capabilities.', xp: 40},
                {mode: 'ideas', task: 'Identify what legal AI does well vs where it fails.', xp: 40},
                {mode: 'execution', task: 'Create training curriculum for lawyers on AI tools.', xp: 50},
                {mode: 'personality', task: 'Offer free training to one small firm. Get feedback.', xp: 50},
                {mode: 'execution', task: 'Refine based on real user experience.', xp: 45},
                {mode: 'personality', task: 'Connect with bar associations and legal education providers.', xp: 55},
                {mode: 'execution', task: 'Create CLE-eligible content if possible.', xp: 55},
                {mode: 'personality', task: 'Speak at a legal tech event.', xp: 55},
                {mode: 'execution', task: 'Land your first paid training engagement.', xp: 60},
                {mode: 'execution', task: 'Build ongoing training relationships with 3 firms.', xp: 60}
            ]
        }
    ]
},

// ============================================================================
// ðŸ’¼ FUTURE OF WORK
// ============================================================================

{
    id: 'jobs-80-transform',
    title: '80% of jobs will disappear or transform radically',
    source: 'Vinod Khosla',
    probability: 45,
    timeframe: '10-15 years',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Most "doing" gets automated. Value shifts to judgment, creativity, and connection.',
    atRisk: 'Anyone whose job is primarily following processes or handling information',
    opportunities: [
        {
            title: 'ðŸ”„ Career Transition Coach',
            mode: 'personality',
            description: 'Help people navigate career changes in an AI-disrupted world.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research which jobs are most at risk. Create list of 20.', xp: 30},
                {mode: 'ideas', task: 'Research which jobs are growing because of AI. Create list of 20.', xp: 30},
                {mode: 'execution', task: 'Create framework: "How to Assess If Your Job Is At Risk"', xp: 40},
                {mode: 'personality', task: 'Interview 5 people who successfully transitioned careers. What worked?', xp: 45},
                {mode: 'execution', task: 'Create step-by-step career transition playbook.', xp: 45},
                {mode: 'personality', task: 'Offer free transition coaching to 3 worried people.', xp: 50},
                {mode: 'execution', task: 'Document results. What helped? What didn\'t?', xp: 40},
                {mode: 'personality', task: 'Write about your coaching experience. Share stories.', xp: 45},
                {mode: 'execution', task: 'Create coaching package with pricing.', xp: 45},
                {mode: 'personality', task: 'Get your first paid coaching client.', xp: 55}
            ]
        }
    ]
},

{
    id: 'workweek-shrinks',
    title: '2-3 day workweeks become normal for many professions',
    source: 'Bill Gates',
    probability: 35,
    timeframe: '10-15 years',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Productivity gains don\'t require 40 hours. Filling time meaningfully becomes key.',
    atRisk: 'People whose identity is wrapped up in "being busy"',
    opportunities: [
        {
            title: 'ðŸ§˜ Meaningful Time Designer',
            mode: 'ideas',
            description: 'Help people figure out what to do with newfound free time.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Study what people do with unexpected free time. Interview 10.', xp: 35},
                {mode: 'ideas', task: 'Research purpose and meaning frameworks (Ikigai, etc).', xp: 35},
                {mode: 'execution', task: 'Create workshop: "Designing Your Ideal Week"', xp: 45},
                {mode: 'personality', task: 'Run workshop with 10 friends for free.', xp: 45},
                {mode: 'execution', task: 'Refine based on feedback.', xp: 40},
                {mode: 'personality', task: 'Get testimonials from people who found clarity.', xp: 45},
                {mode: 'execution', task: 'Create supporting materials: worksheets, prompts.', xp: 40},
                {mode: 'execution', task: 'Price your workshop.', xp: 40},
                {mode: 'personality', task: 'Partner with companies doing 4-day weeks.', xp: 50},
                {mode: 'execution', task: 'Get first paid workshop booking.', xp: 55}
            ]
        }
    ]
},

{
    id: 'first-trillionaire-ai',
    title: 'First trillionaire comes from AI â€” possibly tiny team',
    source: 'Mark Cuban',
    probability: 50,
    timeframe: '10-15 years',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Winner-take-all intensifies. Small teams capture massive value.',
    atRisk: 'Mid-sized companies without AI leverage',
    opportunities: [
        {
            title: 'ðŸ¢ Micro-Startup Builder',
            mode: 'execution',
            description: 'Build small, profitable businesses using AI leverage. Aim for $10k-100k/month.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'List 10 problems that could be solved with software.', xp: 30},
                {mode: 'ideas', task: 'Research micro-SaaS success stories. What patterns?', xp: 35},
                {mode: 'execution', task: 'Pick one idea. Validate: would 10 people pay $50/month?', xp: 40},
                {mode: 'personality', task: 'Talk to 20 potential customers. Just learn.', xp: 45},
                {mode: 'execution', task: 'Build MVP using AI coding tools.', xp: 50},
                {mode: 'personality', task: 'Get 5 beta users. Free for feedback.', xp: 45},
                {mode: 'execution', task: 'Improve based on feedback. Ship 10 updates.', xp: 50},
                {mode: 'execution', task: 'Add payments. Get first paying customer.', xp: 55},
                {mode: 'execution', task: 'Reach $1k MRR.', xp: 60},
                {mode: 'personality', task: 'Document journey. Build in public.', xp: 50}
            ]
        }
    ]
},

{
    id: 'remote-work-default',
    title: 'Remote/hybrid becomes default for knowledge work',
    source: 'Industry Consensus',
    probability: 85,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'personality',
    threatReason: 'Casual relationship-building disappears. Intentional networking essential.',
    atRisk: 'People who relied on office proximity for advancement',
    opportunities: [
        {
            title: 'ðŸŒ Remote Work Optimizer',
            mode: 'execution',
            description: 'Help companies and individuals optimize remote work.',
            difficulty: 'easy',
            timeframe: '1-3 months',
            quests: [
                {mode: 'ideas', task: 'Document what makes YOUR remote work effective.', xp: 30},
                {mode: 'ideas', task: 'Research common remote work problems.', xp: 30},
                {mode: 'execution', task: 'Create "Remote Work Audit" checklist.', xp: 40},
                {mode: 'personality', task: 'Offer free audits to 5 people or teams.', xp: 45},
                {mode: 'execution', task: 'Create solutions for top 5 problems you find.', xp: 45},
                {mode: 'personality', task: 'Write about findings. Share tips publicly.', xp: 40},
                {mode: 'execution', task: 'Package audit + recommendations as service.', xp: 45},
                {mode: 'personality', task: 'Target specific niche: startups? agencies?', xp: 40},
                {mode: 'execution', task: 'Get first paid engagement.', xp: 50},
                {mode: 'personality', task: 'Get testimonials and referrals.', xp: 45}
            ]
        }
    ]
},

{
    id: 'gig-economy-dominant',
    title: 'Gig/freelance becomes dominant for 50%+ workers',
    source: 'Various Studies',
    probability: 40,
    timeframe: '10-15 years',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Job security disappears. Self-management essential.',
    atRisk: 'People dependent on employer-provided stability',
    opportunities: [
        {
            title: 'ðŸ“‹ Freelancer Success Coach',
            mode: 'personality',
            description: 'Help people transition from employment to freelancing.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'execution', task: 'Document your freelancing journey (or interview 5 freelancers).', xp: 35},
                {mode: 'ideas', task: 'Identify top 10 mistakes new freelancers make.', xp: 35},
                {mode: 'execution', task: 'Create "First 90 Days Freelancing" checklist.', xp: 40},
                {mode: 'personality', task: 'Help 3 people free through their first month.', xp: 50},
                {mode: 'execution', task: 'Document what worked in your coaching.', xp: 40},
                {mode: 'execution', task: 'Create guide: "Employee to Freelancer in 90 Days"', xp: 50},
                {mode: 'personality', task: 'Share success stories from people you helped.', xp: 45},
                {mode: 'execution', task: 'Set up coaching program with pricing.', xp: 45},
                {mode: 'personality', task: 'Partner with communities of aspiring freelancers.', xp: 50},
                {mode: 'execution', task: 'Get 5 paid coaching clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'resume-obsolete',
    title: 'Traditional resumes become obsolete',
    source: 'Industry Trend',
    probability: 65,
    timeframe: '5-7 years',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Past credentials matter less. Demonstrated current ability matters more.',
    atRisk: 'People with impressive credentials but no visible work',
    opportunities: [
        {
            title: 'ðŸ“‚ Portfolio Builder',
            mode: 'execution',
            description: 'Help professionals build portfolios that show, not tell.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Research portfolio best practices for 3 professions.', xp: 30},
                {mode: 'execution', task: 'Build your own portfolio showcasing your work.', xp: 40},
                {mode: 'execution', task: 'Create template others can use.', xp: 40},
                {mode: 'personality', task: 'Help 3 friends build portfolios. Note struggles.', xp: 45},
                {mode: 'execution', task: 'Refine template based on feedback.', xp: 40},
                {mode: 'personality', task: 'Share portfolio tips publicly.', xp: 45},
                {mode: 'execution', task: 'Create service package: review + creation.', xp: 45},
                {mode: 'execution', task: 'Price your service.', xp: 40},
                {mode: 'personality', task: 'Partner with career coaches for referrals.', xp: 50},
                {mode: 'execution', task: 'Get 10 paid portfolio clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ubi-experiments-expand',
    title: 'UBI experiments expand globally',
    source: 'Ray Dalio / Sam Altman',
    probability: 55,
    timeframe: '5-10 years',
    category: 'work',
    threatMode: 'ideas',
    threatReason: 'When basic needs covered, purpose becomes scarce resource.',
    atRisk: 'Those who haven\'t thought about what they\'d do without work pressure',
    opportunities: [
        {
            title: 'ðŸŽ¯ Purpose Discovery Coach',
            mode: 'personality',
            description: 'Help people figure out what they want when survival isn\'t the driver.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research purpose frameworks. Try each on yourself.', xp: 35},
                {mode: 'ideas', task: 'Interview 10 people who feel they\'ve found purpose.', xp: 40},
                {mode: 'execution', task: 'Create your own purpose-discovery workshop.', xp: 45},
                {mode: 'personality', task: 'Run workshop with 5 friends for free.', xp: 45},
                {mode: 'execution', task: 'Refine based on what worked.', xp: 40},
                {mode: 'personality', task: 'Run version 2 with 10 strangers.', xp: 50},
                {mode: 'execution', task: 'Create supporting materials.', xp: 45},
                {mode: 'personality', task: 'Get testimonials from people who found clarity.', xp: 50},
                {mode: 'execution', task: 'Price your workshop and coaching.', xp: 45},
                {mode: 'execution', task: 'Get first paid client.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸ“ˆ FINANCE & ECONOMICS
// ============================================================================

{
    id: 'us-recession-2026',
    title: 'US recession by end of 2026',
    source: 'Polymarket',
    probability: 23,
    timeframe: '2026',
    category: 'finance',
    threatMode: 'execution',
    threatReason: 'Economic uncertainty makes diversified income streams essential.',
    atRisk: 'Those dependent on single income source in vulnerable industry',
    opportunities: [
        {
            title: 'ðŸ’° Recession-Proof Income Builder',
            mode: 'execution',
            description: 'Build multiple income streams that survive downturns.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research which businesses thrived in 2008 recession. What patterns?', xp: 35},
                {mode: 'ideas', task: 'Identify 5 income streams you could realistically build.', xp: 35},
                {mode: 'execution', task: 'Start building income stream #1. Focus on something that helps people save money.', xp: 45},
                {mode: 'execution', task: 'Get first $100 from income stream #1.', xp: 50},
                {mode: 'ideas', task: 'Analyze what worked. Document the process.', xp: 35},
                {mode: 'execution', task: 'Start building income stream #2 in different sector.', xp: 45},
                {mode: 'execution', task: 'Get first $100 from income stream #2.', xp: 50},
                {mode: 'execution', task: 'Create systems so income streams require less time.', xp: 45},
                {mode: 'personality', task: 'Share your diversification journey. Help others.', xp: 40},
                {mode: 'execution', task: 'Reach $1,000/month from diversified sources.', xp: 60}
            ]
        }
    ]
},

{
    id: 'bitcoin-price-2026',
    title: 'Bitcoin hits $100,000 in 2026',
    source: 'Polymarket',
    probability: 55,
    timeframe: '2026',
    category: 'crypto',
    threatMode: 'ideas',
    threatReason: 'Crypto volatility continues. Understanding both upside and downside essential.',
    atRisk: 'People all-in on crypto OR completely ignoring it',
    opportunities: [
        {
            title: 'ðŸ“Š Crypto Risk Educator',
            mode: 'ideas',
            description: 'Help regular people understand crypto risk without hype or FUD.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Study crypto cycles. What patterns repeat? Document.', xp: 40},
                {mode: 'ideas', task: 'Research how regular people lose money in crypto. Top 10 mistakes.', xp: 40},
                {mode: 'execution', task: 'Create guide: "Crypto Risk for Normal People"', xp: 45},
                {mode: 'personality', task: 'Share guide publicly. Avoid both hype and FUD.', xp: 45},
                {mode: 'execution', task: 'Create simple risk assessment framework.', xp: 45},
                {mode: 'personality', task: 'Help 10 people assess their crypto exposure.', xp: 50},
                {mode: 'execution', task: 'Refine framework based on real conversations.', xp: 40},
                {mode: 'personality', task: 'Build audience of crypto-curious normal people.', xp: 50},
                {mode: 'execution', task: 'Create paid course or consulting offer.', xp: 50},
                {mode: 'execution', task: 'Get first paid client.', xp: 55}
            ]
        }
    ]
},

{
    id: 'fed-rate-decisions',
    title: 'Fed maintains tight monetary policy through 2026',
    source: 'Polymarket',
    probability: 65,
    timeframe: '2026',
    category: 'finance',
    threatMode: 'execution',
    threatReason: 'High rates favor savers and established businesses. Startups face headwinds.',
    atRisk: 'Growth-stage companies dependent on cheap capital',
    opportunities: [
        {
            title: 'ðŸ¦ High-Rate Business Strategist',
            mode: 'ideas',
            description: 'Help businesses adapt strategies for high-interest environment.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Study how businesses adapted to 1980s high rates. Lessons?', xp: 40},
                {mode: 'ideas', task: 'Research which business models thrive vs struggle in high-rate environments.', xp: 40},
                {mode: 'execution', task: 'Create framework: "Is Your Business High-Rate Resilient?"', xp: 50},
                {mode: 'personality', task: 'Share framework with business owners. Get feedback.', xp: 45},
                {mode: 'execution', task: 'Develop specific recommendations for different business types.', xp: 50},
                {mode: 'personality', task: 'Offer free strategy sessions to 5 businesses.', xp: 50},
                {mode: 'execution', task: 'Document results. Build case studies.', xp: 45},
                {mode: 'personality', task: 'Write about high-rate business strategy. Build credibility.', xp: 50},
                {mode: 'execution', task: 'Create consulting service package.', xp: 50},
                {mode: 'execution', task: 'Land first paid strategy engagement.', xp: 60}
            ]
        }
    ]
},

{
    id: 'nvidia-largest-company',
    title: 'NVIDIA becomes world\'s largest company',
    source: 'Polymarket',
    probability: 48,
    timeframe: '2026',
    category: 'finance',
    threatMode: 'execution',
    threatReason: 'Compute becomes critical infrastructure. GPU access determines capability.',
    atRisk: 'Companies without compute strategy',
    opportunities: [
        {
            title: 'ðŸ–¥ï¸ Compute Strategy Consultant',
            mode: 'ideas',
            description: 'Help businesses plan their AI compute needs and strategy.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research GPU pricing, cloud compute options, and trends.', xp: 40},
                {mode: 'execution', task: 'Build a model: "How Much Compute Does Your AI Need?"', xp: 50},
                {mode: 'ideas', task: 'Compare cloud providers (AWS, GCP, Azure) for AI workloads.', xp: 45},
                {mode: 'execution', task: 'Create compute cost calculator for common use cases.', xp: 50},
                {mode: 'personality', task: 'Share your analysis with CTOs and technical leaders.', xp: 50},
                {mode: 'execution', task: 'Develop recommendations for different company sizes.', xp: 45},
                {mode: 'personality', task: 'Offer free compute strategy sessions to 5 companies.', xp: 55},
                {mode: 'execution', task: 'Build case studies from your sessions.', xp: 50},
                {mode: 'execution', task: 'Create consulting package.', xp: 50},
                {mode: 'execution', task: 'Land first paid compute strategy engagement.', xp: 60}
            ]
        }
    ]
},

{
    id: 'ai-wealth-inequality',
    title: 'AI significantly exacerbates wealth inequality',
    source: 'Ray Dalio',
    probability: 65,
    timeframe: '5-10 years',
    category: 'finance',
    threatMode: 'execution',
    threatReason: 'Capital and skills compound faster. Those without AI leverage fall behind.',
    atRisk: 'Middle-income workers without AI skills or capital access',
    opportunities: [
        {
            title: 'ðŸŽ“ AI Skills for Underserved',
            mode: 'personality',
            description: 'Teach AI skills to people who might otherwise be left behind.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify one underserved group that could benefit from AI skills.', xp: 35},
                {mode: 'execution', task: 'Create beginner-friendly AI curriculum (5-10 lessons).', xp: 45},
                {mode: 'personality', task: 'Find one organization serving your target group. Pitch free pilot.', xp: 50},
                {mode: 'execution', task: 'Run your first class.', xp: 45},
                {mode: 'personality', task: 'Get feedback and testimonials.', xp: 40},
                {mode: 'execution', task: 'Refine curriculum based on what worked.', xp: 40},
                {mode: 'personality', task: 'Document success stories.', xp: 50},
                {mode: 'execution', task: 'Pitch to 5 more organizations.', xp: 50},
                {mode: 'personality', task: 'Apply for grants to expand program.', xp: 55},
                {mode: 'execution', task: 'Teach 100 people through your program.', xp: 60}
            ]
        }
    ]
},

{
    id: 'intelligence-value-zero',
    title: 'Economic value of raw intelligence approaches zero',
    source: 'Sam Altman',
    probability: 30,
    timeframe: '10-20 years',
    category: 'finance',
    threatMode: 'ideas',
    threatReason: 'When intelligence is free, scarcity shifts to wisdom, judgment, and connection.',
    atRisk: 'Anyone selling "smarts" rather than judgment or human connection',
    opportunities: [
        {
            title: 'ðŸ¤ High-Touch Service Provider',
            mode: 'personality',
            description: 'Double down on services where human connection IS the product.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify services where human relationship is irreplaceable. List 10.', xp: 30},
                {mode: 'ideas', task: 'Assess your skills. Which high-touch service could you provide?', xp: 35},
                {mode: 'execution', task: 'Get relevant training if needed.', xp: 45},
                {mode: 'personality', task: 'Offer free sessions to 5 people for testimonials.', xp: 50},
                {mode: 'execution', task: 'Define your service clearly: who, how, what outcome.', xp: 40},
                {mode: 'personality', task: 'Build referral relationships with 3 complementary providers.', xp: 50},
                {mode: 'execution', task: 'Set up booking and payment.', xp: 40},
                {mode: 'personality', task: 'Get first 3 paying clients.', xp: 55},
                {mode: 'execution', task: 'Create client retention system.', xp: 50},
                {mode: 'personality', task: 'Ask every client for referrals.', xp: 50}
            ]
        }
    ]
},

// ============================================================================
// ðŸŽ¬ MEDIA & CONTENT
// ============================================================================

{
    id: 'personalized-content-all',
    title: 'All content becomes personalized â€” everyone sees different versions',
    source: 'Industry Consensus',
    probability: 70,
    timeframe: '3-5 years',
    category: 'media',
    threatMode: 'execution',
    threatReason: 'Mass content loses value. Deep audience understanding essential.',
    atRisk: 'Creators making generic content for general audiences',
    opportunities: [
        {
            title: 'ðŸŽ¯ Niche Content Creator',
            mode: 'personality',
            description: 'Go deep on a specific niche. Own a category.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'List 5 topics you could create content about for 2 years.', xp: 30},
                {mode: 'ideas', task: 'Research each: audience size, competition, monetization.', xp: 35},
                {mode: 'execution', task: 'Pick your niche. Commit for 90 days.', xp: 35},
                {mode: 'execution', task: 'Create 10 pieces in first 2 weeks.', xp: 45},
                {mode: 'personality', task: 'Engage with every comment.', xp: 40},
                {mode: 'execution', task: 'Analyze what works. Double down.', xp: 40},
                {mode: 'personality', task: 'Connect with 5 adjacent creators.', xp: 50},
                {mode: 'execution', task: 'Reach 1,000 followers.', xp: 50},
                {mode: 'execution', task: 'Create lead magnet for your niche.', xp: 45},
                {mode: 'execution', task: 'Monetize: sponsored, products, or services.', xp: 55}
            ]
        }
    ]
},

{
    id: 'creator-middle-class-gone',
    title: 'Creator middle class disappears â€” top 1% capture most value',
    source: 'Li Jin / Industry Analysis',
    probability: 55,
    timeframe: 'Already happening',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'Attention concentrates. Community becomes the moat.',
    atRisk: 'Creators focused on content alone without building relationships',
    opportunities: [
        {
            title: 'ðŸ  Community Builder',
            mode: 'personality',
            description: 'Build community around a topic. Community > content.',
            difficulty: 'medium',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Identify group that needs community but doesn\'t have great one.', xp: 35},
                {mode: 'execution', task: 'Set up simple community space.', xp: 35},
                {mode: 'personality', task: 'Personally invite 20 potential great members.', xp: 45},
                {mode: 'execution', task: 'Create simple structure: channels, welcome, events.', xp: 40},
                {mode: 'personality', task: 'Host first event. Get people talking to each other.', xp: 50},
                {mode: 'personality', task: 'Make 3 introductions between members.', xp: 45},
                {mode: 'execution', task: 'Reach 50 active members.', xp: 50},
                {mode: 'personality', task: 'Identify and empower community leaders.', xp: 50},
                {mode: 'execution', task: 'Create membership tier.', xp: 50},
                {mode: 'execution', task: 'Get first 10 paying members.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-news-generation',
    title: 'AI generates majority of news content',
    source: 'Industry Trend',
    probability: 60,
    timeframe: '3-5 years',
    category: 'media',
    threatMode: 'execution',
    threatReason: 'Basic reporting automated. Original investigation becomes differentiator.',
    atRisk: 'Reporters rewriting press releases',
    opportunities: [
        {
            title: 'ðŸ” Independent Investigator',
            mode: 'ideas',
            description: 'Do investigative work AI can\'t: building sources, deep analysis.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Study investigative journalism techniques.', xp: 40},
                {mode: 'ideas', task: 'Identify local topic deserving more scrutiny.', xp: 40},
                {mode: 'execution', task: 'Start researching: public records, documents.', xp: 45},
                {mode: 'personality', task: 'Reach out to 5 potential sources.', xp: 50},
                {mode: 'execution', task: 'File your first public records request.', xp: 45},
                {mode: 'execution', task: 'Organize findings. Create timeline.', xp: 45},
                {mode: 'personality', task: 'Connect with established journalists for mentorship.', xp: 55},
                {mode: 'execution', task: 'Write up findings. Start with verified facts.', xp: 50},
                {mode: 'execution', task: 'Publish investigation.', xp: 55},
                {mode: 'personality', task: 'Build reputation through quality work.', xp: 55}
            ]
        }
    ]
},

{
    id: 'influencer-trust-collapse',
    title: 'Influencer marketing oversaturates â€” trust collapses',
    source: 'Industry Analysis',
    probability: 70,
    timeframe: '2-3 years',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'Generic influence loses value. Deep niche authority becomes premium.',
    atRisk: 'Influencers promoting anything for money',
    opportunities: [
        {
            title: 'ðŸŽ–ï¸ Trusted Niche Authority',
            mode: 'personality',
            description: 'Build trust in one area by saying no to irrelevant partnerships.',
            difficulty: 'medium',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Identify one area where you have genuine expertise.', xp: 35},
                {mode: 'execution', task: 'Create content demonstrating deep knowledge, not surface takes.', xp: 45},
                {mode: 'personality', task: 'Be publicly honest about products you don\'t recommend.', xp: 45},
                {mode: 'execution', task: 'Only work with brands you genuinely use and believe in.', xp: 40},
                {mode: 'personality', task: 'Build relationships with your audience. Know them by name.', xp: 50},
                {mode: 'execution', task: 'Create signature content format that showcases expertise.', xp: 45},
                {mode: 'personality', task: 'Turn down at least 3 paid opportunities that don\'t fit.', xp: 45},
                {mode: 'execution', task: 'Document your decision-making process publicly.', xp: 40},
                {mode: 'personality', task: 'Get testimonials from followers about your trustworthiness.', xp: 50},
                {mode: 'execution', task: 'Command premium rates because of your credibility.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// â‚¿ CRYPTO & WEB3
// ============================================================================

{
    id: 'bitcoin-nation-reserve',
    title: 'Bitcoin becomes nation-state reserve asset (more countries)',
    source: 'El Salvador precedent / Polymarket',
    probability: 50,
    timeframe: '5-10 years',
    category: 'crypto',
    threatMode: 'ideas',
    threatReason: 'Financial infrastructure changes. Understanding old and new systems valuable.',
    atRisk: 'Finance professionals dismissing crypto entirely',
    opportunities: [
        {
            title: 'ðŸ¦ Crypto-TradFi Bridge',
            mode: 'ideas',
            description: 'Help traditional finance understand and integrate crypto.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Learn crypto custody, compliance, integration basics.', xp: 40},
                {mode: 'ideas', task: 'Understand what traditional finance is most confused about.', xp: 40},
                {mode: 'execution', task: 'Create "Crypto Primer for Finance Professionals"', xp: 45},
                {mode: 'personality', task: 'Share primer with people in traditional finance.', xp: 45},
                {mode: 'execution', task: 'Create weekly digest of crypto-finance news.', xp: 40},
                {mode: 'personality', task: 'Connect with compliance officers at financial institutions.', xp: 50},
                {mode: 'execution', task: 'Develop framework for evaluating crypto integration.', xp: 50},
                {mode: 'personality', task: 'Speak at finance industry event.', xp: 55},
                {mode: 'execution', task: 'Get first consulting engagement.', xp: 60},
                {mode: 'execution', task: 'Build retainer relationships.', xp: 60}
            ]
        }
    ]
},

{
    id: 'defi-100m-users',
    title: 'DeFi reaches 100M+ users globally',
    source: 'Industry Projections',
    probability: 55,
    timeframe: '3-5 years',
    category: 'crypto',
    threatMode: 'execution',
    threatReason: 'Financial services go permissionless. Early movers in onboarding win.',
    atRisk: 'Traditional banking focused on gatekeeping',
    opportunities: [
        {
            title: 'ðŸšª DeFi Onboarding Guide',
            mode: 'execution',
            description: 'Help regular people use DeFi safely. Most are scared or confused.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'execution', task: 'Use 5 DeFi protocols yourself. Document experience.', xp: 35},
                {mode: 'ideas', task: 'Identify top 5 barriers preventing normal people from using DeFi.', xp: 35},
                {mode: 'execution', task: 'Create step-by-step guide for using one protocol safely.', xp: 45},
                {mode: 'personality', task: 'Walk 3 non-crypto friends through DeFi.', xp: 50},
                {mode: 'execution', task: 'Refine guide based on feedback.', xp: 40},
                {mode: 'execution', task: 'Create video tutorials.', xp: 45},
                {mode: 'personality', task: 'Share in crypto-curious communities.', xp: 45},
                {mode: 'execution', task: 'Build reputation as "safe DeFi guide"', xp: 50},
                {mode: 'personality', task: 'Offer paid 1:1 onboarding sessions.', xp: 50},
                {mode: 'execution', task: 'Get 10 paid clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'satoshi-moves-bitcoin',
    title: 'Satoshi moves Bitcoin in 2026',
    source: 'Polymarket',
    probability: 5,
    timeframe: '2026',
    category: 'crypto',
    threatMode: 'ideas',
    threatReason: 'Low probability but massive impact event. Preparation thinking valuable.',
    atRisk: 'Bitcoin maximalists who haven\'t considered this scenario',
    opportunities: [
        {
            title: 'ðŸ”® Black Swan Scenario Planner',
            mode: 'ideas',
            description: 'Help investors think through low-probability, high-impact scenarios.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'List 10 low-probability events that would massively impact markets.', xp: 40},
                {mode: 'ideas', task: 'Research historical black swan events. What patterns?', xp: 40},
                {mode: 'execution', task: 'Create framework for evaluating black swan scenarios.', xp: 50},
                {mode: 'execution', task: 'Develop "scenario cards" for top 10 unlikely events.', xp: 50},
                {mode: 'personality', task: 'Share framework with investors. Get feedback.', xp: 50},
                {mode: 'execution', task: 'Create recommendations for each scenario.', xp: 50},
                {mode: 'personality', task: 'Write about scenario planning. Build credibility.', xp: 50},
                {mode: 'execution', task: 'Develop consulting service for scenario planning.', xp: 50},
                {mode: 'personality', task: 'Connect with wealth managers who serve HNW clients.', xp: 55},
                {mode: 'execution', task: 'Land first paid scenario planning engagement.', xp: 60}
            ]
        }
    ]
},

// ============================================================================
// ðŸ§¬ HUMAN ENHANCEMENT & LONGEVITY
// ============================================================================

{
    id: 'life-extension-therapies',
    title: 'Radical life extension therapies emerge',
    source: 'Peter Thiel / Bryan Johnson',
    probability: 35,
    timeframe: '10-20 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Lifespan extends. Career planning over 60+ years requires new approaches.',
    atRisk: 'People planning for traditional retirement at 65',
    opportunities: [
        {
            title: 'ðŸ§¬ Longevity Content Creator',
            mode: 'personality',
            description: 'Document and explain longevity science for regular people.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Follow 10 longevity researchers. Learn the landscape.', xp: 30},
                {mode: 'ideas', task: 'Read "Lifespan" or equivalent. Take notes.', xp: 35},
                {mode: 'execution', task: 'Create first piece of longevity content.', xp: 35},
                {mode: 'execution', task: 'Establish posting schedule. 3x per week.', xp: 40},
                {mode: 'personality', task: 'Engage with longevity community.', xp: 40},
                {mode: 'execution', task: 'Create 20 pieces over 6 weeks.', xp: 50},
                {mode: 'ideas', task: 'Find your unique angle.', xp: 40},
                {mode: 'execution', task: 'Reach 500 followers.', xp: 50},
                {mode: 'personality', task: 'Interview longevity expert.', xp: 55},
                {mode: 'execution', task: 'Monetize through courses or sponsorships.', xp: 55}
            ]
        }
    ]
},

{
    id: 'human-ai-merge-begins',
    title: 'Humans begin merging with AI through brain interfaces',
    source: 'Elon Musk / Neuralink',
    probability: 40,
    timeframe: '10-15 years',
    category: 'ai',
    threatMode: 'ideas',
    threatReason: 'Cognitive enhancement becomes possible. New ethical questions emerge.',
    atRisk: 'Those who refuse enhancement competing against enhanced humans',
    opportunities: [
        {
            title: 'ðŸ§  Enhancement Ethics Educator',
            mode: 'ideas',
            description: 'Help people think through ethics of human enhancement.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Read foundational texts on enhancement ethics.', xp: 40},
                {mode: 'ideas', task: 'Create framework: questions before enhancement.', xp: 45},
                {mode: 'execution', task: 'Write accessible article on enhancement ethics.', xp: 45},
                {mode: 'personality', task: 'Share framework. Engage with responses.', xp: 40},
                {mode: 'ideas', task: 'Follow Neuralink, Synchron developments.', xp: 35},
                {mode: 'personality', task: 'Create discussion group on enhancement ethics.', xp: 50},
                {mode: 'execution', task: 'Develop workshop on enhancement decisions.', xp: 55},
                {mode: 'personality', task: 'Pilot workshop with small group.', xp: 50},
                {mode: 'execution', task: 'Create resources for companies.', xp: 50},
                {mode: 'personality', task: 'Get invited to speak on enhancement ethics.', xp: 60}
            ]
        }
    ]
},

// ADDITIONAL FORECASTS INSERTED HERE
// ============================================================================
// ðŸ’» TECH & BUSINESS
// ============================================================================

{
    id: 'spacex-ipo-trillion',
    title: 'SpaceX IPO closes above $1 trillion market cap',
    source: 'Polymarket',
    probability: 81,
    timeframe: '2026-2027',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'Space economy opens up. Early movers in space-adjacent businesses win.',
    atRisk: 'Companies ignoring space as a market',
    opportunities: [
        {
            title: 'ðŸš€ Space Economy Analyst',
            mode: 'ideas',
            description: 'Help investors and businesses understand opportunities in the emerging space economy.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research the space economy: Starlink, satellite internet, space tourism. Map the landscape.', xp: 40},
                {mode: 'ideas', task: 'Identify 20 companies that could benefit from SpaceX success (suppliers, competitors, adjacent).', xp: 40},
                {mode: 'execution', task: 'Create "Space Economy Investment Map" showing opportunities and connections.', xp: 50},
                {mode: 'personality', task: 'Share your analysis with investors and space enthusiasts.', xp: 45},
                {mode: 'execution', task: 'Write weekly updates on space economy developments.', xp: 45},
                {mode: 'personality', task: 'Build audience of space-curious investors.', xp: 50},
                {mode: 'execution', task: 'Create premium research reports on specific opportunities.', xp: 55},
                {mode: 'personality', task: 'Connect with VCs and analysts covering space.', xp: 55},
                {mode: 'execution', task: 'Develop consulting offering for space-adjacent investment.', xp: 55},
                {mode: 'execution', task: 'Land first paid research or consulting client.', xp: 60}
            ]
        }
    ]
},

{
    id: 'anthropic-ipo',
    title: 'Anthropic IPO values company at $100B+',
    source: 'Polymarket',
    probability: 45,
    timeframe: '2026-2027',
    category: 'tech',
    threatMode: 'ideas',
    threatReason: 'AI safety-focused companies may dominate enterprise. Understanding their approach matters.',
    atRisk: 'Businesses choosing AI vendors without considering safety track record',
    opportunities: [
        {
            title: 'ðŸ›¡ï¸ AI Vendor Evaluation Consultant',
            mode: 'ideas',
            description: 'Help enterprises choose between AI vendors based on safety, reliability, and fit.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Deep dive into differences between OpenAI, Anthropic, Google, Meta AI approaches.', xp: 40},
                {mode: 'execution', task: 'Create comparison matrix: safety, capabilities, pricing, enterprise features.', xp: 45},
                {mode: 'ideas', task: 'Research AI vendor failures and successes. What went wrong/right?', xp: 40},
                {mode: 'execution', task: 'Develop "AI Vendor Selection Framework" for enterprises.', xp: 50},
                {mode: 'personality', task: 'Share framework with CTOs and technical leaders.', xp: 50},
                {mode: 'execution', task: 'Create RFP template for AI vendor evaluation.', xp: 45},
                {mode: 'personality', task: 'Offer free vendor evaluations to 3 companies.', xp: 50},
                {mode: 'execution', task: 'Build case studies from your evaluations.', xp: 45},
                {mode: 'execution', task: 'Package as consulting service.', xp: 50},
                {mode: 'execution', task: 'Get first paid vendor evaluation engagement.', xp: 55}
            ]
        }
    ]
},

{
    id: 'apple-ai-device',
    title: 'Apple launches dedicated AI device (not phone/watch/computer)',
    source: 'Industry Rumors',
    probability: 40,
    timeframe: '2026-2027',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'Apple entering AI hardware legitimizes the category and sets design standards.',
    atRisk: 'AI hardware startups that can\'t compete with Apple\'s ecosystem',
    opportunities: [
        {
            title: 'ðŸ“± Apple Ecosystem AI Developer',
            mode: 'execution',
            description: 'Build apps and integrations for Apple\'s AI ecosystem before competitors.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'execution', task: 'Learn Apple\'s AI frameworks: Core ML, Create ML, Apple Intelligence APIs.', xp: 45},
                {mode: 'ideas', task: 'Study how Apple approaches AI differently (on-device, privacy-focused).', xp: 40},
                {mode: 'execution', task: 'Build a simple app using Apple\'s AI capabilities.', xp: 50},
                {mode: 'ideas', task: 'Identify 10 app ideas that could leverage Apple AI hardware.', xp: 40},
                {mode: 'execution', task: 'Prototype your best app idea.', xp: 55},
                {mode: 'personality', task: 'Share your development journey with iOS developer community.', xp: 45},
                {mode: 'execution', task: 'Submit app to App Store.', xp: 50},
                {mode: 'personality', task: 'Connect with Apple developer relations if possible.', xp: 50},
                {mode: 'execution', task: 'Iterate based on user feedback.', xp: 45},
                {mode: 'execution', task: 'Get 1,000 downloads or first revenue.', xp: 60}
            ]
        }
    ]
},

{
    id: 'meta-metaverse-pivot',
    title: 'Meta pivots away from metaverse, doubles down on AI',
    source: 'Industry Analysis',
    probability: 70,
    timeframe: '2026',
    category: 'tech',
    threatMode: 'ideas',
    threatReason: 'VR/AR timelines extend. AI becomes the near-term opportunity.',
    atRisk: 'VR developers who bet everything on near-term metaverse adoption',
    opportunities: [
        {
            title: 'ðŸ¥½ VR/AR Long-Term Positioning',
            mode: 'ideas',
            description: 'Position for VR/AR\'s eventual success while building sustainable income now.',
            difficulty: 'medium',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research VR/AR adoption curves. When do experts expect mass adoption?', xp: 35},
                {mode: 'ideas', task: 'Identify skills that transfer from VR/AR to current AI opportunities.', xp: 40},
                {mode: 'execution', task: 'Build one project that works in both VR and non-VR contexts.', xp: 50},
                {mode: 'execution', task: 'Create content about VR/AR for the long-term believers.', xp: 40},
                {mode: 'personality', task: 'Build community of patient VR/AR enthusiasts.', xp: 50},
                {mode: 'execution', task: 'Develop AI-powered tools that could enhance future VR/AR.', xp: 50},
                {mode: 'personality', task: 'Connect with VR/AR researchers and developers.', xp: 50},
                {mode: 'execution', task: 'Create sustainable income while waiting for VR/AR.', xp: 55},
                {mode: 'ideas', task: 'Write "State of VR/AR" annual report to build authority.', xp: 45},
                {mode: 'execution', task: 'Be positioned when VR/AR finally takes off.', xp: 55}
            ]
        }
    ]
},

{
    id: 'tiktok-ban-upheld',
    title: 'TikTok ban or forced sale happens in US',
    source: 'Legal Analysis',
    probability: 55,
    timeframe: '2026',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'Creator platforms are fragile. Diversification across platforms essential.',
    atRisk: 'Creators dependent entirely on TikTok for income',
    opportunities: [
        {
            title: 'ðŸ“± Platform-Agnostic Creator',
            mode: 'execution',
            description: 'Build audience across multiple platforms so no single ban can destroy your business.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Audit your current platform dependency. Where does your income come from?', xp: 30},
                {mode: 'execution', task: 'Identify 3 platforms where your content could work.', xp: 35},
                {mode: 'execution', task: 'Repurpose your best content for a second platform.', xp: 40},
                {mode: 'execution', task: 'Post consistently on 2 platforms for 30 days.', xp: 45},
                {mode: 'personality', task: 'Build email list to own your audience directly.', xp: 50},
                {mode: 'execution', task: 'Get 500+ subscribers on email list.', xp: 50},
                {mode: 'execution', task: 'Create content that drives people to your owned channels.', xp: 45},
                {mode: 'personality', task: 'Build relationships with followers across platforms.', xp: 45},
                {mode: 'execution', task: 'Ensure no single platform is >50% of your audience.', xp: 50},
                {mode: 'execution', task: 'Create revenue stream that doesn\'t depend on any platform.', xp: 55}
            ]
        }
    ]
},

{
    id: 'twitter-x-decline',
    title: 'Twitter/X loses significant market share to alternatives',
    source: 'Industry Analysis',
    probability: 45,
    timeframe: '2026',
    category: 'tech',
    threatMode: 'personality',
    threatReason: 'Professional networking platforms shift. Being early on new platforms matters.',
    atRisk: 'Professionals whose network is entirely on Twitter/X',
    opportunities: [
        {
            title: 'ðŸ”„ Platform Migration Expert',
            mode: 'personality',
            description: 'Help professionals and businesses migrate their presence to emerging platforms.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Research Twitter alternatives: Threads, Bluesky, Mastodon. What\'s different about each?', xp: 30},
                {mode: 'execution', task: 'Create accounts on 3 alternative platforms. Learn how they work.', xp: 35},
                {mode: 'execution', task: 'Document best practices for each platform.', xp: 40},
                {mode: 'personality', task: 'Build small presence on each platform to understand dynamics.', xp: 45},
                {mode: 'execution', task: 'Create "Platform Migration Playbook" guide.', xp: 45},
                {mode: 'personality', task: 'Help 5 people migrate their presence for free.', xp: 50},
                {mode: 'execution', task: 'Document results and best practices.', xp: 40},
                {mode: 'personality', task: 'Share case studies of successful migrations.', xp: 45},
                {mode: 'execution', task: 'Offer paid migration services.', xp: 50},
                {mode: 'execution', task: 'Get first paid migration client.', xp: 55}
            ]
        }
    ]
},

{
    id: 'amazon-ai-assistant',
    title: 'Amazon launches GPT-competitor AI assistant',
    source: 'Industry Rumors',
    probability: 75,
    timeframe: '2026',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'E-commerce AI changes shopping forever. Product discovery goes conversational.',
    atRisk: 'E-commerce sellers not optimizing for AI-driven discovery',
    opportunities: [
        {
            title: 'ðŸ›’ AI Shopping Optimization',
            mode: 'execution',
            description: 'Help e-commerce sellers optimize for AI-driven product discovery.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Study how AI assistants recommend products. What signals do they use?', xp: 40},
                {mode: 'ideas', task: 'Research how Amazon\'s algorithm currently works. Read case studies.', xp: 40},
                {mode: 'execution', task: 'Create framework for AI-friendly product listings.', xp: 45},
                {mode: 'execution', task: 'Test framework on real products (yours or client\'s).', xp: 50},
                {mode: 'personality', task: 'Share findings with Amazon seller communities.', xp: 45},
                {mode: 'execution', task: 'Document before/after results.', xp: 45},
                {mode: 'personality', task: 'Offer free audits to 5 Amazon sellers.', xp: 50},
                {mode: 'execution', task: 'Refine framework based on real results.', xp: 45},
                {mode: 'execution', task: 'Create consulting service package.', xp: 50},
                {mode: 'execution', task: 'Get first paid optimization client.', xp: 55}
            ]
        }
    ]
},

{
    id: 'starlink-global-coverage',
    title: 'Starlink achieves true global coverage',
    source: 'SpaceX Announcements',
    probability: 85,
    timeframe: '2026',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'Internet everywhere changes remote work, travel, and living possibilities.',
    atRisk: 'Businesses built on geographic internet limitations',
    opportunities: [
        {
            title: 'ðŸŒ Remote Location Business',
            mode: 'execution',
            description: 'Build businesses that leverage internet access in previously unreachable locations.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Identify 10 businesses that couldn\'t exist without reliable rural/remote internet.', xp: 35},
                {mode: 'ideas', task: 'Research digital nomad trends. Where are people going? What do they need?', xp: 40},
                {mode: 'execution', task: 'Visit or research 3 remote locations with new Starlink coverage.', xp: 45},
                {mode: 'ideas', task: 'Identify specific opportunity in underserved remote location.', xp: 45},
                {mode: 'execution', task: 'Create business plan for remote-location venture.', xp: 50},
                {mode: 'personality', task: 'Connect with people already living/working in remote areas.', xp: 50},
                {mode: 'execution', task: 'Test your concept with minimal investment.', xp: 55},
                {mode: 'execution', task: 'Get first customers or validate demand.', xp: 55},
                {mode: 'personality', task: 'Document your journey for others interested in remote opportunities.', xp: 45},
                {mode: 'execution', task: 'Scale or pivot based on real results.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸš— AUTONOMOUS VEHICLES & TRANSPORTATION
// ============================================================================

{
    id: 'robotaxi-10-cities',
    title: 'Robotaxis operate in 10+ major US cities',
    source: 'Industry Projections',
    probability: 70,
    timeframe: '2026-2027',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'Transportation becomes a service, not ownership. Massive ripple effects.',
    atRisk: 'Car dealerships, parking garages, gas stations in urban areas',
    opportunities: [
        {
            title: 'ðŸš• Robotaxi Experience Designer',
            mode: 'ideas',
            description: 'Design in-vehicle experiences for passengers who no longer need to drive.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'execution', task: 'Take 10+ robotaxi rides (Waymo, Cruise). Document the experience in detail.', xp: 40},
                {mode: 'ideas', task: 'Identify 15 things passengers could do during rides they can\'t do while driving.', xp: 40},
                {mode: 'ideas', task: 'Study airline and train passenger experiences. What translates to cars?', xp: 35},
                {mode: 'execution', task: 'Design 5 in-vehicle experience concepts (productivity, entertainment, wellness).', xp: 50},
                {mode: 'personality', task: 'Survey 30 robotaxi riders about what they want.', xp: 50},
                {mode: 'execution', task: 'Create detailed design deck for best concept.', xp: 50},
                {mode: 'personality', task: 'Share concepts with AV companies and automotive designers.', xp: 55},
                {mode: 'execution', task: 'Build prototype or mockup of one experience.', xp: 55},
                {mode: 'personality', task: 'Connect with automotive interior designers.', xp: 50},
                {mode: 'execution', task: 'Pitch to AV companies or automotive suppliers.', xp: 60}
            ]
        }
    ]
},

{
    id: 'ev-charging-ubiquitous',
    title: 'EV charging becomes as convenient as gas stations',
    source: 'Industry Projections',
    probability: 60,
    timeframe: '3-5 years',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'EV adoption accelerates. Gas station business model transforms.',
    atRisk: 'Gas stations that don\'t adapt; mechanics specialized in combustion engines',
    opportunities: [
        {
            title: 'âš¡ EV Charging Location Scout',
            mode: 'execution',
            description: 'Help businesses identify and develop EV charging opportunities.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research EV charging economics. How do charging stations make money?', xp: 35},
                {mode: 'ideas', task: 'Study where EV drivers charge and where gaps exist.', xp: 40},
                {mode: 'execution', task: 'Map charging deserts in your area using apps like PlugShare.', xp: 40},
                {mode: 'execution', task: 'Identify 10 businesses that could benefit from adding charging.', xp: 45},
                {mode: 'personality', task: 'Talk to 5 business owners about adding EV charging.', xp: 50},
                {mode: 'ideas', task: 'Research incentives and grants for EV charging installation.', xp: 40},
                {mode: 'execution', task: 'Create proposal template for businesses considering charging.', xp: 50},
                {mode: 'personality', task: 'Connect with EV charging installers for partnerships.', xp: 50},
                {mode: 'execution', task: 'Help one business through the charging installation process.', xp: 55},
                {mode: 'execution', task: 'Get first paid consulting or referral fee.', xp: 55}
            ]
        }
    ]
},

{
    id: 'delivery-robots-common',
    title: 'Delivery robots become common in suburban neighborhoods',
    source: 'Industry Projections',
    probability: 50,
    timeframe: '3-5 years',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'Last-mile delivery transforms. Local delivery jobs change significantly.',
    atRisk: 'Delivery drivers, local courier services',
    opportunities: [
        {
            title: 'ðŸ¤– Robot Delivery Coordinator',
            mode: 'execution',
            description: 'Help businesses integrate robot delivery into their operations.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research delivery robot companies: Starship, Serve, Nuro. What\'s available?', xp: 35},
                {mode: 'execution', task: 'Map which areas in your region have robot delivery available.', xp: 35},
                {mode: 'ideas', task: 'Identify businesses that could benefit: restaurants, pharmacies, grocers.', xp: 40},
                {mode: 'personality', task: 'Talk to 5 local businesses about their delivery challenges.', xp: 45},
                {mode: 'execution', task: 'Create business case template for robot delivery adoption.', xp: 45},
                {mode: 'personality', task: 'Connect with robot delivery company sales teams.', xp: 50},
                {mode: 'execution', task: 'Help one business pilot robot delivery.', xp: 55},
                {mode: 'execution', task: 'Document results: cost savings, customer satisfaction.', xp: 45},
                {mode: 'personality', task: 'Share case study with other businesses.', xp: 45},
                {mode: 'execution', task: 'Get paid for integration consulting.', xp: 55}
            ]
        }
    ]
},

{
    id: 'flying-cars-limited',
    title: 'Flying cars/air taxis begin limited commercial operations',
    source: 'Joby, Archer announcements',
    probability: 45,
    timeframe: '2026-2027',
    category: 'tech',
    threatMode: 'ideas',
    threatReason: 'New transportation layer emerges. Early infrastructure positions win big.',
    atRisk: 'Urban real estate without vertical takeoff potential',
    opportunities: [
        {
            title: 'ðŸ›« Vertiport Scout',
            mode: 'ideas',
            description: 'Identify and evaluate potential locations for air taxi takeoff/landing spots.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research air taxi requirements: space, noise limits, infrastructure.', xp: 40},
                {mode: 'ideas', task: 'Study early vertiport developments. What are they looking for?', xp: 40},
                {mode: 'execution', task: 'Map 20 potential vertiport locations in your metro area.', xp: 50},
                {mode: 'ideas', task: 'Research zoning and regulatory requirements for vertiports.', xp: 45},
                {mode: 'personality', task: 'Connect with commercial real estate developers.', xp: 50},
                {mode: 'execution', task: 'Create location evaluation framework.', xp: 50},
                {mode: 'personality', task: 'Reach out to air taxi companies about site selection.', xp: 55},
                {mode: 'execution', task: 'Develop pitch deck for property owners.', xp: 50},
                {mode: 'personality', task: 'Facilitate introductions between property owners and air taxi cos.', xp: 55},
                {mode: 'execution', task: 'Get commission or fee from successful site development.', xp: 60}
            ]
        }
    ]
},

// ============================================================================
// ðŸ  SERVICES & TRADES
// ============================================================================

{
    id: 'handyman-premium',
    title: 'Skilled trades command premium prices as supply shrinks',
    source: 'Labor Statistics',
    probability: 85,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Everyone went to college. Skilled trades face massive labor shortage.',
    atRisk: 'White-collar workers competing in oversupplied job markets',
    opportunities: [
        {
            title: 'ðŸ”§ Premium Handyman Service',
            mode: 'execution',
            description: 'High-end handyman service for busy professionals who can\'t find reliable help.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify 10 common home repairs/tasks that are hard to find help for.', xp: 30},
                {mode: 'execution', task: 'Learn or improve 3 handyman skills (YouTube, classes, practice).', xp: 45},
                {mode: 'execution', task: 'Get basic tools and supplies for common repairs.', xp: 35},
                {mode: 'personality', task: 'Tell 20 people you\'re available for handyman work.', xp: 40},
                {mode: 'execution', task: 'Complete your first 5 jobs (even if cheap/free).', xp: 45},
                {mode: 'personality', task: 'Ask every customer for review and referral.', xp: 45},
                {mode: 'execution', task: 'Set premium pricing based on reliability and quality.', xp: 40},
                {mode: 'execution', task: 'Create booking system and professional presence.', xp: 45},
                {mode: 'personality', task: 'Build relationships with real estate agents for referrals.', xp: 50},
                {mode: 'execution', task: 'Reach $2,000/month in handyman income.', xp: 55}
            ]
        }
    ]
},

{
    id: 'landscaping-shortage',
    title: 'Landscaping and outdoor services face critical labor shortage',
    source: 'Industry Reports',
    probability: 80,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Outdoor work is hard but increasingly valuable. Supply/demand imbalance grows.',
    atRisk: 'Those competing in oversupplied indoor/office job markets',
    opportunities: [
        {
            title: 'ðŸŒ¿ Premium Landscaping Service',
            mode: 'execution',
            description: 'High-end landscaping for clients who can\'t find reliable service.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research landscaping services in your area. What\'s missing?', xp: 30},
                {mode: 'execution', task: 'Start with basic services: mowing, trimming, cleanup. Get equipment.', xp: 40},
                {mode: 'personality', task: 'Get first 5 customers from neighbors, friends, Nextdoor.', xp: 45},
                {mode: 'execution', task: 'Deliver exceptional service. Show up on time, communicate clearly.', xp: 40},
                {mode: 'personality', task: 'Ask every customer for review and referral.', xp: 45},
                {mode: 'execution', task: 'Learn additional skills: irrigation, hardscaping basics, design.', xp: 50},
                {mode: 'execution', task: 'Raise prices as demand increases.', xp: 40},
                {mode: 'personality', task: 'Build relationships with garden centers for referrals.', xp: 45},
                {mode: 'execution', task: 'Hire helper for busy season.', xp: 50},
                {mode: 'execution', task: 'Reach $5,000/month in landscaping revenue.', xp: 55}
            ]
        }
    ]
},

{
    id: 'home-organization-demand',
    title: 'Home organization services see massive demand increase',
    source: 'Industry Reports',
    probability: 75,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'personality',
    threatReason: 'People have stuff and no time. Marie Kondo created demand, few can fulfill it.',
    atRisk: 'No one â€” this is pure opportunity in undersupplied market',
    opportunities: [
        {
            title: 'ðŸ  Professional Home Organizer',
            mode: 'personality',
            description: 'Help overwhelmed families declutter and organize their homes.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Read Marie Kondo, The Home Edit, or similar. Learn frameworks.', xp: 30},
                {mode: 'execution', task: 'Practice by organizing your own space. Document before/after.', xp: 35},
                {mode: 'personality', task: 'Offer free organizing session to 3 friends. Get practice.', xp: 45},
                {mode: 'execution', task: 'Create photo portfolio of your work.', xp: 40},
                {mode: 'personality', task: 'Get testimonials from free sessions.', xp: 40},
                {mode: 'execution', task: 'Set pricing: hourly or by project.', xp: 35},
                {mode: 'personality', task: 'Post before/after photos on social media.', xp: 45},
                {mode: 'execution', task: 'Get first 3 paying clients.', xp: 50},
                {mode: 'personality', task: 'Ask happy clients for referrals.', xp: 45},
                {mode: 'execution', task: 'Reach $1,500/month in organizing income.', xp: 55}
            ]
        }
    ]
},

{
    id: 'senior-services-boom',
    title: 'Services for aging population see explosive growth',
    source: 'Demographics',
    probability: 95,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'personality',
    threatReason: 'Baby boomers aging. Massive demand for patient, trustworthy service providers.',
    atRisk: 'No one â€” demographics guarantee this market',
    opportunities: [
        {
            title: 'ðŸ‘´ Senior Concierge Service',
            mode: 'personality',
            description: 'Help seniors with tasks their families can\'t: tech help, errands, companionship.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Research what services seniors need most: tech help, transportation, errands.', xp: 30},
                {mode: 'personality', task: 'Talk to 5 seniors or their adult children about challenges.', xp: 40},
                {mode: 'execution', task: 'Define your service offering: what will you do and not do?', xp: 35},
                {mode: 'personality', task: 'Volunteer at senior center to build trust and learn.', xp: 45},
                {mode: 'execution', task: 'Get basic background check to build credibility.', xp: 35},
                {mode: 'personality', task: 'Get first 3 clients through word of mouth.', xp: 50},
                {mode: 'execution', task: 'Set hourly or package pricing.', xp: 35},
                {mode: 'personality', task: 'Build relationships with families, not just seniors.', xp: 50},
                {mode: 'execution', task: 'Create client tracking and scheduling system.', xp: 40},
                {mode: 'execution', task: 'Reach $2,000/month in senior services.', xp: 55}
            ]
        }
    ]
},

{
    id: 'pet-services-boom',
    title: 'Pet services industry continues explosive growth',
    source: 'Industry Reports',
    probability: 90,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Pets are family now. Spending on pet services increasingly exceeds logic.',
    atRisk: 'No one â€” pet parents spend irrationally',
    opportunities: [
        {
            title: 'ðŸ• Premium Pet Services',
            mode: 'execution',
            description: 'Offer premium pet sitting, walking, or specialized pet services.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Research pet services in your area. What\'s oversupplied vs undersupplied?', xp: 30},
                {mode: 'execution', task: 'Choose your niche: walking, sitting, training, grooming.', xp: 30},
                {mode: 'personality', task: 'Start with friends\' pets. Build experience and references.', xp: 40},
                {mode: 'execution', task: 'Get pet first aid certified (shows professionalism).', xp: 40},
                {mode: 'execution', task: 'Create professional presence: photos with pets, reviews.', xp: 40},
                {mode: 'personality', task: 'List on Rover/Wag AND market independently.', xp: 40},
                {mode: 'execution', task: 'Set premium pricing based on reliability and quality.', xp: 35},
                {mode: 'personality', task: 'Build relationships with vets and pet stores for referrals.', xp: 50},
                {mode: 'execution', task: 'Get 10 regular clients.', xp: 50},
                {mode: 'execution', task: 'Reach $2,500/month in pet services.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸ½ï¸ HOSPITALITY & RESTAURANTS
// ============================================================================

{
    id: 'restaurant-automation',
    title: 'Restaurant automation (ordering kiosks, robot cooking) goes mainstream',
    source: 'Industry Trend',
    probability: 65,
    timeframe: '2-4 years',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'Fast food and fast casual automate. Human servers become premium, not default.',
    atRisk: 'Fast food workers; restaurants slow to adopt technology',
    opportunities: [
        {
            title: 'ðŸ¤– Restaurant Tech Consultant',
            mode: 'execution',
            description: 'Help restaurants evaluate and implement automation technology.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research restaurant automation: kiosks, kitchen robots, AI ordering.', xp: 40},
                {mode: 'execution', task: 'Visit 10 restaurants using technology. Document what works.', xp: 40},
                {mode: 'ideas', task: 'Create comparison of restaurant tech vendors and solutions.', xp: 45},
                {mode: 'personality', task: 'Talk to 5 restaurant owners about their tech challenges.', xp: 50},
                {mode: 'execution', task: 'Develop ROI calculator for restaurant automation.', xp: 50},
                {mode: 'execution', task: 'Create "Restaurant Tech Readiness Assessment"', xp: 45},
                {mode: 'personality', task: 'Offer free assessments to 3 restaurants.', xp: 50},
                {mode: 'execution', task: 'Document results and recommendations.', xp: 45},
                {mode: 'execution', task: 'Create consulting service package.', xp: 50},
                {mode: 'execution', task: 'Get first paid restaurant tech consulting client.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ghost-kitchens-expand',
    title: 'Ghost kitchens become significant portion of restaurant industry',
    source: 'Industry Reports',
    probability: 70,
    timeframe: '2-4 years',
    category: 'tech',
    threatMode: 'execution',
    threatReason: 'Restaurant economics favor delivery-only. Physical dining becomes premium experience.',
    atRisk: 'Mediocre dine-in restaurants competing with delivery-optimized ghost kitchens',
    opportunities: [
        {
            title: 'ðŸ‘» Ghost Kitchen Launcher',
            mode: 'execution',
            description: 'Help entrepreneurs start ghost kitchen concepts with minimal capital.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research ghost kitchen economics. What are the real costs?', xp: 40},
                {mode: 'execution', task: 'Visit ghost kitchen facilities. Understand the operations.', xp: 45},
                {mode: 'ideas', task: 'Analyze delivery app data. What cuisines are underserved in your area?', xp: 45},
                {mode: 'execution', task: 'Create "Ghost Kitchen Launch Playbook"', xp: 50},
                {mode: 'personality', task: 'Connect with ghost kitchen facility operators.', xp: 50},
                {mode: 'execution', task: 'Help launch one ghost kitchen concept (your own or client\'s).', xp: 60},
                {mode: 'execution', task: 'Document the process: costs, timeline, results.', xp: 45},
                {mode: 'personality', task: 'Share case study with aspiring restaurant entrepreneurs.', xp: 50},
                {mode: 'execution', task: 'Create consulting or partnership model.', xp: 50},
                {mode: 'execution', task: 'Launch or help launch 3 ghost kitchen concepts.', xp: 60}
            ]
        }
    ]
},

{
    id: 'hotel-personalization',
    title: 'AI-powered hotel personalization becomes standard',
    source: 'Industry Trend',
    probability: 70,
    timeframe: '2-4 years',
    category: 'tech',
    threatMode: 'personality',
    threatReason: 'Hotels know everything about you. Human hospitality must exceed AI personalization.',
    atRisk: 'Hotel staff who don\'t add value beyond what AI can deliver',
    opportunities: [
        {
            title: 'ðŸ¨ Hospitality Experience Designer',
            mode: 'personality',
            description: 'Design memorable guest experiences that technology can\'t replicate.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Study luxury hospitality. What makes Ritz-Carlton, Four Seasons special?', xp: 40},
                {mode: 'personality', task: 'Interview 10 people about their best hotel experiences. What stood out?', xp: 45},
                {mode: 'ideas', task: 'Identify 10 human touches that AI can\'t replicate.', xp: 40},
                {mode: 'execution', task: 'Create "Human Touch Playbook" for hospitality staff.', xp: 50},
                {mode: 'personality', task: 'Share playbook with hotel managers for feedback.', xp: 50},
                {mode: 'execution', task: 'Develop training workshop for hospitality teams.', xp: 50},
                {mode: 'personality', task: 'Pilot workshop with one hotel.', xp: 55},
                {mode: 'execution', task: 'Document impact on guest satisfaction.', xp: 45},
                {mode: 'execution', task: 'Create consulting/training service package.', xp: 50},
                {mode: 'execution', task: 'Get first paid hospitality training client.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸ“± SOCIAL MEDIA & CONTENT
// ============================================================================

{
    id: 'social-media-ai-dominated',
    title: 'Social media feeds become majority AI-generated content',
    source: 'Industry Trend',
    probability: 60,
    timeframe: '2-3 years',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'AI content floods platforms. Human authenticity becomes rare and valuable.',
    atRisk: 'Creators who could be mistaken for AI; generic content producers',
    opportunities: [
        {
            title: 'âœ¨ Verified Human Creator',
            mode: 'personality',
            description: 'Build audience specifically around being authentically, provably human.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify what makes content feel authentically human vs AI-generated.', xp: 35},
                {mode: 'execution', task: 'Develop content style that emphasizes human elements: imperfection, emotion, spontaneity.', xp: 45},
                {mode: 'personality', task: 'Show your face, your voice, your environment. Make it personal.', xp: 40},
                {mode: 'execution', task: 'Document your creative process. Show the human behind the content.', xp: 40},
                {mode: 'personality', task: 'Engage in real conversations with followers.', xp: 45},
                {mode: 'execution', task: 'Create "proof of humanity" content: live sessions, behind-the-scenes.', xp: 45},
                {mode: 'personality', task: 'Build relationships, not just follower counts.', xp: 50},
                {mode: 'execution', task: 'Reach 1,000 engaged followers who know you\'re real.', xp: 50},
                {mode: 'personality', task: 'Create community around authentic human connection.', xp: 50},
                {mode: 'execution', task: 'Monetize through relationships, not volume.', xp: 55}
            ]
        }
    ]
},

{
    id: 'social-media-dies',
    title: 'Traditional social media usage declines as AI companions rise',
    source: 'Speculative/Industry Discussion',
    probability: 25,
    timeframe: '5-10 years',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'If AI companions satisfy social needs, human connection becomes scarce luxury.',
    atRisk: 'Businesses built entirely on social media engagement',
    opportunities: [
        {
            title: 'ðŸ¤ Human Connection Facilitator',
            mode: 'personality',
            description: 'Create spaces and experiences for genuine human connection in AI-saturated world.',
            difficulty: 'medium',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research AI companion trends. What needs are they meeting?', xp: 35},
                {mode: 'ideas', task: 'Identify what human connection provides that AI can\'t.', xp: 40},
                {mode: 'execution', task: 'Design an experience that facilitates real human connection.', xp: 45},
                {mode: 'personality', task: 'Host first small gathering focused on authentic connection.', xp: 50},
                {mode: 'execution', task: 'Create format that could be repeated.', xp: 45},
                {mode: 'personality', task: 'Get feedback on what worked.', xp: 40},
                {mode: 'execution', task: 'Iterate and host 3 more events.', xp: 50},
                {mode: 'personality', task: 'Build community of people seeking real connection.', xp: 50},
                {mode: 'execution', task: 'Create membership or recurring event model.', xp: 50},
                {mode: 'execution', task: 'Monetize through events or community membership.', xp: 55}
            ]
        }
    ]
},

{
    id: 'hobby-content-explosion',
    title: 'Niche hobby content sees explosive growth',
    source: 'Industry Trend',
    probability: 85,
    timeframe: 'Already happening',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'People retreat to specific interests. Generic content loses, niche wins.',
    atRisk: 'Creators trying to appeal to everyone',
    opportunities: [
        {
            title: 'ðŸŽ¯ Micro-Niche Creator',
            mode: 'personality',
            description: 'Dominate a tiny niche that you genuinely love.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'List 10 hobbies or interests you could talk about passionately for hours.', xp: 25},
                {mode: 'ideas', task: 'Research each: existing creators, audience size, monetization potential.', xp: 35},
                {mode: 'execution', task: 'Pick the one where you have genuine edge and interest.', xp: 30},
                {mode: 'execution', task: 'Create 20 pieces of content in 30 days.', xp: 45},
                {mode: 'personality', task: 'Engage deeply with everyone in your niche community.', xp: 45},
                {mode: 'execution', task: 'Become known as a valuable contributor before promoting yourself.', xp: 40},
                {mode: 'personality', task: 'Connect with other creators in your micro-niche.', xp: 45},
                {mode: 'execution', task: 'Reach 1,000 followers in your specific niche.', xp: 50},
                {mode: 'execution', task: 'Create product or service for your niche.', xp: 50},
                {mode: 'execution', task: 'Make first $500 from your niche audience.', xp: 55}
            ]
        }
    ]
},

{
    id: 'newsletter-renaissance',
    title: 'Email newsletters continue growth as algorithm-free channel',
    source: 'Industry Trend',
    probability: 80,
    timeframe: 'Already happening',
    category: 'media',
    threatMode: 'execution',
    threatReason: 'Owning your audience matters. Email is the only platform you control.',
    atRisk: 'Creators without email list at mercy of algorithm changes',
    opportunities: [
        {
            title: 'ðŸ“§ Newsletter Builder',
            mode: 'execution',
            description: 'Build a newsletter in a topic you know well. Own your audience.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Identify topic you could write about weekly for 2+ years.', xp: 30},
                {mode: 'ideas', task: 'Research existing newsletters in your space. What\'s your angle?', xp: 35},
                {mode: 'execution', task: 'Set up newsletter on Substack, Beehiiv, or ConvertKit.', xp: 30},
                {mode: 'execution', task: 'Write and send your first 4 issues.', xp: 40},
                {mode: 'personality', task: 'Tell everyone you know about your newsletter.', xp: 40},
                {mode: 'execution', task: 'Reach 100 subscribers.', xp: 45},
                {mode: 'execution', task: 'Publish consistently for 8 weeks.', xp: 45},
                {mode: 'personality', task: 'Collaborate with other newsletter writers.', xp: 45},
                {mode: 'execution', task: 'Reach 500 subscribers.', xp: 50},
                {mode: 'execution', task: 'Monetize: paid tier, sponsorships, or products.', xp: 55}
            ]
        }
    ]
},

{
    id: 'podcast-saturation',
    title: 'Podcast market becomes oversaturated, winners take most',
    source: 'Industry Analysis',
    probability: 75,
    timeframe: 'Already happening',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'Too many podcasts, not enough listeners. Only exceptional survive.',
    atRisk: 'Generic interview podcasts without unique angle',
    opportunities: [
        {
            title: 'ðŸŽ™ï¸ Ultra-Niche Podcast',
            mode: 'personality',
            description: 'Create podcast for tiny but passionate audience. Better to be loved by few than liked by many.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify niche so specific that existing podcasts don\'t serve it well.', xp: 40},
                {mode: 'execution', task: 'Define your unique angle. What can only YOU bring?', xp: 40},
                {mode: 'execution', task: 'Record and publish first 4 episodes.', xp: 45},
                {mode: 'personality', task: 'Find and engage with your 100 ideal listeners.', xp: 50},
                {mode: 'execution', task: 'Publish weekly for 8 weeks consistently.', xp: 45},
                {mode: 'personality', task: 'Get guests who your niche audience would kill to hear.', xp: 50},
                {mode: 'execution', task: 'Reach 500 downloads per episode.', xp: 50},
                {mode: 'personality', task: 'Build community around the podcast.', xp: 50},
                {mode: 'execution', task: 'Monetize through premium content or community.', xp: 50},
                {mode: 'execution', task: 'Reach $500/month in podcast revenue.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸŽ¨ CREATIVE & HOBBIES
// ============================================================================

{
    id: 'ai-art-tools-mainstream',
    title: 'AI art tools become standard part of creative workflow',
    source: 'Industry Trend',
    probability: 90,
    timeframe: 'Already happening',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'AI generates infinite images. Human curation and direction become the skill.',
    atRisk: 'Stock photographers, generic illustrators',
    opportunities: [
        {
            title: 'ðŸŽ¨ AI Art Director',
            mode: 'ideas',
            description: 'Direct AI art tools to create specific visions. Prompting is the new drawing.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'execution', task: 'Use 5 AI art tools (Midjourney, DALL-E, Stable Diffusion). Create 100 images.', xp: 35},
                {mode: 'ideas', task: 'Study art direction: composition, color theory, style. Learn vocabulary.', xp: 40},
                {mode: 'execution', task: 'Develop consistent style you can replicate with prompts.', xp: 45},
                {mode: 'execution', task: 'Create portfolio of best AI art in your style.', xp: 40},
                {mode: 'personality', task: 'Share your work and process online.', xp: 40},
                {mode: 'execution', task: 'Create AI art for specific use case: book covers, social media, products.', xp: 45},
                {mode: 'personality', task: 'Offer free AI art to 5 people who need visuals.', xp: 45},
                {mode: 'execution', task: 'Build portfolio from collaborations.', xp: 45},
                {mode: 'execution', task: 'List AI art services on freelance platforms.', xp: 45},
                {mode: 'execution', task: 'Get first paid AI art commission.', xp: 55}
            ]
        }
    ]
},

{
    id: 'crafting-resurgence',
    title: 'Handmade and craft goods see resurgence as AI makes digital cheap',
    source: 'Industry Trend',
    probability: 70,
    timeframe: '2-5 years',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Digital becomes commodity. Physical handmade becomes premium.',
    atRisk: 'No one â€” this is opportunity in contrast to AI',
    opportunities: [
        {
            title: 'âœ‹ Handmade Goods Business',
            mode: 'execution',
            description: 'Sell genuinely handmade goods as premium alternative to mass-produced.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify craft you enjoy that could become product: pottery, woodwork, textiles.', xp: 30},
                {mode: 'execution', task: 'Create 10 items. Practice your craft.', xp: 40},
                {mode: 'execution', task: 'Photograph your work professionally.', xp: 35},
                {mode: 'personality', task: 'Share your work on social media. Show the making process.', xp: 40},
                {mode: 'execution', task: 'List items on Etsy or your own site.', xp: 40},
                {mode: 'personality', task: 'Tell the story behind each piece. People buy stories.', xp: 45},
                {mode: 'execution', task: 'Get first 10 sales.', xp: 50},
                {mode: 'personality', task: 'Ask every buyer for review and photos of item in use.', xp: 45},
                {mode: 'execution', task: 'Develop signature style that\'s recognizably yours.', xp: 45},
                {mode: 'execution', task: 'Reach $1,000/month in handmade sales.', xp: 55}
            ]
        }
    ]
},

{
    id: 'experience-economy',
    title: 'Experience economy grows as people prefer doing over having',
    source: 'Consumer Trends',
    probability: 80,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'personality',
    threatReason: 'People want memories, not stuff. Experience creators win.',
    atRisk: 'Retailers selling commodity products',
    opportunities: [
        {
            title: 'ðŸŽ­ Experience Creator',
            mode: 'personality',
            description: 'Design and host unique experiences people will remember and share.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'List 10 experiences you\'ve had that were memorable. What made them special?', xp: 30},
                {mode: 'ideas', task: 'Research experience economy: escape rooms, dinner parties, workshops.', xp: 35},
                {mode: 'execution', task: 'Design one unique experience you could host.', xp: 45},
                {mode: 'execution', task: 'Host first event for friends. Get detailed feedback.', xp: 50},
                {mode: 'personality', task: 'Document the experience with photos and video.', xp: 40},
                {mode: 'execution', task: 'Iterate based on feedback.', xp: 40},
                {mode: 'personality', task: 'Host for paying strangers. Price it.', xp: 50},
                {mode: 'execution', task: 'List on Airbnb Experiences, Eventbrite, or your own site.', xp: 45},
                {mode: 'personality', task: 'Get reviews and testimonials.', xp: 45},
                {mode: 'execution', task: 'Make experience repeatable. Host monthly.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸ§  HUMAN CONNECTION & WELLBEING
// ============================================================================

{
    id: 'loneliness-epidemic',
    title: 'Loneliness epidemic intensifies despite digital connection',
    source: 'Health Studies',
    probability: 85,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'personality',
    threatReason: 'Digital connection doesn\'t satisfy. Real human connection becomes premium service.',
    atRisk: 'No one â€” this is massive opportunity',
    opportunities: [
        {
            title: 'ðŸ¤— Connection Coach',
            mode: 'personality',
            description: 'Help lonely people build genuine relationships and community.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research loneliness research. Understand the causes and solutions.', xp: 35},
                {mode: 'ideas', task: 'Study successful community builders. What do they do?', xp: 35},
                {mode: 'execution', task: 'Create framework for building genuine connections.', xp: 45},
                {mode: 'personality', task: 'Practice your own connection skills. Meet 10 new people.', xp: 45},
                {mode: 'execution', task: 'Design coaching program for connection-building.', xp: 50},
                {mode: 'personality', task: 'Coach 3 people for free. Document results.', xp: 50},
                {mode: 'execution', task: 'Refine your program based on what worked.', xp: 45},
                {mode: 'personality', task: 'Share your approach publicly. Help others.', xp: 45},
                {mode: 'execution', task: 'Set up paid coaching practice.', xp: 50},
                {mode: 'execution', task: 'Get first 5 paying clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'mental-health-demand',
    title: 'Mental health services demand far exceeds supply',
    source: 'Health Statistics',
    probability: 95,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'personality',
    threatReason: 'Everyone needs mental health support. Therapists are overwhelmed.',
    atRisk: 'No one â€” demand far exceeds supply',
    opportunities: [
        {
            title: 'ðŸ§  Mental Health Adjacent Services',
            mode: 'personality',
            description: 'Provide support services that complement but don\'t replace therapy.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research what mental health support looks like outside therapy: coaching, groups, apps.', xp: 35},
                {mode: 'ideas', task: 'Identify gap you could fill without practicing therapy.', xp: 40},
                {mode: 'execution', task: 'Get relevant training or certification in coaching, facilitation, etc.', xp: 50},
                {mode: 'execution', task: 'Define your offering clearly. What you do and don\'t do.', xp: 40},
                {mode: 'personality', task: 'Offer free sessions to build experience.', xp: 50},
                {mode: 'execution', task: 'Create clear boundaries and referral protocols.', xp: 40},
                {mode: 'personality', task: 'Build relationships with therapists for referrals.', xp: 50},
                {mode: 'execution', task: 'Set up professional practice.', xp: 45},
                {mode: 'personality', task: 'Get testimonials (with permission).', xp: 45},
                {mode: 'execution', task: 'Build to 10 regular clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'digital-detox-demand',
    title: 'Digital detox and offline experiences see growing demand',
    source: 'Consumer Trends',
    probability: 75,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'People are burned out on screens. Offline becomes luxury.',
    atRisk: 'No one â€” this is opportunity in contrast to digital overload',
    opportunities: [
        {
            title: 'ðŸ“µ Digital Detox Guide',
            mode: 'personality',
            description: 'Help people take meaningful breaks from technology.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'execution', task: 'Do your own digital detox for a week. Document the experience.', xp: 40},
                {mode: 'ideas', task: 'Research digital detox retreats and programs. What do they offer?', xp: 35},
                {mode: 'execution', task: 'Create "Digital Detox Starter Guide"', xp: 40},
                {mode: 'personality', task: 'Share your detox experience publicly.', xp: 40},
                {mode: 'execution', task: 'Design a weekend digital detox experience.', xp: 45},
                {mode: 'personality', task: 'Host experience for 5 friends.', xp: 50},
                {mode: 'execution', task: 'Refine based on feedback.', xp: 40},
                {mode: 'personality', task: 'Partner with retreat center or outdoor venue.', xp: 50},
                {mode: 'execution', task: 'Host first paid detox retreat.', xp: 55},
                {mode: 'execution', task: 'Create recurring retreat or coaching program.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸŽ“ EDUCATION & LEARNING
// ============================================================================

{
    id: 'college-value-questioned',
    title: 'Traditional college ROI increasingly questioned',
    source: 'Industry Analysis',
    probability: 80,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'ideas',
    threatReason: 'Credentials matter less. Demonstrated skills matter more.',
    atRisk: 'People with expensive degrees but no portfolio',
    opportunities: [
        {
            title: 'ðŸŽ“ Alternative Education Guide',
            mode: 'ideas',
            description: 'Help people find alternatives to traditional college.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research alternatives: bootcamps, apprenticeships, self-directed learning.', xp: 35},
                {mode: 'ideas', task: 'Interview 10 people who succeeded without traditional degrees.', xp: 45},
                {mode: 'execution', task: 'Create "Alternative Education Pathways" guide for different careers.', xp: 50},
                {mode: 'personality', task: 'Share guide publicly. Help people explore options.', xp: 45},
                {mode: 'execution', task: 'Develop framework for choosing education path.', xp: 45},
                {mode: 'personality', task: 'Coach 5 people through education decisions for free.', xp: 50},
                {mode: 'execution', task: 'Document outcomes and refine approach.', xp: 45},
                {mode: 'personality', task: 'Build audience of people questioning traditional paths.', xp: 50},
                {mode: 'execution', task: 'Create paid coaching or course.', xp: 50},
                {mode: 'execution', task: 'Get first paid education coaching clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'lifelong-learning-essential',
    title: 'Continuous learning becomes essential for career survival',
    source: 'Industry Consensus',
    probability: 95,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'ideas',
    threatReason: 'Skills expire faster. Continuous learning is the new job security.',
    atRisk: 'Anyone who stopped learning after formal education',
    opportunities: [
        {
            title: 'ðŸ“š Learning Coach',
            mode: 'ideas',
            description: 'Help professionals develop effective learning habits and strategies.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Study learning science: spaced repetition, active recall, etc.', xp: 40},
                {mode: 'execution', task: 'Develop your own learning system. Test it on a new skill.', xp: 45},
                {mode: 'execution', task: 'Create "Learn Anything Fast" framework.', xp: 45},
                {mode: 'personality', task: 'Share your learning system publicly.', xp: 40},
                {mode: 'execution', task: 'Design coaching program around learning skills.', xp: 50},
                {mode: 'personality', task: 'Coach 5 people on learning for free.', xp: 50},
                {mode: 'execution', task: 'Track results. How much faster do clients learn?', xp: 45},
                {mode: 'personality', task: 'Get testimonials from successful clients.', xp: 45},
                {mode: 'execution', task: 'Create paid learning coaching offer.', xp: 50},
                {mode: 'execution', task: 'Get first 5 paying clients.', xp: 55}
            ]
        }
    ]
},

// MORE FORECASTS PLACEHOLDER 2
// ============================================================================
// â‚¿ CRYPTO - Continued
// ============================================================================

{
    id: 'ethereum-scaling-works',
    title: 'Ethereum L2 scaling solutions achieve mass adoption',
    source: 'Technical Progress',
    probability: 75,
    timeframe: '2026',
    category: 'crypto',
    threatMode: 'execution',
    threatReason: 'Cheap transactions enable new use cases. Builders on L2s have advantage.',
    atRisk: 'Developers only building on expensive L1s',
    opportunities: [
        {
            title: 'âš¡ L2 Developer/Educator',
            mode: 'execution',
            description: 'Help developers and businesses build on Layer 2 solutions.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'execution', task: 'Learn to build on 3 L2s: Arbitrum, Optimism, Base. Complete tutorials.', xp: 50},
                {mode: 'ideas', task: 'Research differences between L2s. When to use which?', xp: 40},
                {mode: 'execution', task: 'Deploy simple app on each L2. Document the process.', xp: 50},
                {mode: 'execution', task: 'Create "L2 Development Guide" comparing options.', xp: 50},
                {mode: 'personality', task: 'Share guide with developer communities.', xp: 45},
                {mode: 'execution', task: 'Create tutorial series for L2 development.', xp: 50},
                {mode: 'personality', task: 'Help 5 developers deploy their first L2 app.', xp: 50},
                {mode: 'execution', task: 'Build portfolio of L2 projects.', xp: 50},
                {mode: 'personality', task: 'Get hired for L2 development work.', xp: 55},
                {mode: 'execution', task: 'Complete first paid L2 development project.', xp: 60}
            ]
        }
    ]
},

{
    id: 'crypto-etf-expansion',
    title: 'More crypto ETFs approved beyond Bitcoin',
    source: 'Regulatory Trends',
    probability: 70,
    timeframe: '2026',
    category: 'crypto',
    threatMode: 'ideas',
    threatReason: 'Traditional finance embraces crypto. New investor education opportunities.',
    atRisk: 'Crypto natives who don\'t understand traditional finance crossover',
    opportunities: [
        {
            title: 'ðŸ“ˆ Crypto ETF Educator',
            mode: 'ideas',
            description: 'Help traditional investors understand crypto through familiar ETF structures.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research all approved and pending crypto ETFs. Understand differences.', xp: 40},
                {mode: 'ideas', task: 'Study how traditional investors think about ETFs vs direct crypto.', xp: 40},
                {mode: 'execution', task: 'Create "Crypto ETF Comparison Guide" for traditional investors.', xp: 45},
                {mode: 'personality', task: 'Share guide in traditional finance communities.', xp: 45},
                {mode: 'execution', task: 'Develop framework: when to use ETF vs direct crypto ownership.', xp: 45},
                {mode: 'personality', task: 'Answer questions from ETF-curious investors.', xp: 45},
                {mode: 'execution', task: 'Create content explaining crypto through traditional finance lens.', xp: 45},
                {mode: 'personality', task: 'Build audience of traditional investors exploring crypto.', xp: 50},
                {mode: 'execution', task: 'Create paid educational product.', xp: 50},
                {mode: 'execution', task: 'Get first paying students or consulting clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'dao-governance-matures',
    title: 'DAO governance models mature and find product-market fit',
    source: 'Industry Evolution',
    probability: 45,
    timeframe: '3-5 years',
    category: 'crypto',
    threatMode: 'ideas',
    threatReason: 'New organizational structures emerge. Understanding DAOs becomes professional skill.',
    atRisk: 'Organizations ignoring decentralized governance trends',
    opportunities: [
        {
            title: 'ðŸ›ï¸ DAO Governance Consultant',
            mode: 'ideas',
            description: 'Help DAOs design and implement effective governance structures.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Study successful and failed DAO governance models. What works?', xp: 45},
                {mode: 'execution', task: 'Participate actively in 3 DAOs. Learn governance firsthand.', xp: 50},
                {mode: 'ideas', task: 'Research governance frameworks: conviction voting, quadratic voting, etc.', xp: 45},
                {mode: 'execution', task: 'Create "DAO Governance Best Practices" guide.', xp: 50},
                {mode: 'personality', task: 'Share insights with DAO communities.', xp: 45},
                {mode: 'execution', task: 'Develop governance audit framework.', xp: 55},
                {mode: 'personality', task: 'Offer governance audits to 3 DAOs.', xp: 55},
                {mode: 'execution', task: 'Document improvements from your recommendations.', xp: 50},
                {mode: 'execution', task: 'Create consulting service package.', xp: 50},
                {mode: 'execution', task: 'Get first paid DAO governance engagement.', xp: 60}
            ]
        }
    ]
},

{
    id: 'crypto-gaming-grows',
    title: 'Crypto gaming finds sustainable model beyond speculation',
    source: 'Industry Evolution',
    probability: 40,
    timeframe: '3-5 years',
    category: 'crypto',
    threatMode: 'execution',
    threatReason: 'Gaming + crypto creates new economies. Early expertise valuable.',
    atRisk: 'Game developers ignoring blockchain integration possibilities',
    opportunities: [
        {
            title: 'ðŸŽ® Crypto Gaming Specialist',
            mode: 'execution',
            description: 'Help game studios understand and implement blockchain elements.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'execution', task: 'Play 10 crypto games. Analyze what works and what doesn\'t.', xp: 40},
                {mode: 'ideas', task: 'Research sustainable crypto game economies. What makes them work?', xp: 45},
                {mode: 'execution', task: 'Create "Crypto Gaming Analysis" report on current landscape.', xp: 50},
                {mode: 'personality', task: 'Share analysis with game developers.', xp: 45},
                {mode: 'ideas', task: 'Identify how traditional games could benefit from crypto elements.', xp: 45},
                {mode: 'execution', task: 'Design crypto integration proposal for a specific game type.', xp: 55},
                {mode: 'personality', task: 'Connect with indie game developers open to experimentation.', xp: 50},
                {mode: 'execution', task: 'Help implement crypto features in one game.', xp: 60},
                {mode: 'execution', task: 'Document results and learnings.', xp: 50},
                {mode: 'execution', task: 'Build reputation as crypto gaming expert.', xp: 55}
            ]
        }
    ]
},

{
    id: 'real-world-assets-tokenized',
    title: 'Real-world asset tokenization gains mainstream traction',
    source: 'Industry Trend',
    probability: 55,
    timeframe: '3-5 years',
    category: 'crypto',
    threatMode: 'ideas',
    threatReason: 'Traditional assets move on-chain. Bridge between TradFi and DeFi becomes valuable.',
    atRisk: 'Financial professionals ignoring tokenization trends',
    opportunities: [
        {
            title: 'ðŸ¦ RWA Tokenization Consultant',
            mode: 'ideas',
            description: 'Help asset owners understand and explore tokenization options.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research RWA tokenization: real estate, bonds, commodities, art.', xp: 45},
                {mode: 'ideas', task: 'Study existing RWA platforms: Centrifuge, Maple, etc.', xp: 45},
                {mode: 'execution', task: 'Create "RWA Tokenization Guide" for asset owners.', xp: 50},
                {mode: 'personality', task: 'Share with real estate investors and family offices.', xp: 50},
                {mode: 'execution', task: 'Develop evaluation framework: which assets are good candidates?', xp: 50},
                {mode: 'personality', task: 'Connect with lawyers specializing in securities and blockchain.', xp: 55},
                {mode: 'execution', task: 'Help one asset owner explore tokenization options.', xp: 55},
                {mode: 'personality', task: 'Build network of RWA platforms and service providers.', xp: 55},
                {mode: 'execution', task: 'Create consulting service.', xp: 50},
                {mode: 'execution', task: 'Land first paid RWA consulting engagement.', xp: 60}
            ]
        }
    ]
},

// ============================================================================
// ðŸŽ¬ MEDIA - Need ~40 more
// ============================================================================

{
    id: 'youtube-shorts-dominance',
    title: 'Short-form video becomes dominant content format',
    source: 'Platform Data',
    probability: 90,
    timeframe: 'Already happening',
    category: 'media',
    threatMode: 'execution',
    threatReason: 'Attention spans shrink. Short-form skills become essential.',
    atRisk: 'Long-form creators who can\'t adapt',
    opportunities: [
        {
            title: 'ðŸ“± Short-Form Video Producer',
            mode: 'execution',
            description: 'Master short-form video creation for yourself or clients.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Study 50 viral short-form videos. What patterns do you see?', xp: 30},
                {mode: 'execution', task: 'Create 30 short-form videos in 30 days. Build the skill.', xp: 45},
                {mode: 'ideas', task: 'Identify your hook and editing style.', xp: 35},
                {mode: 'execution', task: 'Post on TikTok, Reels, and Shorts simultaneously.', xp: 40},
                {mode: 'execution', task: 'Analyze what works. Double down on winners.', xp: 40},
                {mode: 'personality', task: 'Engage with comments and build community.', xp: 40},
                {mode: 'execution', task: 'Reach 1,000 followers on one platform.', xp: 50},
                {mode: 'personality', task: 'Offer to create short-form for 3 businesses or creators.', xp: 50},
                {mode: 'execution', task: 'Build portfolio of successful short-form content.', xp: 45},
                {mode: 'execution', task: 'Get first paid short-form video client.', xp: 55}
            ]
        }
    ]
},

{
    id: 'live-streaming-economy',
    title: 'Live streaming becomes significant commerce channel',
    source: 'Industry Trend',
    probability: 75,
    timeframe: '2-4 years',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'Live commerce blurs entertainment and shopping. Personality-driven sales explode.',
    atRisk: 'Traditional e-commerce without personality',
    opportunities: [
        {
            title: 'ðŸŽ¥ Live Commerce Host',
            mode: 'personality',
            description: 'Sell products through engaging live streams.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Study successful live commerce: QVC, TikTok Shop, Amazon Live.', xp: 35},
                {mode: 'execution', task: 'Do your first live stream (even with zero viewers). Get comfortable.', xp: 40},
                {mode: 'personality', task: 'Stream 10 times. Practice your hosting skills.', xp: 45},
                {mode: 'ideas', task: 'Identify products you could authentically sell live.', xp: 35},
                {mode: 'execution', task: 'Partner with brand or create your own products to sell.', xp: 45},
                {mode: 'execution', task: 'Do your first commerce-focused live stream.', xp: 50},
                {mode: 'personality', task: 'Build audience that shows up for your lives.', xp: 50},
                {mode: 'execution', task: 'Make your first sale during a live stream.', xp: 50},
                {mode: 'execution', task: 'Develop repeatable live commerce format.', xp: 50},
                {mode: 'execution', task: 'Reach $1,000 in live commerce sales.', xp: 55}
            ]
        }
    ]
},

{
    id: 'substack-newsletter-economy',
    title: 'Newsletter economy continues to grow despite saturation',
    source: 'Platform Data',
    probability: 70,
    timeframe: 'Already happening',
    category: 'media',
    threatMode: 'execution',
    threatReason: 'Direct audience ownership wins. Email remains most valuable channel.',
    atRisk: 'Creators without email lists',
    opportunities: [
        {
            title: 'âœï¸ Paid Newsletter Writer',
            mode: 'execution',
            description: 'Build a paid newsletter in a niche you know.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify niche with passionate audience willing to pay.', xp: 35},
                {mode: 'execution', task: 'Set up newsletter on Substack, Beehiiv, or Ghost.', xp: 30},
                {mode: 'execution', task: 'Write and send 10 free issues. Build consistency.', xp: 45},
                {mode: 'personality', task: 'Promote newsletter across all channels.', xp: 40},
                {mode: 'execution', task: 'Reach 500 free subscribers.', xp: 50},
                {mode: 'execution', task: 'Launch paid tier with exclusive content.', xp: 45},
                {mode: 'personality', task: 'Engage with subscribers. Make them feel valued.', xp: 45},
                {mode: 'execution', task: 'Get first 10 paying subscribers.', xp: 50},
                {mode: 'execution', task: 'Reach $500 MRR from newsletter.', xp: 55},
                {mode: 'execution', task: 'Scale to $2,000 MRR.', xp: 60}
            ]
        }
    ]
},

{
    id: 'audio-content-grows',
    title: 'Audio content continues growth (podcasts, audio rooms, voice notes)',
    source: 'Industry Data',
    probability: 80,
    timeframe: 'Already happening',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'Audio is intimate. Voice builds trust faster than text.',
    atRisk: 'Creators only doing visual content',
    opportunities: [
        {
            title: 'ðŸŽ™ï¸ Audio-First Creator',
            mode: 'personality',
            description: 'Build audience primarily through audio content.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'execution', task: 'Record your first 5 audio pieces (podcast episodes, voice notes, etc).', xp: 35},
                {mode: 'ideas', task: 'Find your audio format: podcast, daily audio, audio newsletter.', xp: 35},
                {mode: 'execution', task: 'Publish weekly audio content for 8 weeks.', xp: 45},
                {mode: 'personality', task: 'Share audio clips on social to drive listeners.', xp: 40},
                {mode: 'execution', task: 'Reach 100 regular listeners.', xp: 45},
                {mode: 'personality', task: 'Respond to listener messages and questions.', xp: 45},
                {mode: 'execution', task: 'Get your first audio sponsorship or create premium tier.', xp: 50},
                {mode: 'personality', task: 'Guest on other podcasts or audio shows.', xp: 50},
                {mode: 'execution', task: 'Reach 500 regular listeners.', xp: 50},
                {mode: 'execution', task: 'Monetize to $500/month from audio.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ugc-creator-economy',
    title: 'UGC (user-generated content) creator economy expands',
    source: 'Industry Trend',
    probability: 85,
    timeframe: 'Already happening',
    category: 'media',
    threatMode: 'execution',
    threatReason: 'Brands need authentic content. UGC creators fill the gap.',
    atRisk: 'Expensive production studios losing to authentic creators',
    opportunities: [
        {
            title: 'ðŸ“¸ UGC Creator',
            mode: 'execution',
            description: 'Create user-generated style content for brands.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Study successful UGC. What makes it feel authentic?', xp: 30},
                {mode: 'execution', task: 'Create 10 sample UGC pieces for imaginary brands.', xp: 40},
                {mode: 'execution', task: 'Build portfolio website showcasing your UGC style.', xp: 40},
                {mode: 'personality', task: 'Reach out to 20 brands offering UGC services.', xp: 45},
                {mode: 'execution', task: 'Get your first UGC gig (even if low-paid).', xp: 50},
                {mode: 'execution', task: 'Deliver excellent work. Get testimonial.', xp: 45},
                {mode: 'personality', task: 'List on UGC platforms: Billo, JoinBrands, Trend.', xp: 40},
                {mode: 'execution', task: 'Complete 10 paid UGC projects.', xp: 50},
                {mode: 'execution', task: 'Raise rates based on demand.', xp: 45},
                {mode: 'execution', task: 'Reach $2,000/month in UGC income.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-content-detection',
    title: 'AI content detection becomes standard practice',
    source: 'Industry Trend',
    probability: 70,
    timeframe: '2-3 years',
    category: 'media',
    threatMode: 'execution',
    threatReason: 'AI detection divides authentic from generated. Human proof becomes valuable.',
    atRisk: 'Creators passing off AI content as human-made',
    opportunities: [
        {
            title: 'âœ‹ Certified Human Creator',
            mode: 'personality',
            description: 'Build brand specifically around provably human-created content.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research AI detection tools and their accuracy.', xp: 35},
                {mode: 'execution', task: 'Develop process for proving your content is human-created.', xp: 40},
                {mode: 'personality', task: 'Document your creation process publicly.', xp: 45},
                {mode: 'execution', task: 'Create content that showcases human elements AI can\'t replicate.', xp: 45},
                {mode: 'personality', task: 'Build audience that values human authenticity.', xp: 50},
                {mode: 'execution', task: 'Get verified or certified as human creator if platforms offer this.', xp: 45},
                {mode: 'personality', task: 'Speak about human vs AI content authenticity.', xp: 50},
                {mode: 'execution', task: 'Command premium rates for verified human content.', xp: 50},
                {mode: 'execution', task: 'Build sustainable business on authenticity premium.', xp: 55},
                {mode: 'personality', task: 'Become known voice on human creativity in AI age.', xp: 55}
            ]
        }
    ]
},

{
    id: 'local-content-resurgence',
    title: 'Local news and content sees resurgence',
    source: 'Industry Trend',
    probability: 60,
    timeframe: '3-5 years',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'National media loses trust. Local, trusted voices win.',
    atRisk: 'National media outlets without local presence',
    opportunities: [
        {
            title: 'ðŸ“ Local Content Creator',
            mode: 'personality',
            description: 'Become the trusted voice for your local community.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify what local information your community needs but doesn\'t get.', xp: 35},
                {mode: 'execution', task: 'Start creating local content: news, events, guides, reviews.', xp: 40},
                {mode: 'personality', task: 'Attend local events and share about them.', xp: 45},
                {mode: 'execution', task: 'Post consistently about your local area for 8 weeks.', xp: 45},
                {mode: 'personality', task: 'Build relationships with local businesses and leaders.', xp: 50},
                {mode: 'execution', task: 'Reach 1,000 local followers.', xp: 50},
                {mode: 'personality', task: 'Become known as the local expert.', xp: 50},
                {mode: 'execution', task: 'Get first local sponsorship or partnership.', xp: 50},
                {mode: 'execution', task: 'Create local guide or resource people pay for.', xp: 50},
                {mode: 'execution', task: 'Monetize to $1,000/month from local content.', xp: 55}
            ]
        }
    ]
},

{
    id: 'gaming-content-mainstream',
    title: 'Gaming content becomes fully mainstream entertainment',
    source: 'Industry Data',
    probability: 90,
    timeframe: 'Already happening',
    category: 'media',
    threatMode: 'personality',
    threatReason: 'Gaming is entertainment now. Gaming personalities command massive audiences.',
    atRisk: 'Traditional entertainment ignoring gaming',
    opportunities: [
        {
            title: 'ðŸŽ® Gaming Content Creator',
            mode: 'personality',
            description: 'Build audience around gaming content.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Identify your gaming niche: specific game, genre, or style.', xp: 30},
                {mode: 'execution', task: 'Set up streaming and recording equipment.', xp: 40},
                {mode: 'execution', task: 'Stream or post gaming content 20 times in first month.', xp: 45},
                {mode: 'personality', task: 'Find your unique personality/angle. What makes you different?', xp: 40},
                {mode: 'execution', task: 'Create clips from your best moments for short-form.', xp: 40},
                {mode: 'personality', task: 'Engage with gaming communities beyond just posting.', xp: 45},
                {mode: 'execution', task: 'Reach 500 followers on primary platform.', xp: 50},
                {mode: 'personality', task: 'Collaborate with other gaming creators.', xp: 50},
                {mode: 'execution', task: 'Get first brand deal or sponsorship.', xp: 55},
                {mode: 'execution', task: 'Monetize to $500/month from gaming content.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸ’¼ WORK - Additional forecasts
// ============================================================================

{
    id: 'passion-economy-expands',
    title: 'Passion economy enables millions to monetize niche interests',
    source: 'Industry Trend',
    probability: 85,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'personality',
    threatReason: 'Anyone can monetize expertise. Competition increases but so does market.',
    atRisk: 'People with no monetizable passion or skill',
    opportunities: [
        {
            title: 'ðŸ’¡ Passion Monetization Coach',
            mode: 'personality',
            description: 'Help people identify and monetize their passions.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research passion economy success stories. What patterns emerge?', xp: 35},
                {mode: 'execution', task: 'Create framework for identifying monetizable passions.', xp: 45},
                {mode: 'personality', task: 'Test framework by helping 5 friends identify their monetizable passion.', xp: 50},
                {mode: 'execution', task: 'Document results. What worked?', xp: 40},
                {mode: 'execution', task: 'Create "Find Your Monetizable Passion" guide.', xp: 45},
                {mode: 'personality', task: 'Share guide and build audience of aspiring passion entrepreneurs.', xp: 50},
                {mode: 'execution', task: 'Develop coaching program around passion monetization.', xp: 50},
                {mode: 'personality', task: 'Get testimonials from successful clients.', xp: 45},
                {mode: 'execution', task: 'Launch paid coaching.', xp: 50},
                {mode: 'execution', task: 'Get 10 paid coaching clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'fractional-work-grows',
    title: 'Fractional executives and part-time experts become common',
    source: 'Industry Trend',
    probability: 80,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Companies hire expertise part-time. High-skill fractional work expands.',
    atRisk: 'Full-time employees who could offer more value fractionally',
    opportunities: [
        {
            title: 'ðŸ§© Fractional Expert',
            mode: 'execution',
            description: 'Offer your expertise to multiple companies on fractional basis.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Identify your highest-value expertise that could be offered fractionally.', xp: 40},
                {mode: 'ideas', task: 'Research fractional roles in your field. What exists?', xp: 35},
                {mode: 'execution', task: 'Create positioning: "Fractional [Your Role]"', xp: 40},
                {mode: 'execution', task: 'Define your fractional offering: hours, deliverables, price.', xp: 45},
                {mode: 'personality', task: 'Tell your network you\'re available for fractional work.', xp: 45},
                {mode: 'execution', task: 'Land your first fractional client.', xp: 55},
                {mode: 'execution', task: 'Deliver excellent results. Document impact.', xp: 50},
                {mode: 'personality', task: 'Get testimonial and referrals.', xp: 45},
                {mode: 'execution', task: 'Land second and third fractional clients.', xp: 55},
                {mode: 'execution', task: 'Reach $5,000/month from fractional work.', xp: 60}
            ]
        }
    ]
},

{
    id: 'solopreneur-tools-mature',
    title: 'Tools for solopreneurs mature, enabling one-person businesses',
    source: 'Industry Trend',
    probability: 90,
    timeframe: 'Already happening',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'One person can now do what required teams. Leverage is everything.',
    atRisk: 'Those not using modern tools; bloated teams',
    opportunities: [
        {
            title: 'ðŸš€ Solopreneur Systems Builder',
            mode: 'execution',
            description: 'Help solopreneurs set up efficient one-person business systems.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'execution', task: 'Audit your own solopreneur stack. What tools do you use?', xp: 35},
                {mode: 'ideas', task: 'Research best solopreneur tools for different business types.', xp: 40},
                {mode: 'execution', task: 'Create "Solopreneur Tech Stack" guide.', xp: 45},
                {mode: 'personality', task: 'Share guide with solopreneur communities.', xp: 45},
                {mode: 'execution', task: 'Develop "Solopreneur Systems Audit" service.', xp: 45},
                {mode: 'personality', task: 'Offer free audits to 5 solopreneurs.', xp: 50},
                {mode: 'execution', task: 'Document time savings and improvements.', xp: 45},
                {mode: 'execution', task: 'Create paid audit + setup service.', xp: 50},
                {mode: 'personality', task: 'Get testimonials from satisfied clients.', xp: 45},
                {mode: 'execution', task: 'Get 10 paid system setup clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'async-work-default',
    title: 'Asynchronous work becomes default for knowledge workers',
    source: 'Industry Trend',
    probability: 70,
    timeframe: '3-5 years',
    category: 'work',
    threatMode: 'execution',
    threatReason: 'Real-time meetings decline. Async communication skills become essential.',
    atRisk: 'People who can\'t communicate effectively in writing',
    opportunities: [
        {
            title: 'ðŸ“ Async Communication Coach',
            mode: 'execution',
            description: 'Help teams communicate effectively without real-time meetings.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Study async-first companies: GitLab, Automattic. How do they work?', xp: 40},
                {mode: 'execution', task: 'Implement async practices in your own work. Document results.', xp: 45},
                {mode: 'execution', task: 'Create "Async Communication Handbook"', xp: 45},
                {mode: 'personality', task: 'Share handbook with remote work communities.', xp: 45},
                {mode: 'execution', task: 'Develop async communication training program.', xp: 50},
                {mode: 'personality', task: 'Offer free training to one team.', xp: 50},
                {mode: 'execution', task: 'Measure meeting reduction and productivity impact.', xp: 50},
                {mode: 'execution', task: 'Create case study from pilot.', xp: 45},
                {mode: 'execution', task: 'Launch paid training service.', xp: 50},
                {mode: 'execution', task: 'Get first paid corporate training client.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸ¤– AI - Additional forecasts
// ============================================================================

{
    id: 'ai-agents-autonomous',
    title: 'AI agents handle complex multi-step tasks autonomously',
    source: 'Industry Projections',
    probability: 65,
    timeframe: '2-3 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'AI agents do your busywork. Value shifts to directing and reviewing.',
    atRisk: 'Those doing repetitive multi-step tasks that can be automated',
    opportunities: [
        {
            title: 'ðŸ¤– AI Agent Builder',
            mode: 'execution',
            description: 'Build custom AI agents for specific workflows.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'execution', task: 'Learn AI agent frameworks: LangChain, AutoGPT, CrewAI.', xp: 50},
                {mode: 'execution', task: 'Build your first simple AI agent that completes a multi-step task.', xp: 50},
                {mode: 'ideas', task: 'Identify 10 repetitive workflows that could be automated by agents.', xp: 40},
                {mode: 'execution', task: 'Build agent for one specific workflow.', xp: 55},
                {mode: 'personality', task: 'Share your agent-building journey publicly.', xp: 45},
                {mode: 'execution', task: 'Offer custom agent building to 3 businesses.', xp: 55},
                {mode: 'execution', task: 'Document time savings and ROI.', xp: 50},
                {mode: 'execution', task: 'Create agent-building service package.', xp: 50},
                {mode: 'execution', task: 'Get first paid agent-building client.', xp: 60},
                {mode: 'execution', task: 'Build portfolio of custom agents.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-personalization-everywhere',
    title: 'AI personalization becomes standard in all digital experiences',
    source: 'Industry Trend',
    probability: 85,
    timeframe: '2-4 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Generic experiences die. Everything becomes personalized.',
    atRisk: 'Businesses offering one-size-fits-all experiences',
    opportunities: [
        {
            title: 'ðŸŽ¯ AI Personalization Consultant',
            mode: 'ideas',
            description: 'Help businesses implement AI personalization.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research AI personalization tools and platforms.', xp: 40},
                {mode: 'ideas', task: 'Study personalization success cases. What drives ROI?', xp: 40},
                {mode: 'execution', task: 'Create "AI Personalization Readiness Assessment"', xp: 50},
                {mode: 'personality', task: 'Share assessment with e-commerce and SaaS businesses.', xp: 45},
                {mode: 'execution', task: 'Develop personalization implementation framework.', xp: 50},
                {mode: 'personality', task: 'Offer free assessments to 5 businesses.', xp: 50},
                {mode: 'execution', task: 'Document potential ROI from personalization.', xp: 45},
                {mode: 'execution', task: 'Create consulting service.', xp: 50},
                {mode: 'execution', task: 'Help one business implement personalization.', xp: 55},
                {mode: 'execution', task: 'Get first paid consulting engagement.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-customer-service',
    title: 'AI handles majority of customer service interactions',
    source: 'Industry Trend',
    probability: 75,
    timeframe: '2-4 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Basic support goes AI. Human support becomes premium escalation.',
    atRisk: 'Entry-level customer service roles',
    opportunities: [
        {
            title: 'ðŸŽ§ AI Customer Service Implementer',
            mode: 'execution',
            description: 'Help businesses implement AI customer service while preserving human touch.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research AI customer service tools: chatbots, voice AI, etc.', xp: 35},
                {mode: 'execution', task: 'Test 5 AI customer service platforms.', xp: 40},
                {mode: 'ideas', task: 'Identify when AI should handle vs escalate to human.', xp: 40},
                {mode: 'execution', task: 'Create "AI Customer Service Implementation Guide"', xp: 50},
                {mode: 'personality', task: 'Share guide with business owners.', xp: 45},
                {mode: 'execution', task: 'Develop implementation framework.', xp: 50},
                {mode: 'personality', task: 'Offer free assessments to 5 businesses.', xp: 50},
                {mode: 'execution', task: 'Help one business implement AI CS.', xp: 55},
                {mode: 'execution', task: 'Measure cost savings and customer satisfaction.', xp: 50},
                {mode: 'execution', task: 'Get first paid implementation client.', xp: 55}
            ]
        }
    ]
},

{
    id: 'ai-copilots-everywhere',
    title: 'AI copilots integrated into all major software',
    source: 'Industry Trend',
    probability: 90,
    timeframe: '2-3 years',
    category: 'ai',
    threatMode: 'execution',
    threatReason: 'Every tool has AI. Knowing how to use AI features becomes baseline skill.',
    atRisk: 'People not learning AI features of their tools',
    opportunities: [
        {
            title: 'ðŸ› ï¸ AI Feature Trainer',
            mode: 'execution',
            description: 'Train teams on AI features in tools they already use.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'execution', task: 'Learn AI features in 10 common tools: Office, Google, Adobe, etc.', xp: 40},
                {mode: 'ideas', task: 'Identify which AI features save most time for each tool.', xp: 35},
                {mode: 'execution', task: 'Create "Hidden AI Features" guide for common tools.', xp: 45},
                {mode: 'personality', task: 'Share tips on social media and LinkedIn.', xp: 40},
                {mode: 'execution', task: 'Develop 1-hour training for specific tool suites.', xp: 45},
                {mode: 'personality', task: 'Offer free training to 3 teams.', xp: 50},
                {mode: 'execution', task: 'Measure time savings from training.', xp: 45},
                {mode: 'execution', task: 'Create paid training packages.', xp: 45},
                {mode: 'personality', task: 'Get testimonials from trained teams.', xp: 45},
                {mode: 'execution', task: 'Get first paid corporate training client.', xp: 55}
            ]
        }
    ]
},

// ============================================================================
// ðŸ“ˆ FINANCE - Additional forecasts
// ============================================================================

{
    id: 'inflation-persistent',
    title: 'Inflation remains above 3% through 2026',
    source: 'Polymarket/Fed Analysis',
    probability: 35,
    timeframe: '2026',
    category: 'finance',
    threatMode: 'execution',
    threatReason: 'Persistent inflation favors asset owners over wage earners. Multiple income streams essential.',
    atRisk: 'People on fixed incomes or single salary',
    opportunities: [
        {
            title: 'ðŸ’° Inflation-Proof Income Builder',
            mode: 'execution',
            description: 'Help people build income streams that keep pace with or exceed inflation.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research which income sources historically outpace inflation.', xp: 40},
                {mode: 'ideas', task: 'Identify 10 inflation-resistant side businesses anyone could start.', xp: 40},
                {mode: 'execution', task: 'Create "Inflation-Proof Income Guide" with specific strategies.', xp: 50},
                {mode: 'personality', task: 'Share guide publicly. Build audience worried about inflation.', xp: 45},
                {mode: 'execution', task: 'Start your own inflation-resistant income stream as proof of concept.', xp: 55},
                {mode: 'execution', task: 'Document your results over 3 months.', xp: 45},
                {mode: 'personality', task: 'Coach 5 people through starting their income streams.', xp: 50},
                {mode: 'execution', task: 'Track client results. Build case studies.', xp: 50},
                {mode: 'execution', task: 'Create paid course or coaching program.', xp: 50},
                {mode: 'execution', task: 'Get 10 paying clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'housing-unaffordable',
    title: 'Housing affordability crisis worsens in major metros',
    source: 'Industry Analysis',
    probability: 80,
    timeframe: '2026',
    category: 'finance',
    threatMode: 'execution',
    threatReason: 'Traditional homeownership path breaks. Alternative housing models emerge.',
    atRisk: 'Young people following traditional "buy a house" advice',
    opportunities: [
        {
            title: 'ðŸ  Alternative Housing Consultant',
            mode: 'ideas',
            description: 'Help people find creative housing solutions: co-living, house hacking, nomad life.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research alternative housing models: co-living, ADUs, house hacking, international living.', xp: 35},
                {mode: 'ideas', task: 'Interview 10 people using non-traditional housing. What works?', xp: 45},
                {mode: 'execution', task: 'Create "Housing Alternatives Guide" for your target demographic.', xp: 45},
                {mode: 'personality', task: 'Share guide publicly. Build audience struggling with housing.', xp: 45},
                {mode: 'execution', task: 'Develop decision framework: which alternative fits which situation?', xp: 45},
                {mode: 'personality', task: 'Help 5 people find alternative housing solutions for free.', xp: 50},
                {mode: 'execution', task: 'Document results and testimonials.', xp: 45},
                {mode: 'execution', task: 'Create consulting service.', xp: 45},
                {mode: 'personality', task: 'Partner with real estate agents who serve non-traditional buyers.', xp: 50},
                {mode: 'execution', task: 'Get first paid consulting clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'retail-investing-grows',
    title: 'Retail investor participation continues growing',
    source: 'Industry Data',
    probability: 75,
    timeframe: 'Already happening',
    category: 'finance',
    threatMode: 'ideas',
    threatReason: 'Everyone is an investor now. Financial literacy becomes essential.',
    atRisk: 'Uninformed retail investors making emotional decisions',
    opportunities: [
        {
            title: 'ðŸ“Š Financial Literacy Educator',
            mode: 'ideas',
            description: 'Teach new investors the basics before they lose money.',
            difficulty: 'easy',
            timeframe: '2-4 months',
            quests: [
                {mode: 'ideas', task: 'Identify top 10 mistakes new retail investors make.', xp: 30},
                {mode: 'execution', task: 'Create "New Investor Survival Guide" covering basics.', xp: 40},
                {mode: 'personality', task: 'Share guide on social media, Reddit, investing communities.', xp: 40},
                {mode: 'execution', task: 'Create simple explainer content: stocks, bonds, ETFs, risk.', xp: 40},
                {mode: 'personality', task: 'Answer questions from new investors publicly.', xp: 45},
                {mode: 'execution', task: 'Build audience of investing beginners.', xp: 45},
                {mode: 'execution', task: 'Create beginner investing course.', xp: 50},
                {mode: 'personality', task: 'Get testimonials from people you helped.', xp: 45},
                {mode: 'execution', task: 'Launch paid course or community.', xp: 50},
                {mode: 'execution', task: 'Get first 20 paying students.', xp: 55}
            ]
        }
    ]
},

{
    id: 'fintech-disruption',
    title: 'Traditional banks lose significant market share to fintech',
    source: 'Industry Analysis',
    probability: 70,
    timeframe: '3-5 years',
    category: 'finance',
    threatMode: 'execution',
    threatReason: 'Banking moves digital. Traditional bank branches and roles transform.',
    atRisk: 'Bank employees in redundant roles; people loyal to legacy banks',
    opportunities: [
        {
            title: 'ðŸ’³ Fintech Navigator',
            mode: 'execution',
            description: 'Help people and businesses find the best fintech solutions for their needs.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research fintech landscape: neobanks, payment apps, lending platforms.', xp: 35},
                {mode: 'execution', task: 'Use 10 different fintech apps. Document pros and cons.', xp: 40},
                {mode: 'execution', task: 'Create comparison guide: "Which Fintech App for What?"', xp: 45},
                {mode: 'personality', task: 'Share guide publicly. Build audience of fintech-curious users.', xp: 45},
                {mode: 'execution', task: 'Develop "Fintech Stack Audit" for businesses.', xp: 50},
                {mode: 'personality', task: 'Offer free audits to 5 small businesses.', xp: 50},
                {mode: 'execution', task: 'Document savings and improvements from audits.', xp: 45},
                {mode: 'execution', task: 'Create consulting service.', xp: 45},
                {mode: 'personality', task: 'Partner with accountants and bookkeepers for referrals.', xp: 50},
                {mode: 'execution', task: 'Get first paid consulting clients.', xp: 55}
            ]
        }
    ]
},

{
    id: 'gold-safe-haven',
    title: 'Gold and precious metals see continued demand as safe haven',
    source: 'Market Analysis',
    probability: 70,
    timeframe: '2026',
    category: 'finance',
    threatMode: 'ideas',
    threatReason: 'Uncertainty drives safe haven demand. Understanding portfolio protection matters.',
    atRisk: 'Investors 100% in growth assets without hedges',
    opportunities: [
        {
            title: 'ðŸ¥‡ Precious Metals Educator',
            mode: 'ideas',
            description: 'Help regular investors understand gold and precious metals as portfolio component.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'ideas', task: 'Research precious metals investing: physical, ETFs, mining stocks, allocation.', xp: 40},
                {mode: 'ideas', task: 'Study historical performance in different economic conditions.', xp: 40},
                {mode: 'execution', task: 'Create "Beginner Guide to Precious Metals Investing"', xp: 45},
                {mode: 'personality', task: 'Share guide in investing communities.', xp: 40},
                {mode: 'execution', task: 'Develop framework: how much gold/silver makes sense for different situations.', xp: 45},
                {mode: 'personality', task: 'Answer questions about precious metals publicly.', xp: 45},
                {mode: 'execution', task: 'Create content comparing different ways to own precious metals.', xp: 45},
                {mode: 'personality', task: 'Build audience interested in portfolio protection.', xp: 50},
                {mode: 'execution', task: 'Create paid course or consulting service.', xp: 50},
                {mode: 'execution', task: 'Get first paying clients or students.', xp: 55}
            ]
        }
    ]
},

{
    id: 'commercial-real-estate-crisis',
    title: 'Commercial real estate faces significant repricing',
    source: 'Industry Analysis',
    probability: 65,
    timeframe: '2026-2027',
    category: 'finance',
    threatMode: 'execution',
    threatReason: 'Office and retail space transforms. Opportunities in distressed assets and conversions.',
    atRisk: 'Commercial landlords slow to adapt; office-dependent businesses',
    opportunities: [
        {
            title: 'ðŸ¢ Commercial Property Repurposing Scout',
            mode: 'ideas',
            description: 'Identify commercial properties ripe for conversion or creative reuse.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research office-to-residential conversions. What makes properties good candidates?', xp: 45},
                {mode: 'ideas', task: 'Study creative reuse examples: offices to housing, malls to mixed-use.', xp: 40},
                {mode: 'execution', task: 'Map distressed commercial properties in your area.', xp: 45},
                {mode: 'execution', task: 'Develop evaluation criteria for conversion potential.', xp: 50},
                {mode: 'personality', task: 'Connect with developers interested in conversions.', xp: 55},
                {mode: 'execution', task: 'Create pitch deck on specific conversion opportunity.', xp: 55},
                {mode: 'personality', task: 'Build relationships with commercial real estate brokers.', xp: 55},
                {mode: 'execution', task: 'Facilitate introduction between property owner and developer.', xp: 55},
                {mode: 'execution', task: 'Get commission or consulting fee from deal.', xp: 60},
                {mode: 'execution', task: 'Build deal flow pipeline.', xp: 60}
            ]
        }
    ]
},

{
    id: 'private-credit-boom',
    title: 'Private credit continues growth as banks pull back',
    source: 'Industry Trend',
    probability: 75,
    timeframe: '2026',
    category: 'finance',
    threatMode: 'ideas',
    threatReason: 'Alternative lending expands. Understanding private credit becomes valuable.',
    atRisk: 'Investors only in public markets missing private opportunities',
    opportunities: [
        {
            title: 'ðŸ’µ Private Credit Educator',
            mode: 'ideas',
            description: 'Help accredited investors understand private credit opportunities.',
            difficulty: 'hard',
            timeframe: '6-12 months',
            quests: [
                {mode: 'ideas', task: 'Research private credit landscape: direct lending, mezzanine, distressed.', xp: 45},
                {mode: 'ideas', task: 'Study how accredited investors access private credit.', xp: 45},
                {mode: 'execution', task: 'Create "Private Credit 101" guide for accredited investors.', xp: 50},
                {mode: 'personality', task: 'Share guide with high-net-worth investor communities.', xp: 50},
                {mode: 'execution', task: 'Develop risk assessment framework for private credit.', xp: 50},
                {mode: 'personality', task: 'Connect with private credit funds and platforms.', xp: 55},
                {mode: 'execution', task: 'Create comparison of private credit investment options.', xp: 50},
                {mode: 'personality', task: 'Build audience of investors interested in alternatives.', xp: 50},
                {mode: 'execution', task: 'Offer paid educational content or consulting.', xp: 55},
                {mode: 'execution', task: 'Get first paying clients.', xp: 60}
            ]
        }
    ]
},

{
    id: 'tax-optimization-ai',
    title: 'AI-powered tax optimization becomes mainstream',
    source: 'Industry Trend',
    probability: 65,
    timeframe: '2-4 years',
    category: 'finance',
    threatMode: 'execution',
    threatReason: 'Tax prep gets automated. Complex tax strategy remains human domain.',
    atRisk: 'Basic tax preparers',
    opportunities: [
        {
            title: 'ðŸ§¾ AI Tax Tool Trainer',
            mode: 'execution',
            description: 'Help people and businesses use AI tax tools effectively.',
            difficulty: 'medium',
            timeframe: '3-6 months',
            quests: [
                {mode: 'execution', task: 'Test 5 AI tax tools. Document capabilities and limitations.', xp: 40},
                {mode: 'ideas', task: 'Identify what AI tax tools do well vs where they fail.', xp: 40},
                {mode: 'execution', task: 'Create guide: "Getting the Most from AI Tax Tools"', xp: 45},
                {mode: 'personality', task: 'Share guide with small business owners.', xp: 45},
                {mode: 'execution', task: 'Develop training on AI tax tool usage.', xp: 50},
                {mode: 'personality', task: 'Offer free training to 5 small businesses.', xp: 50},
                {mode: 'execution', task: 'Document tax savings achieved.', xp: 45},
                {mode: 'execution', task: 'Create paid training service.', xp: 50},
                {mode: 'personality', task: 'Partner with accountants for referrals.', xp: 50},
                {mode: 'execution', task: 'Get first paid training clients.', xp: 55}
            ]
        }
    ]
}

];

function getRiskLevel(forecast, userScores) {
    const threatScore = userScores[forecast.threatMode];
    if (threatScore < 40) return {level: 'critical', label: 'CRITICAL', color: 'var(--danger)'};
    if (threatScore < 55) return {level: 'high', label: 'HIGH', color: 'var(--warning)'};
    if (threatScore < 70) return {level: 'moderate', label: 'MODERATE', color: 'var(--accent)'};
    return {level: 'low', label: 'LOW', color: 'var(--success)'};
}

function getUrgency(forecast) {
    const prob = forecast.probability;
    if (forecast.timeframe.includes('month') && prob > 60) return {label: 'URGENT', color: 'var(--danger)'};
    if (prob > 70) return {label: 'HIGH PROBABILITY', color: 'var(--warning)'};
    if (prob > 50) return {label: 'LIKELY', color: 'var(--accent)'};
    return {label: 'EMERGING', color: 'var(--text-secondary)'};
}

function forecastsH() {
    const forecasts = FORECAST_DATABASE;
    const filtered = S.forecastFilter === 'all' ? forecasts : forecasts.filter(f => f.category === S.forecastFilter);
    
    return `
        <div class="page-header">
            <h1 class="page-title">Forecasts</h1>
            <p class="page-subtitle">What's coming. What mode is threatened. How to prepare.</p>
        </div>
        
        <div class="card mb-20" style="padding:15px;background:var(--bg-primary);border-color:var(--danger)">
            <div style="font-size:11px;color:var(--danger);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">âš ï¸ Your Vulnerability</div>
            <p style="font-size:13px;line-height:1.5">Your weakest mode is <strong style="color:var(--${weakest()})">${weakest().toUpperCase()}</strong> at <strong>${S.scores[weakest()]}%</strong>. 
            Forecasts that threaten this mode put you at highest risk. Prepare now or lose leverage later.</p>
        </div>
        
        <div class="card mb-20" style="padding:15px">
            <div style="display:flex;gap:8px;flex-wrap:wrap">
                <button class="btn btn-small ${S.forecastFilter==='all'?'btn-primary':'btn-secondary'}" data-filter="all">All</button>
                ${Object.entries(CATEGORIES).map(([k,v]) => 
                    `<button class="btn btn-small ${S.forecastFilter===k?'btn-primary':'btn-secondary'}" data-filter="${k}">${v.icon} ${v.name}</button>`
                ).join('')}
            </div>
        </div>
        
        <div class="forecast-list">
            ${filtered.map(f => {
                const risk = getRiskLevel(f, S.scores);
                const urgency = getUrgency(f);
                const isThreatToWeakest = f.threatMode === weakest();
                
                return `
                <div class="card mb-15 forecast-item ${isThreatToWeakest ? 'threat-to-weakest' : ''}" style="${isThreatToWeakest ? 'border-color:var(--danger);' : ''}">
                    <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px;flex-wrap:wrap;gap:8px">
                        <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
                            <span style="font-size:10px;padding:3px 8px;background:var(--bg-tertiary);color:var(--text-secondary)">${CATEGORIES[f.category]?.icon} ${CATEGORIES[f.category]?.name}</span>
                            <span style="font-size:10px;padding:3px 8px;background:rgba(255,68,68,0.2);color:${risk.color}">YOUR RISK: ${risk.label}</span>
                            ${isThreatToWeakest ? '<span style="font-size:10px;padding:3px 8px;background:var(--danger);color:white">âš ï¸ TARGETS YOUR WEAKNESS</span>' : ''}
                        </div>
                        <span style="font-size:10px;color:var(--text-muted)">${f.source}</span>
                    </div>
                    
                    <h3 style="font-size:16px;line-height:1.4;margin-bottom:12px">${f.title}</h3>
                    
                    <div style="display:flex;gap:20px;margin-bottom:15px;flex-wrap:wrap">
                        <div>
                            <div style="font-size:28px;font-weight:700;color:${f.probability > 60 ? 'var(--warning)' : 'var(--text-secondary)'}">${f.probability}%</div>
                            <div style="font-size:9px;color:var(--text-muted);text-transform:uppercase">Probability</div>
                        </div>
                        <div>
                            <div style="font-size:16px;font-weight:700;color:var(--text-primary)">${f.timeframe}</div>
                            <div style="font-size:9px;color:var(--text-muted);text-transform:uppercase">Timeframe</div>
                        </div>
                        <div>
                            <div style="font-size:16px;font-weight:700;color:var(--${f.threatMode})">${f.threatMode.toUpperCase()}</div>
                            <div style="font-size:9px;color:var(--text-muted);text-transform:uppercase">Mode Threatened</div>
                        </div>
                    </div>
                    
                    <div style="background:var(--bg-primary);border-left:3px solid var(--${f.threatMode});padding:12px;margin-bottom:15px">
                        <div style="font-size:10px;color:var(--${f.threatMode});text-transform:uppercase;letter-spacing:1px;margin-bottom:6px">Why ${f.threatMode} is threatened</div>
                        <p style="font-size:12px;line-height:1.5;color:var(--text-secondary)">${f.threatReason}</p>
                        <p style="font-size:11px;color:var(--text-muted);margin-top:8px"><strong>At risk:</strong> ${f.atRisk}</p>
                    </div>
                    
                    <div style="display:flex;gap:10px;flex-wrap:wrap">
                        <button class="btn btn-small btn-primary view-forecast-detail" data-id="${f.id}">See Opportunities â†’</button>
                        <button class="btn btn-small ${S.followedForecasts.includes(f.id)?'btn-success':'btn-secondary'} follow-forecast" data-id="${f.id}">
                            ${S.followedForecasts.includes(f.id)?'âœ“ Following':'+ Follow'}
                        </button>
                    </div>
                </div>
                `;
            }).join('')}
        </div>
        
        <style>
            .forecast-item { transition: all 0.2s; }
            .forecast-item:hover { border-color: var(--text-secondary); }
            .threat-to-weakest { background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(255,68,68,0.05) 100%); }
        </style>
    `;
}

function forecastDetailModalH() {
    const f = S.selectedForecast;
    if (!f) return '';
    const risk = getRiskLevel(f, S.scores);
    
    return `
        <div class="modal-overlay" id="modal-bg">
            <div class="modal" style="max-width:650px;max-height:90vh;overflow-y:auto">
                <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:15px">
                    <span style="font-size:10px;padding:3px 8px;background:rgba(255,68,68,0.2);color:${risk.color}">YOUR RISK: ${risk.label}</span>
                    <button style="background:none;border:none;color:var(--text-secondary);font-size:20px;cursor:pointer" id="close-forecast-modal">Ã—</button>
                </div>
                
                <h3 style="font-size:18px;line-height:1.4;margin-bottom:15px">${f.title}</h3>
                
                <div style="display:flex;gap:15px;margin-bottom:20px;flex-wrap:wrap">
                    <div style="background:var(--bg-primary);padding:12px 16px;text-align:center">
                        <div style="font-size:24px;font-weight:700">${f.probability}%</div>
                        <div style="font-size:9px;color:var(--text-muted);text-transform:uppercase">Probability</div>
                    </div>
                    <div style="background:var(--bg-primary);padding:12px 16px;text-align:center">
                        <div style="font-size:16px;font-weight:700">${f.timeframe}</div>
                        <div style="font-size:9px;color:var(--text-muted);text-transform:uppercase">Timeframe</div>
                    </div>
                    <div style="background:var(--bg-primary);padding:12px 16px;text-align:center">
                        <div style="font-size:16px;font-weight:700;color:var(--${f.threatMode})">${f.threatMode.toUpperCase()}</div>
                        <div style="font-size:9px;color:var(--text-muted);text-transform:uppercase">Threatened</div>
                    </div>
                    <div style="background:var(--bg-primary);padding:12px 16px;text-align:center">
                        <div style="font-size:16px;font-weight:700">${S.scores[f.threatMode]}%</div>
                        <div style="font-size:9px;color:var(--text-muted);text-transform:uppercase">Your ${f.threatMode}</div>
                    </div>
                </div>
                
                ${S.scores[f.threatMode] < 50 ? `
                <div style="background:var(--danger);padding:15px;margin-bottom:20px">
                    <div style="font-size:11px;text-transform:uppercase;letter-spacing:1px;margin-bottom:6px;color:white">âš ï¸ WARNING</div>
                    <p style="font-size:13px;color:white">Your ${f.threatMode} score (${S.scores[f.threatMode]}%) puts you at HIGH RISK if this forecast materializes. Start preparing NOW.</p>
                </div>
                ` : ''}
                
                <div style="margin-bottom:20px">
                    <div style="font-size:11px;color:var(--accent);text-transform:uppercase;letter-spacing:1px;margin-bottom:10px">Opportunities to Prepare</div>
                    
                    ${f.opportunities.map((opp, i) => `
                        <div style="background:var(--bg-primary);border:1px solid var(--bg-tertiary);padding:15px;margin-bottom:12px">
                            <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px">
                                <h4 style="font-size:14px">${opp.title}</h4>
                                <span style="font-size:10px;padding:2px 8px;background:var(--bg-tertiary);color:var(--${opp.mode})">+${opp.mode.toUpperCase()}</span>
                            </div>
                            <p style="font-size:12px;color:var(--text-secondary);line-height:1.5;margin-bottom:12px">${opp.description}</p>
                            <div style="font-size:10px;color:var(--text-muted);margin-bottom:12px">Difficulty: ${opp.difficulty} Â· Timeframe: ${opp.timeframe}</div>
                            
                            <div style="background:var(--bg-secondary);padding:12px;border-left:2px solid var(--accent)">
                                <div style="font-size:10px;color:var(--accent);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Quest Path (${opp.quests.length} quests)</div>
                                ${opp.quests.map((q, j) => `
                                    <div style="display:flex;gap:10px;align-items:flex-start;margin-bottom:8px;padding-bottom:8px;${j < opp.quests.length - 1 ? 'border-bottom:1px solid var(--bg-tertiary)' : ''}">
                                        <span style="font-size:9px;padding:2px 6px;background:var(--bg-tertiary);color:var(--${q.mode})">${q.mode.substring(0,3).toUpperCase()}</span>
                                        <span style="font-size:11px;flex:1">${q.task}</span>
                                        <span style="font-size:10px;color:var(--accent)">+${q.xp}</span>
                                    </div>
                                `).join('')}
                                <button class="btn btn-small btn-primary btn-full mt-10 add-quest-path" data-forecast="${f.id}" data-opp="${i}">Add These Quests to My Queue â†’</button>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                ${f.sourceUrl ? `<a href="${f.sourceUrl}" target="_blank" class="btn btn-small btn-secondary">View Source â†’</a>` : ''}
            </div>
        </div>
    `;
}

function addQuestPathToQueue(forecastId, oppIndex) {
    const forecast = FORECAST_DATABASE.find(f => f.id === forecastId);
    if (!forecast) return;
    
    const opp = forecast.opportunities[oppIndex];
    if (!opp) return;
    
    // Add quests to user's queue
    opp.quests.forEach(q => {
        S.quests.push({
            t: q.task,
            xp: q.xp,
            mode: q.mode,
            diff: 'forecast',
            tip: `From: ${forecast.title.substring(0, 50)}...`,
            id: Date.now() + Math.random(),
            done: false,
            fromForecast: forecastId
        });
    });
    
    save();
    S.modal = null;
    S.selectedForecast = null;
    S.screen = 'quests';
    render();
}

async function loadForecasts() {
    // For now using static database
    // Later: fetch from Supabase or API
    render();
}

// Update modalH to include forecast detail modal
async function init(){
    const params=new URLSearchParams(location.search);
    const hash=location.hash.replace('#','');
    
    // Check for diagnostic mode from landing page
    if(params.get('mode') === 'diagnostic') {
        history.replaceState({}, '', location.pathname + '#quiz');
        S.freeQuizMode = true;
        S.quizStep = 0;
        S.answers = [];
        S.screen = 'freeQuiz';
        render();
        return;
    }
    
    // Check for password reset token
    const resetToken = params.get('token');
    if(resetToken && hash === 'reset') {
        S.modal = 'resetPassword';
        S.resetToken = resetToken;
        S.screen = 'login';
        render();
        return;
    }
    
    // Handle hash routes
    const validScreens = ['signin','signup','login','forgot','pricing','onboarding','upload','quiz','results','dashboard','quests','coach','receipts','capsules','review','settings','forecasts'];
    
    if(params.get('success')==='true'){
        history.replaceState({},'',location.pathname);
        const pending=localStorage.getItem('apc_pending');
        if(pending){S.user=JSON.parse(pending);S.user.plan='paid';S.screen='onboarding';updateHash();render();return;}
    }
    
    const session=localStorage.getItem('apc_session');
    if(session){
        const data=JSON.parse(session);
        const users=await db('users','GET',null,`?email=eq.${encodeURIComponent(data.email)}`);
        if(users?.length){
            S.user=users[0];S.scores=users[0].scores||{ideas:50,personality:50,execution:50};
            S.receipts=users[0].receipts||[];S.diff=users[0].diff||'standard';
            
            // Load quests - ONLY generate new ones if truly empty
            if(users[0].quests && users[0].quests.length > 0) {
                S.quests = users[0].quests;
            } else {
                S.quests = genQuests();
            }
            
            // Load quest customization data
            S.hiddenQuests=users[0].hiddenQuests||[];
            S.customQuests=users[0].customQuests||[];
            S.followedForecasts=users[0].followedForecasts||[];
            S.forecastProgress=users[0].forecastProgress||{};
            
            // Ensure lastQuestWeek is set if user has quests
            if(!S.user.lastQuestWeek && S.quests.length > 0) {
                S.user.lastQuestWeek = getWeekNumber();
                save();
            }
            
            // Merge any local receipts that might not have synced (edge case recovery)
            const localSession = JSON.parse(session);
            if(localSession.receipts && localSession.receipts.length > S.receipts.length) {
                // Local has more receipts - merge them
                const serverIds = new Set(S.receipts.map(r => r.id));
                const missingReceipts = localSession.receipts.filter(r => !serverIds.has(r.id));
                if(missingReceipts.length) {
                    S.receipts = [...S.receipts, ...missingReceipts];
                    save(); // Sync merged receipts back to server
                }
            }
            
            // If logged in and hash is a valid app screen, go there
            if(hash && ['dashboard','quests','coach','receipts','capsules','review','settings','forecasts'].includes(hash)){
                S.screen = hash;
            } else {
                S.screen=S.user.onboarded?'dashboard':'onboarding';
            }
            checkWeeklyProgress();
            updateHash();
            render();return;
        }
    }
    
    // Not logged in - handle auth screens
    if(hash === 'signup' || hash === 'signin' || hash === 'login'){
        S.screen = hash === 'signin' ? 'login' : hash;
    } else if(hash === 'forgot'){
        S.screen = 'forgot';
    } else {
        S.screen = 'login';
    }
    updateHash();
    render();
}

function updateHash(){
    const screenToHash = {
        'login': 'signin',
        'signup': 'signup',
        'forgot': 'forgot',
        'pricing': 'pricing',
        'onboarding': 'onboarding',
        'upload': 'upload',
        'quiz': 'quiz',
        'results': 'results',
        'dashboard': 'dashboard',
        'quests': 'quests',
        'coach': 'coach',
        'receipts': 'receipts',
        'capsules': 'capsules',
        'review': 'review',
        'settings': 'settings',
        'forecasts': 'forecasts'
    };
    const newHash = screenToHash[S.screen] || S.screen;
    if(location.hash !== '#' + newHash){
        history.pushState(null, '', '#' + newHash);
    }
}

// Handle browser back/forward
window.addEventListener('popstate', () => {
    const hash = location.hash.replace('#','');
    if(hash && S.user){
        if(['dashboard','quests','coach','receipts','capsules','review','settings','forecasts'].includes(hash)){
            S.screen = hash;
            render();
        }
    } else if(['signin','login','signup','forgot'].includes(hash)){
        S.screen = hash === 'signin' ? 'login' : hash;
        render();
    }
});
init();
</script>
</body>
</html>
